var sr=Object.defineProperty;var ur=(e,n,t)=>n in e?sr(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var oe=(e,n,t)=>ur(e,typeof n!="symbol"?n+"":n,t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();function T(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];throw new Error(typeof e=="number"?"[MobX] minified error nr: "+e+(t.length?" "+t.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var lr={};function Jt(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:lr}var Zt=Object.assign,qe=Object.getOwnPropertyDescriptor,q=Object.defineProperty,Ye=Object.prototype,dt=[];Object.freeze(dt);var zt={};Object.freeze(zt);var cr=typeof Proxy<"u",fr=Object.toString();function en(){cr||T("Proxy not available")}function tn(e){var n=!1;return function(){if(!n)return n=!0,e.apply(this,arguments)}}var se=function(){};function D(e){return typeof e=="function"}function z(e){var n=typeof e;switch(n){case"string":case"symbol":case"number":return!0}return!1}function Qe(e){return e!==null&&typeof e=="object"}function U(e){if(!Qe(e))return!1;var n=Object.getPrototypeOf(e);if(n==null)return!0;var t=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return typeof t=="function"&&t.toString()===fr}function nn(e){var n=e==null?void 0:e.constructor;return n?n.name==="GeneratorFunction"||n.displayName==="GeneratorFunction":!1}function We(e,n,t){q(e,n,{enumerable:!1,writable:!0,configurable:!0,value:t})}function rn(e,n,t){q(e,n,{enumerable:!1,writable:!1,configurable:!0,value:t})}function ee(e,n){var t="isMobX"+e;return n.prototype[t]=!0,function(r){return Qe(r)&&r[t]===!0}}function pe(e){return e instanceof Map}function xe(e){return e instanceof Set}var on=typeof Object.getOwnPropertySymbols<"u";function dr(e){var n=Object.keys(e);if(!on)return n;var t=Object.getOwnPropertySymbols(e);return t.length?[].concat(n,t.filter(function(r){return Ye.propertyIsEnumerable.call(e,r)})):n}var Ae=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:on?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function an(e){return e===null?null:typeof e=="object"?""+e:e}function Q(e,n){return Ye.hasOwnProperty.call(e,n)}var _r=Object.getOwnPropertyDescriptors||function(n){var t={};return Ae(n).forEach(function(r){t[r]=qe(n,r)}),t};function pr(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mr(r.key),r)}}function yt(e,n,t){return n&&pr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function we(){return we=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},we.apply(this,arguments)}function sn(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,_t(e,n)}function _t(e,n){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},_t(e,n)}function at(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hr(e,n){if(e){if(typeof e=="string")return Ct(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ct(e,n)}}function Ct(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ue(e,n){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=hr(e))||n){t&&(e=t);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vr(e,n){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function mr(e){var n=vr(e,"string");return typeof n=="symbol"?n:String(n)}var le=Symbol("mobx-stored-annotations");function F(e){function n(t,r){Le(t,r,e)}return Object.assign(n,e)}function Le(e,n,t){Q(e,le)||We(e,le,we({},e[le])),Sr(t)||(e[le][n]=t)}var A=Symbol("mobx administration"),Pe=function(){function e(t){t===void 0&&(t="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.batchId_=void 0,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=O.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=t,this.batchId_=g.inBatch?g.batchId:NaN}var n=e.prototype;return n.onBO=function(){this.onBOL&&this.onBOL.forEach(function(r){return r()})},n.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(r){return r()})},n.reportObserved=function(){return kn(this)},n.reportChanged=function(){(!g.inBatch||this.batchId_!==g.batchId)&&(g.stateVersion=g.stateVersion<Number.MAX_SAFE_INTEGER?g.stateVersion+1:Number.MIN_SAFE_INTEGER,this.batchId_=NaN),I(),En(this),C()},n.toString=function(){return this.name_},e}(),At=ee("Atom",Pe);function un(e,n,t){n===void 0&&(n=se),t===void 0&&(t=se);var r=new Pe(e);return n!==se&&yi(r,n),t!==se&&Cn(r,t),r}function gr(e,n){return Wn(e,n)}function br(e,n){return Object.is?Object.is(e,n):e===n?e!==0||1/e===1/n:e!==e&&n!==n}var Fe={structural:gr,default:br};function de(e,n,t){return Dn(e)?e:Array.isArray(e)?L.array(e,{name:t}):U(e)?L.object(e,void 0,{name:t}):pe(e)?L.map(e,{name:t}):xe(e)?L.set(e,{name:t}):typeof e=="function"&&!kt(e)&&!Ue(e)?nn(e)?Te(e):Oe(t,e):e}function yr(e,n,t){if(e==null||rt(e)||tt(e)||ne(e)||he(e))return e;if(Array.isArray(e))return L.array(e,{name:t,deep:!1});if(U(e))return L.object(e,void 0,{name:t,deep:!1});if(pe(e))return L.map(e,{name:t,deep:!1});if(xe(e))return L.set(e,{name:t,deep:!1})}function Je(e){return e}function Ar(e,n){return Wn(e,n)?n:e}var wr="override";function Sr(e){return e.annotationType_===wr}function Me(e,n){return{annotationType_:e,options_:n,make_:Or,extend_:Tr}}function Or(e,n,t,r){var o;if((o=this.options_)!=null&&o.bound)return this.extend_(e,n,t,!1)===null?0:1;if(r===e.target_)return this.extend_(e,n,t,!1)===null?0:2;if(kt(t.value))return 1;var s=ln(e,this,n,t,!1);return q(r,n,s),2}function Tr(e,n,t,r){var o=ln(e,this,n,t);return e.defineProperty_(n,o,r)}function kr(e,n,t,r){n.annotationType_,r.value}function ln(e,n,t,r,o){var s,u,f,d,_,m,i;o===void 0&&(o=g.safeDescriptors),kr(e,n,t,r);var a=r.value;if((s=n.options_)!=null&&s.bound){var l;a=a.bind((l=e.proxy_)!=null?l:e.target_)}return{value:_e((u=(f=n.options_)==null?void 0:f.name)!=null?u:t.toString(),a,(d=(_=n.options_)==null?void 0:_.autoAction)!=null?d:!1,(m=n.options_)!=null&&m.bound?(i=e.proxy_)!=null?i:e.target_:void 0),configurable:o?e.isPlainObject_:!0,enumerable:!1,writable:!o}}function cn(e,n){return{annotationType_:e,options_:n,make_:Er,extend_:xr}}function Er(e,n,t,r){var o;if(r===e.target_)return this.extend_(e,n,t,!1)===null?0:2;if((o=this.options_)!=null&&o.bound&&(!Q(e.target_,n)||!Ue(e.target_[n]))&&this.extend_(e,n,t,!1)===null)return 0;if(Ue(t.value))return 1;var s=fn(e,this,n,t,!1,!1);return q(r,n,s),2}function xr(e,n,t,r){var o,s=fn(e,this,n,t,(o=this.options_)==null?void 0:o.bound);return e.defineProperty_(n,s,r)}function Lr(e,n,t,r){n.annotationType_,r.value}function fn(e,n,t,r,o,s){s===void 0&&(s=g.safeDescriptors),Lr(e,n,t,r);var u=r.value;if(Ue(u)||(u=Te(u)),o){var f;u=u.bind((f=e.proxy_)!=null?f:e.target_),u.isMobXFlow=!0}return{value:u,configurable:s?e.isPlainObject_:!0,enumerable:!1,writable:!s}}function wt(e,n){return{annotationType_:e,options_:n,make_:Pr,extend_:Mr}}function Pr(e,n,t){return this.extend_(e,n,t,!1)===null?0:1}function Mr(e,n,t,r){return Br(e,this,n,t),e.defineComputedProperty_(n,we({},this.options_,{get:t.get,set:t.set}),r)}function Br(e,n,t,r){n.annotationType_,r.get}function Ze(e,n){return{annotationType_:e,options_:n,make_:Ir,extend_:Cr}}function Ir(e,n,t){return this.extend_(e,n,t,!1)===null?0:1}function Cr(e,n,t,r){var o,s;return jr(e,this),e.defineObservableProperty_(n,t.value,(o=(s=this.options_)==null?void 0:s.enhancer)!=null?o:de,r)}function jr(e,n,t,r){n.annotationType_}var Nr="true",Rr=dn();function dn(e){return{annotationType_:Nr,options_:e,make_:Dr,extend_:qr}}function Dr(e,n,t,r){var o,s;if(t.get)return ze.make_(e,n,t,r);if(t.set){var u=_e(n.toString(),t.set);return r===e.target_?e.defineProperty_(n,{configurable:g.safeDescriptors?e.isPlainObject_:!0,set:u})===null?0:2:(q(r,n,{configurable:!0,set:u}),2)}if(r!==e.target_&&typeof t.value=="function"){var f;if(nn(t.value)){var d,_=(d=this.options_)!=null&&d.autoBind?Te.bound:Te;return _.make_(e,n,t,r)}var m=(f=this.options_)!=null&&f.autoBind?Oe.bound:Oe;return m.make_(e,n,t,r)}var i=((o=this.options_)==null?void 0:o.deep)===!1?L.ref:L;if(typeof t.value=="function"&&(s=this.options_)!=null&&s.autoBind){var a;t.value=t.value.bind((a=e.proxy_)!=null?a:e.target_)}return i.make_(e,n,t,r)}function qr(e,n,t,r){var o,s;if(t.get)return ze.extend_(e,n,t,r);if(t.set)return e.defineProperty_(n,{configurable:g.safeDescriptors?e.isPlainObject_:!0,set:_e(n.toString(),t.set)},r);if(typeof t.value=="function"&&(o=this.options_)!=null&&o.autoBind){var u;t.value=t.value.bind((u=e.proxy_)!=null?u:e.target_)}var f=((s=this.options_)==null?void 0:s.deep)===!1?L.ref:L;return f.extend_(e,n,t,r)}var Fr="observable",Vr="observable.ref",$r="observable.shallow",Gr="observable.struct",_n={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(_n);function Ce(e){return e||_n}var pn=Ze(Fr),Hr=Ze(Vr,{enhancer:Je}),Ur=Ze($r,{enhancer:yr}),Kr=Ze(Gr,{enhancer:Ar}),hn=F(pn);function je(e){return e.deep===!0?de:e.deep===!1?Je:Yr(e.defaultDecorator)}function Xr(e){var n;return e?(n=e.defaultDecorator)!=null?n:dn(e):void 0}function Yr(e){var n,t;return e&&(n=(t=e.options_)==null?void 0:t.enhancer)!=null?n:de}function vn(e,n,t){if(z(n)){Le(e,n,pn);return}return Dn(e)?e:U(e)?L.object(e,n,t):Array.isArray(e)?L.array(e,n):pe(e)?L.map(e,n):xe(e)?L.set(e,n):typeof e=="object"&&e!==null?e:L.box(e,n)}Zt(vn,hn);var Qr={box:function(n,t){var r=Ce(t);return new fe(n,je(r),r.name,!0,r.equals)},array:function(n,t){var r=Ce(t);return(g.useProxies===!1||r.proxy===!1?qi:Li)(n,je(r),r.name)},map:function(n,t){var r=Ce(t);return new $n(n,je(r),r.name)},set:function(n,t){var r=Ce(t);return new Un(n,je(r),r.name)},object:function(n,t,r){return re(function(){return Nn(g.useProxies===!1||(r==null?void 0:r.proxy)===!1?nt({},r):Ti({},r),n,t)})},ref:F(Hr),shallow:F(Ur),deep:hn,struct:F(Kr)},L=Zt(vn,Qr),mn="computed",Wr="computed.struct",gn=wt(mn),Jr=wt(Wr,{equals:Fe.structural}),ze=function(n,t){if(z(t))return Le(n,t,gn);if(U(n))return F(wt(mn,n));var r=U(t)?t:{};return r.get=n,r.name||(r.name=n.name||""),new Se(r)};Object.assign(ze,gn);ze.struct=F(Jr);var jt,Nt,Ve=0,Zr=1,zr=(jt=(Nt=qe(function(){},"name"))==null?void 0:Nt.configurable)!=null?jt:!1,Rt={value:"action",configurable:!0,writable:!1,enumerable:!1};function _e(e,n,t,r){t===void 0&&(t=!1);function o(){return ei(e,t,n,r||this,arguments)}return o.isMobxAction=!0,zr&&(Rt.value=e,q(o,"name",Rt)),o}function ei(e,n,t,r,o){var s=ti(e,n);try{return t.apply(r,o)}catch(u){throw s.error_=u,u}finally{ni(s)}}function ti(e,n,t,r){var o=!1,s=0,u=g.trackingDerivation,f=!n||!u;I();var d=g.allowStateChanges;f&&(te(),d=St(!0));var _=Tt(!0),m={runAsAction_:f,prevDerivation_:u,prevAllowStateChanges_:d,prevAllowStateReads_:_,notifySpy_:o,startTime_:s,actionId_:Zr++,parentActionId_:Ve};return Ve=m.actionId_,m}function ni(e){Ve!==e.actionId_&&T(30),Ve=e.parentActionId_,e.error_!==void 0&&(g.suppressReactionErrors=!0),Ot(e.prevAllowStateChanges_),be(e.prevAllowStateReads_),C(),e.runAsAction_&&G(e.prevDerivation_),g.suppressReactionErrors=!1}function St(e){var n=g.allowStateChanges;return g.allowStateChanges=e,n}function Ot(e){g.allowStateChanges=e}var bn;bn=Symbol.toPrimitive;var fe=function(e){sn(n,e);function n(r,o,s,u,f){var d;return s===void 0&&(s="ObservableValue"),f===void 0&&(f=Fe.default),d=e.call(this,s)||this,d.enhancer=void 0,d.name_=void 0,d.equals=void 0,d.hasUnreportedChange_=!1,d.interceptors_=void 0,d.changeListeners_=void 0,d.value_=void 0,d.dehancer=void 0,d.enhancer=o,d.name_=s,d.equals=f,d.value_=o(r,void 0,s),d}var t=n.prototype;return t.dehanceValue=function(o){return this.dehancer!==void 0?this.dehancer(o):o},t.set=function(o){this.value_,o=this.prepareNewValue_(o),o!==g.UNCHANGED&&this.setNewValue_(o)},t.prepareNewValue_=function(o){if(M(this)){var s=B(this,{object:this,type:V,newValue:o});if(!s)return g.UNCHANGED;o=s.newValue}return o=this.enhancer(o,this.value_,this.name_),this.equals(this.value_,o)?g.UNCHANGED:o},t.setNewValue_=function(o){var s=this.value_;this.value_=o,this.reportChanged(),N(this)&&R(this,{type:V,object:this,newValue:o,oldValue:s})},t.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},t.intercept_=function(o){return Be(this,o)},t.observe_=function(o,s){return s&&o({observableKind:"value",debugObjectName:this.name_,object:this,type:V,newValue:this.value_,oldValue:void 0}),Ie(this,o)},t.raw=function(){return this.value_},t.toJSON=function(){return this.get()},t.toString=function(){return this.name_+"["+this.value_+"]"},t.valueOf=function(){return an(this.get())},t[bn]=function(){return this.valueOf()},n}(Pe),yn;yn=Symbol.toPrimitive;var Se=function(){function e(t){this.dependenciesState_=O.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=O.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new Ge(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=$e.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,t.get||T(31),this.derivation=t.get,this.name_=t.name||"ComputedValue",t.set&&(this.setter_=_e("ComputedValue-setter",t.set)),this.equals_=t.equals||(t.compareStructural||t.struct?Fe.structural:Fe.default),this.scope_=t.context,this.requiresReaction_=t.requiresReaction,this.keepAlive_=!!t.keepAlive}var n=e.prototype;return n.onBecomeStale_=function(){ai(this)},n.onBO=function(){this.onBOL&&this.onBOL.forEach(function(r){return r()})},n.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(r){return r()})},n.get=function(){if(this.isComputing_&&T(32,this.name_,this.derivation),g.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)pt(this)&&(this.warnAboutUntrackedRead_(),I(),this.value_=this.computeValue_(!1),C());else if(kn(this),pt(this)){var r=g.trackingContext;this.keepAlive_&&!r&&(g.trackingContext=this),this.trackAndCompute()&&oi(this),g.trackingContext=r}var o=this.value_;if(De(o))throw o.cause;return o},n.set=function(r){if(this.setter_){this.isRunningSetter_&&T(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,r)}finally{this.isRunningSetter_=!1}}else T(34,this.name_)},n.trackAndCompute=function(){var r=this.value_,o=this.dependenciesState_===O.NOT_TRACKING_,s=this.computeValue_(!0),u=o||De(r)||De(s)||!this.equals_(r,s);return u&&(this.value_=s),u},n.computeValue_=function(r){this.isComputing_=!0;var o=St(!1),s;if(r)s=An(this,this.derivation,this.scope_);else if(g.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(u){s=new Ge(u)}return Ot(o),this.isComputing_=!1,s},n.suspend_=function(){this.keepAlive_||(ht(this),this.value_=void 0)},n.observe_=function(r,o){var s=this,u=!0,f=void 0;return W(function(){var d=s.get();if(!u||o){var _=te();r({observableKind:"computed",debugObjectName:s.name_,type:V,object:s,newValue:d,oldValue:f}),G(_)}u=!1,f=d})},n.warnAboutUntrackedRead_=function(){},n.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},n.valueOf=function(){return an(this.get())},n[yn]=function(){return this.valueOf()},e}(),et=ee("ComputedValue",Se),O;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(O||(O={}));var $e;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})($e||($e={}));var Ge=function(n){this.cause=void 0,this.cause=n};function De(e){return e instanceof Ge}function pt(e){switch(e.dependenciesState_){case O.UP_TO_DATE_:return!1;case O.NOT_TRACKING_:case O.STALE_:return!0;case O.POSSIBLY_STALE_:{for(var n=Tt(!0),t=te(),r=e.observing_,o=r.length,s=0;s<o;s++){var u=r[s];if(et(u)){if(g.disableErrorBoundaries)u.get();else try{u.get()}catch{return G(t),be(n),!0}if(e.dependenciesState_===O.STALE_)return G(t),be(n),!0}}return Sn(e),G(t),be(n),!1}}}function An(e,n,t){var r=Tt(!0);Sn(e),e.newObserving_=new Array(e.observing_.length+100),e.unboundDepsCount_=0,e.runId_=++g.runId;var o=g.trackingDerivation;g.trackingDerivation=e,g.inBatch++;var s;if(g.disableErrorBoundaries===!0)s=n.call(t);else try{s=n.call(t)}catch(u){s=new Ge(u)}return g.inBatch--,g.trackingDerivation=o,ri(e),be(r),s}function ri(e){for(var n=e.observing_,t=e.observing_=e.newObserving_,r=O.UP_TO_DATE_,o=0,s=e.unboundDepsCount_,u=0;u<s;u++){var f=t[u];f.diffValue_===0&&(f.diffValue_=1,o!==u&&(t[o]=f),o++),f.dependenciesState_>r&&(r=f.dependenciesState_)}for(t.length=o,e.newObserving_=null,s=n.length;s--;){var d=n[s];d.diffValue_===0&&On(d,e),d.diffValue_=0}for(;o--;){var _=t[o];_.diffValue_===1&&(_.diffValue_=0,ii(_,e))}r!==O.UP_TO_DATE_&&(e.dependenciesState_=r,e.onBecomeStale_())}function ht(e){var n=e.observing_;e.observing_=[];for(var t=n.length;t--;)On(n[t],e);e.dependenciesState_=O.NOT_TRACKING_}function wn(e){var n=te();try{return e()}finally{G(n)}}function te(){var e=g.trackingDerivation;return g.trackingDerivation=null,e}function G(e){g.trackingDerivation=e}function Tt(e){var n=g.allowStateReads;return g.allowStateReads=e,n}function be(e){g.allowStateReads=e}function Sn(e){if(e.dependenciesState_!==O.UP_TO_DATE_){e.dependenciesState_=O.UP_TO_DATE_;for(var n=e.observing_,t=n.length;t--;)n[t].lowestObserverState_=O.UP_TO_DATE_}}var st=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.batchId=Number.MIN_SAFE_INTEGER,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0,this.stateVersion=Number.MIN_SAFE_INTEGER},ut=!0,g=function(){var e=Jt();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(ut=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new st().version&&(ut=!1),ut?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new st):(setTimeout(function(){T(35)},1),new st)}();function ii(e,n){e.observers_.add(n),e.lowestObserverState_>n.dependenciesState_&&(e.lowestObserverState_=n.dependenciesState_)}function On(e,n){e.observers_.delete(n),e.observers_.size===0&&Tn(e)}function Tn(e){e.isPendingUnobservation_===!1&&(e.isPendingUnobservation_=!0,g.pendingUnobservations.push(e))}function I(){g.inBatch===0&&(g.batchId=g.batchId<Number.MAX_SAFE_INTEGER?g.batchId+1:Number.MIN_SAFE_INTEGER),g.inBatch++}function C(){if(--g.inBatch===0){xn();for(var e=g.pendingUnobservations,n=0;n<e.length;n++){var t=e[n];t.isPendingUnobservation_=!1,t.observers_.size===0&&(t.isBeingObserved_&&(t.isBeingObserved_=!1,t.onBUO()),t instanceof Se&&t.suspend_())}g.pendingUnobservations=[]}}function kn(e){var n=g.trackingDerivation;return n!==null?(n.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=n.runId_,n.newObserving_[n.unboundDepsCount_++]=e,!e.isBeingObserved_&&g.trackingContext&&(e.isBeingObserved_=!0,e.onBO())),e.isBeingObserved_):(e.observers_.size===0&&g.inBatch>0&&Tn(e),!1)}function En(e){e.lowestObserverState_!==O.STALE_&&(e.lowestObserverState_=O.STALE_,e.observers_.forEach(function(n){n.dependenciesState_===O.UP_TO_DATE_&&n.onBecomeStale_(),n.dependenciesState_=O.STALE_}))}function oi(e){e.lowestObserverState_!==O.STALE_&&(e.lowestObserverState_=O.STALE_,e.observers_.forEach(function(n){n.dependenciesState_===O.POSSIBLY_STALE_?n.dependenciesState_=O.STALE_:n.dependenciesState_===O.UP_TO_DATE_&&(e.lowestObserverState_=O.UP_TO_DATE_)}))}function ai(e){e.lowestObserverState_===O.UP_TO_DATE_&&(e.lowestObserverState_=O.POSSIBLY_STALE_,e.observers_.forEach(function(n){n.dependenciesState_===O.UP_TO_DATE_&&(n.dependenciesState_=O.POSSIBLY_STALE_,n.onBecomeStale_())}))}var vt=function(){function e(t,r,o,s){t===void 0&&(t="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=O.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=$e.NONE,this.name_=t,this.onInvalidate_=r,this.errorHandler_=o,this.requiresObservable_=s}var n=e.prototype;return n.onBecomeStale_=function(){this.schedule_()},n.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,g.pendingReactions.push(this),xn())},n.isScheduled=function(){return this.isScheduled_},n.runReaction_=function(){if(!this.isDisposed_){I(),this.isScheduled_=!1;var r=g.trackingContext;if(g.trackingContext=this,pt(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(o){this.reportExceptionInDerivation_(o)}}g.trackingContext=r,C()}},n.track=function(r){if(!this.isDisposed_){I(),this.isRunning_=!0;var o=g.trackingContext;g.trackingContext=this;var s=An(this,r,void 0);g.trackingContext=o,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&ht(this),De(s)&&this.reportExceptionInDerivation_(s.cause),C()}},n.reportExceptionInDerivation_=function(r){var o=this;if(this.errorHandler_){this.errorHandler_(r,this);return}if(g.disableErrorBoundaries)throw r;var s="[mobx] uncaught error in '"+this+"'";g.suppressReactionErrors||console.error(s,r),g.globalReactionErrorHandlers.forEach(function(u){return u(r,o)})},n.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(I(),ht(this),C()))},n.getDisposer_=function(r){var o=this,s=function u(){o.dispose(),r==null||r.removeEventListener==null||r.removeEventListener("abort",u)};return r==null||r.addEventListener==null||r.addEventListener("abort",s),s[A]=this,s},n.toString=function(){return"Reaction["+this.name_+"]"},n.trace=function(r){},e}(),si=100,ui=function(n){return n()};function xn(){g.inBatch>0||g.isRunningReactions||ui(li)}function li(){g.isRunningReactions=!0;for(var e=g.pendingReactions,n=0;e.length>0;){++n===si&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var t=e.splice(0),r=0,o=t.length;r<o;r++)t[r].runReaction_()}g.isRunningReactions=!1}var He=ee("Reaction",vt);function ye(){return!1}function ci(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var Ln="action",fi="action.bound",Pn="autoAction",di="autoAction.bound",_i="<unnamed action>",Mn=Me(Ln),pi=Me(fi,{bound:!0}),Bn=Me(Pn,{autoAction:!0}),hi=Me(di,{autoAction:!0,bound:!0});function In(e){var n=function(r,o){if(D(r))return _e(r.name||_i,r,e);if(D(o))return _e(r,o,e);if(z(o))return Le(r,o,e?Bn:Mn);if(z(r))return F(Me(e?Pn:Ln,{name:r,autoAction:e}))};return n}var ce=In(!1);Object.assign(ce,Mn);var Oe=In(!0);Object.assign(Oe,Bn);ce.bound=F(pi);Oe.bound=F(hi);function kt(e){return D(e)&&e.isMobxAction===!0}function W(e,n){var t,r,o,s,u;n===void 0&&(n=zt);var f=(t=(r=n)==null?void 0:r.name)!=null?t:"Autorun",d=!n.scheduler&&!n.delay,_;if(d)_=new vt(f,function(){this.track(a)},n.onError,n.requiresObservable);else{var m=mi(n),i=!1;_=new vt(f,function(){i||(i=!0,m(function(){i=!1,_.isDisposed_||_.track(a)}))},n.onError,n.requiresObservable)}function a(){e(_)}return(o=n)!=null&&(s=o.signal)!=null&&s.aborted||_.schedule_(),_.getDisposer_((u=n)==null?void 0:u.signal)}var vi=function(n){return n()};function mi(e){return e.scheduler?e.scheduler:e.delay?function(n){return setTimeout(n,e.delay)}:vi}var gi="onBO",bi="onBUO";function yi(e,n,t){return jn(gi,e,n,t)}function Cn(e,n,t){return jn(bi,e,n,t)}function jn(e,n,t,r){var o=mt(n),s=D(r)?r:t,u=e+"L";return o[u]?o[u].add(s):o[u]=new Set([s]),function(){var f=o[u];f&&(f.delete(s),f.size===0&&delete o[u])}}function Nn(e,n,t,r){var o=_r(n);return re(function(){var s=nt(e,r)[A];Ae(o).forEach(function(u){s.extend_(u,o[u],t&&u in t?t[u]:!0)})}),e}var Ai=0;function Rn(){this.message="FLOW_CANCELLED"}Rn.prototype=Object.create(Error.prototype);var Dt=cn("flow"),wi=cn("flow.bound",{bound:!0}),Te=Object.assign(function(n,t){if(z(t))return Le(n,t,Dt);var r=n,o=r.name||"<unnamed flow>",s=function(){var f=this,d=arguments,_=++Ai,m=ce(o+" - runid: "+_+" - init",r).apply(f,d),i,a=void 0,l=new Promise(function(c,h){var v=0;i=h;function p(S){a=void 0;var x;try{x=ce(o+" - runid: "+_+" - yield "+v++,m.next).call(m,S)}catch(P){return h(P)}w(x)}function b(S){a=void 0;var x;try{x=ce(o+" - runid: "+_+" - yield "+v++,m.throw).call(m,S)}catch(P){return h(P)}w(x)}function w(S){if(D(S==null?void 0:S.then)){S.then(w,h);return}return S.done?c(S.value):(a=Promise.resolve(S.value),a.then(p,b))}p(void 0)});return l.cancel=ce(o+" - runid: "+_+" - cancel",function(){try{a&&qt(a);var c=m.return(void 0),h=Promise.resolve(c.value);h.then(se,se),qt(h),i(new Rn)}catch(v){i(v)}}),l};return s.isMobXFlow=!0,s},Dt);Te.bound=F(wi);function qt(e){D(e.cancel)&&e.cancel()}function Ue(e){return(e==null?void 0:e.isMobXFlow)===!0}function Si(e,n){return e?rt(e)||!!e[A]||At(e)||He(e)||et(e):!1}function Dn(e){return Si(e)}function $(e,n){n===void 0&&(n=void 0),I();try{return e.apply(n)}finally{C()}}function ae(e){return e[A]}var Oi={has:function(n,t){return ae(n).has_(t)},get:function(n,t){return ae(n).get_(t)},set:function(n,t,r){var o;return z(t)?(o=ae(n).set_(t,r,!0))!=null?o:!0:!1},deleteProperty:function(n,t){var r;return z(t)?(r=ae(n).delete_(t,!0))!=null?r:!0:!1},defineProperty:function(n,t,r){var o;return(o=ae(n).defineProperty_(t,r))!=null?o:!0},ownKeys:function(n){return ae(n).ownKeys_()},preventExtensions:function(n){T(13)}};function Ti(e,n){var t,r;return en(),e=nt(e,n),(r=(t=e[A]).proxy_)!=null?r:t.proxy_=new Proxy(e,Oi)}function M(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function Be(e,n){var t=e.interceptors_||(e.interceptors_=[]);return t.push(n),tn(function(){var r=t.indexOf(n);r!==-1&&t.splice(r,1)})}function B(e,n){var t=te();try{for(var r=[].concat(e.interceptors_||[]),o=0,s=r.length;o<s&&(n=r[o](n),n&&!n.type&&T(14),!!n);o++);return n}finally{G(t)}}function N(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function Ie(e,n){var t=e.changeListeners_||(e.changeListeners_=[]);return t.push(n),tn(function(){var r=t.indexOf(n);r!==-1&&t.splice(r,1)})}function R(e,n){var t=te(),r=e.changeListeners_;if(r){r=r.slice();for(var o=0,s=r.length;o<s;o++)r[o](n);G(t)}}var lt=Symbol("mobx-keys");function ki(e,n,t){return U(e)?Nn(e,e,n,t):(re(function(){var r=nt(e,t)[A];if(!e[lt]){var o=Object.getPrototypeOf(e),s=new Set([].concat(Ae(e),Ae(o)));s.delete("constructor"),s.delete(A),We(o,lt,s)}e[lt].forEach(function(u){return r.make_(u,n&&u in n?n[u]:!0)})}),e)}var Ft="splice",V="update",Ei=1e4,xi={get:function(n,t){var r=n[A];return t===A?r:t==="length"?r.getArrayLength_():typeof t=="string"&&!isNaN(t)?r.get_(parseInt(t)):Q(Ke,t)?Ke[t]:n[t]},set:function(n,t,r){var o=n[A];return t==="length"&&o.setArrayLength_(r),typeof t=="symbol"||isNaN(t)?n[t]=r:o.set_(parseInt(t),r),!0},preventExtensions:function(){T(15)}},Et=function(){function e(t,r,o,s){t===void 0&&(t="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=o,this.legacyMode_=s,this.atom_=new Pe(t),this.enhancer_=function(u,f){return r(u,f,"ObservableArray[..]")}}var n=e.prototype;return n.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},n.dehanceValues_=function(r){return this.dehancer!==void 0&&r.length>0?r.map(this.dehancer):r},n.intercept_=function(r){return Be(this,r)},n.observe_=function(r,o){return o===void 0&&(o=!1),o&&r({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Ie(this,r)},n.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},n.setArrayLength_=function(r){(typeof r!="number"||isNaN(r)||r<0)&&T("Out of range: "+r);var o=this.values_.length;if(r!==o)if(r>o){for(var s=new Array(r-o),u=0;u<r-o;u++)s[u]=void 0;this.spliceWithArray_(o,0,s)}else this.spliceWithArray_(r,o-r)},n.updateArrayLength_=function(r,o){r!==this.lastKnownLength_&&T(16),this.lastKnownLength_+=o,this.legacyMode_&&o>0&&Qn(r+o+1)},n.spliceWithArray_=function(r,o,s){var u=this;this.atom_;var f=this.values_.length;if(r===void 0?r=0:r>f?r=f:r<0&&(r=Math.max(0,f+r)),arguments.length===1?o=f-r:o==null?o=0:o=Math.max(0,Math.min(o,f-r)),s===void 0&&(s=dt),M(this)){var d=B(this,{object:this.proxy_,type:Ft,index:r,removedCount:o,added:s});if(!d)return dt;o=d.removedCount,s=d.added}if(s=s.length===0?s:s.map(function(i){return u.enhancer_(i,void 0)}),this.legacyMode_){var _=s.length-o;this.updateArrayLength_(f,_)}var m=this.spliceItemsIntoValues_(r,o,s);return(o!==0||s.length!==0)&&this.notifyArraySplice_(r,s,m),this.dehanceValues_(m)},n.spliceItemsIntoValues_=function(r,o,s){if(s.length<Ei){var u;return(u=this.values_).splice.apply(u,[r,o].concat(s))}else{var f=this.values_.slice(r,r+o),d=this.values_.slice(r+o);this.values_.length+=s.length-o;for(var _=0;_<s.length;_++)this.values_[r+_]=s[_];for(var m=0;m<d.length;m++)this.values_[r+s.length+m]=d[m];return f}},n.notifyArrayChildUpdate_=function(r,o,s){var u=!this.owned_&&ye(),f=N(this),d=f||u?{observableKind:"array",object:this.proxy_,type:V,debugObjectName:this.atom_.name_,index:r,newValue:o,oldValue:s}:null;this.atom_.reportChanged(),f&&R(this,d)},n.notifyArraySplice_=function(r,o,s){var u=!this.owned_&&ye(),f=N(this),d=f||u?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Ft,index:r,removed:s,added:o,removedCount:s.length,addedCount:o.length}:null;this.atom_.reportChanged(),f&&R(this,d)},n.get_=function(r){if(this.legacyMode_&&r>=this.values_.length){console.warn("[mobx] Out of bounds read: "+r);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[r])},n.set_=function(r,o){var s=this.values_;if(this.legacyMode_&&r>s.length&&T(17,r,s.length),r<s.length){this.atom_;var u=s[r];if(M(this)){var f=B(this,{type:V,object:this.proxy_,index:r,newValue:o});if(!f)return;o=f.newValue}o=this.enhancer_(o,u);var d=o!==u;d&&(s[r]=o,this.notifyArrayChildUpdate_(r,o,u))}else{for(var _=new Array(r+1-s.length),m=0;m<_.length-1;m++)_[m]=void 0;_[_.length-1]=o,this.spliceWithArray_(s.length,0,_)}},e}();function Li(e,n,t,r){return t===void 0&&(t="ObservableArray"),r===void 0&&(r=!1),en(),re(function(){var o=new Et(t,n,r,!1);rn(o.values_,A,o);var s=new Proxy(o.values_,xi);return o.proxy_=s,e&&e.length&&o.spliceWithArray_(0,0,e),s})}var Ke={clear:function(){return this.splice(0)},replace:function(n){var t=this[A];return t.spliceWithArray_(0,t.values_.length,n)},toJSON:function(){return this.slice()},splice:function(n,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];var u=this[A];switch(arguments.length){case 0:return[];case 1:return u.spliceWithArray_(n);case 2:return u.spliceWithArray_(n,t)}return u.spliceWithArray_(n,t,o)},spliceWithArray:function(n,t,r){return this[A].spliceWithArray_(n,t,r)},push:function(){for(var n=this[A],t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.spliceWithArray_(n.values_.length,0,r),n.values_.length},pop:function(){return this.splice(Math.max(this[A].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var n=this[A],t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.spliceWithArray_(0,0,r),n.values_.length},reverse:function(){return g.trackingDerivation&&T(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){g.trackingDerivation&&T(37,"sort");var n=this.slice();return n.sort.apply(n,arguments),this.replace(n),this},remove:function(n){var t=this[A],r=t.dehanceValues_(t.values_).indexOf(n);return r>-1?(this.splice(r,1),!0):!1}};E("concat",X);E("flat",X);E("includes",X);E("indexOf",X);E("join",X);E("lastIndexOf",X);E("slice",X);E("toString",X);E("toLocaleString",X);E("every",J);E("filter",J);E("find",J);E("findIndex",J);E("flatMap",J);E("forEach",J);E("map",J);E("some",J);E("reduce",qn);E("reduceRight",qn);function E(e,n){typeof Array.prototype[e]=="function"&&(Ke[e]=n(e))}function X(e){return function(){var n=this[A];n.atom_.reportObserved();var t=n.dehanceValues_(n.values_);return t[e].apply(t,arguments)}}function J(e){return function(n,t){var r=this,o=this[A];o.atom_.reportObserved();var s=o.dehanceValues_(o.values_);return s[e](function(u,f){return n.call(t,u,f,r)})}}function qn(e){return function(){var n=this,t=this[A];t.atom_.reportObserved();var r=t.dehanceValues_(t.values_),o=arguments[0];return arguments[0]=function(s,u,f){return o(s,u,f,n)},r[e].apply(r,arguments)}}var Pi=ee("ObservableArrayAdministration",Et);function tt(e){return Qe(e)&&Pi(e[A])}var Fn,Vn,Mi={},Y="add",Xe="delete";Fn=Symbol.iterator;Vn=Symbol.toStringTag;var $n=function(){function e(t,r,o){var s=this;r===void 0&&(r=de),o===void 0&&(o="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[A]=Mi,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=r,this.name_=o,D(Map)||T(18),re(function(){s.keysAtom_=un("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,t&&s.merge(t)})}var n=e.prototype;return n.has_=function(r){return this.data_.has(r)},n.has=function(r){var o=this;if(!g.trackingDerivation)return this.has_(r);var s=this.hasMap_.get(r);if(!s){var u=s=new fe(this.has_(r),Je,"ObservableMap.key?",!1);this.hasMap_.set(r,u),Cn(u,function(){return o.hasMap_.delete(r)})}return s.get()},n.set=function(r,o){var s=this.has_(r);if(M(this)){var u=B(this,{type:s?V:Y,object:this,newValue:o,name:r});if(!u)return this;o=u.newValue}return s?this.updateValue_(r,o):this.addValue_(r,o),this},n.delete=function(r){var o=this;if(this.keysAtom_,M(this)){var s=B(this,{type:Xe,object:this,name:r});if(!s)return!1}if(this.has_(r)){var u=ye(),f=N(this),d=f||u?{observableKind:"map",debugObjectName:this.name_,type:Xe,object:this,oldValue:this.data_.get(r).value_,name:r}:null;return $(function(){var _;o.keysAtom_.reportChanged(),(_=o.hasMap_.get(r))==null||_.setNewValue_(!1);var m=o.data_.get(r);m.setNewValue_(void 0),o.data_.delete(r)}),f&&R(this,d),!0}return!1},n.updateValue_=function(r,o){var s=this.data_.get(r);if(o=s.prepareNewValue_(o),o!==g.UNCHANGED){var u=ye(),f=N(this),d=f||u?{observableKind:"map",debugObjectName:this.name_,type:V,object:this,oldValue:s.value_,name:r,newValue:o}:null;s.setNewValue_(o),f&&R(this,d)}},n.addValue_=function(r,o){var s=this;this.keysAtom_,$(function(){var _,m=new fe(o,s.enhancer_,"ObservableMap.key",!1);s.data_.set(r,m),o=m.value_,(_=s.hasMap_.get(r))==null||_.setNewValue_(!0),s.keysAtom_.reportChanged()});var u=ye(),f=N(this),d=f||u?{observableKind:"map",debugObjectName:this.name_,type:Y,object:this,name:r,newValue:o}:null;f&&R(this,d)},n.get=function(r){return this.has(r)?this.dehanceValue_(this.data_.get(r).get()):this.dehanceValue_(void 0)},n.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},n.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},n.values=function(){var r=this,o=this.keys();return ke({next:function(){var u=o.next(),f=u.done,d=u.value;return{done:f,value:f?void 0:r.get(d)}}})},n.entries=function(){var r=this,o=this.keys();return ke({next:function(){var u=o.next(),f=u.done,d=u.value;return{done:f,value:f?void 0:[d,r.get(d)]}}})},n[Fn]=function(){return this.entries()},n.forEach=function(r,o){for(var s=ue(this),u;!(u=s()).done;){var f=u.value,d=f[0],_=f[1];r.call(o,_,d,this)}},n.merge=function(r){var o=this;return ne(r)&&(r=new Map(r)),$(function(){U(r)?dr(r).forEach(function(s){return o.set(s,r[s])}):Array.isArray(r)?r.forEach(function(s){var u=s[0],f=s[1];return o.set(u,f)}):pe(r)?(r.constructor!==Map&&T(19,r),r.forEach(function(s,u){return o.set(u,s)})):r!=null&&T(20,r)}),this},n.clear=function(){var r=this;$(function(){wn(function(){for(var o=ue(r.keys()),s;!(s=o()).done;){var u=s.value;r.delete(u)}})})},n.replace=function(r){var o=this;return $(function(){for(var s=Bi(r),u=new Map,f=!1,d=ue(o.data_.keys()),_;!(_=d()).done;){var m=_.value;if(!s.has(m)){var i=o.delete(m);if(i)f=!0;else{var a=o.data_.get(m);u.set(m,a)}}}for(var l=ue(s.entries()),c;!(c=l()).done;){var h=c.value,v=h[0],p=h[1],b=o.data_.has(v);if(o.set(v,p),o.data_.has(v)){var w=o.data_.get(v);u.set(v,w),b||(f=!0)}}if(!f)if(o.data_.size!==u.size)o.keysAtom_.reportChanged();else for(var S=o.data_.keys(),x=u.keys(),P=S.next(),Z=x.next();!P.done;){if(P.value!==Z.value){o.keysAtom_.reportChanged();break}P=S.next(),Z=x.next()}o.data_=u}),this},n.toString=function(){return"[object ObservableMap]"},n.toJSON=function(){return Array.from(this)},n.observe_=function(r,o){return Ie(this,r)},n.intercept_=function(r){return Be(this,r)},yt(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Vn,get:function(){return"Map"}}]),e}(),ne=ee("ObservableMap",$n);function Bi(e){if(pe(e)||ne(e))return e;if(Array.isArray(e))return new Map(e);if(U(e)){var n=new Map;for(var t in e)n.set(t,e[t]);return n}else return T(21,e)}var Gn,Hn,Ii={};Gn=Symbol.iterator;Hn=Symbol.toStringTag;var Un=function(){function e(t,r,o){var s=this;r===void 0&&(r=de),o===void 0&&(o="ObservableSet"),this.name_=void 0,this[A]=Ii,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=o,D(Set)||T(22),this.enhancer_=function(u,f){return r(u,f,o)},re(function(){s.atom_=un(s.name_),t&&s.replace(t)})}var n=e.prototype;return n.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},n.clear=function(){var r=this;$(function(){wn(function(){for(var o=ue(r.data_.values()),s;!(s=o()).done;){var u=s.value;r.delete(u)}})})},n.forEach=function(r,o){for(var s=ue(this),u;!(u=s()).done;){var f=u.value;r.call(o,f,f,this)}},n.add=function(r){var o=this;if(this.atom_,M(this)){var s=B(this,{type:Y,object:this,newValue:r});if(!s)return this}if(!this.has(r)){$(function(){o.data_.add(o.enhancer_(r,void 0)),o.atom_.reportChanged()});var u=!1,f=N(this),d=f||u?{observableKind:"set",debugObjectName:this.name_,type:Y,object:this,newValue:r}:null;f&&R(this,d)}return this},n.delete=function(r){var o=this;if(M(this)){var s=B(this,{type:Xe,object:this,oldValue:r});if(!s)return!1}if(this.has(r)){var u=!1,f=N(this),d=f||u?{observableKind:"set",debugObjectName:this.name_,type:Xe,object:this,oldValue:r}:null;return $(function(){o.atom_.reportChanged(),o.data_.delete(r)}),f&&R(this,d),!0}return!1},n.has=function(r){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(r))},n.entries=function(){var r=0,o=Array.from(this.keys()),s=Array.from(this.values());return ke({next:function(){var f=r;return r+=1,f<s.length?{value:[o[f],s[f]],done:!1}:{done:!0}}})},n.keys=function(){return this.values()},n.values=function(){this.atom_.reportObserved();var r=this,o=0,s=Array.from(this.data_.values());return ke({next:function(){return o<s.length?{value:r.dehanceValue_(s[o++]),done:!1}:{done:!0}}})},n.replace=function(r){var o=this;return he(r)&&(r=new Set(r)),$(function(){Array.isArray(r)?(o.clear(),r.forEach(function(s){return o.add(s)})):xe(r)?(o.clear(),r.forEach(function(s){return o.add(s)})):r!=null&&T("Cannot initialize set from "+r)}),this},n.observe_=function(r,o){return Ie(this,r)},n.intercept_=function(r){return Be(this,r)},n.toJSON=function(){return Array.from(this)},n.toString=function(){return"[object ObservableSet]"},n[Gn]=function(){return this.values()},yt(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Hn,get:function(){return"Set"}}]),e}(),he=ee("ObservableSet",Un),Vt=Object.create(null),$t="remove",Kn=function(){function e(t,r,o,s){r===void 0&&(r=new Map),s===void 0&&(s=Rr),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=t,this.values_=r,this.name_=o,this.defaultAnnotation_=s,this.keysAtom_=new Pe("ObservableObject.keys"),this.isPlainObject_=U(this.target_)}var n=e.prototype;return n.getObservablePropValue_=function(r){return this.values_.get(r).get()},n.setObservablePropValue_=function(r,o){var s=this.values_.get(r);if(s instanceof Se)return s.set(o),!0;if(M(this)){var u=B(this,{type:V,object:this.proxy_||this.target_,name:r,newValue:o});if(!u)return null;o=u.newValue}if(o=s.prepareNewValue_(o),o!==g.UNCHANGED){var f=N(this),d=!1,_=f||d?{type:V,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:r,newValue:o}:null;s.setNewValue_(o),f&&R(this,_)}return!0},n.get_=function(r){return g.trackingDerivation&&!Q(this.target_,r)&&this.has_(r),this.target_[r]},n.set_=function(r,o,s){return s===void 0&&(s=!1),Q(this.target_,r)?this.values_.has(r)?this.setObservablePropValue_(r,o):s?Reflect.set(this.target_,r,o):(this.target_[r]=o,!0):this.extend_(r,{value:o,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},n.has_=function(r){if(!g.trackingDerivation)return r in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var o=this.pendingKeys_.get(r);return o||(o=new fe(r in this.target_,Je,"ObservableObject.key?",!1),this.pendingKeys_.set(r,o)),o.get()},n.make_=function(r,o){if(o===!0&&(o=this.defaultAnnotation_),o!==!1){if(!(r in this.target_)){var s;if((s=this.target_[le])!=null&&s[r])return;T(1,o.annotationType_,this.name_+"."+r.toString())}for(var u=this.target_;u&&u!==Ye;){var f=qe(u,r);if(f){var d=o.make_(this,r,f,u);if(d===0)return;if(d===1)break}u=Object.getPrototypeOf(u)}Ht(this,o,r)}},n.extend_=function(r,o,s,u){if(u===void 0&&(u=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(r,o,u);var f=s.extend_(this,r,o,u);return f&&Ht(this,s,r),f},n.defineProperty_=function(r,o,s){s===void 0&&(s=!1),this.keysAtom_;try{I();var u=this.delete_(r);if(!u)return u;if(M(this)){var f=B(this,{object:this.proxy_||this.target_,name:r,type:Y,newValue:o.value});if(!f)return null;var d=f.newValue;o.value!==d&&(o=we({},o,{value:d}))}if(s){if(!Reflect.defineProperty(this.target_,r,o))return!1}else q(this.target_,r,o);this.notifyPropertyAddition_(r,o.value)}finally{C()}return!0},n.defineObservableProperty_=function(r,o,s,u){u===void 0&&(u=!1),this.keysAtom_;try{I();var f=this.delete_(r);if(!f)return f;if(M(this)){var d=B(this,{object:this.proxy_||this.target_,name:r,type:Y,newValue:o});if(!d)return null;o=d.newValue}var _=Gt(r),m={configurable:g.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:_.get,set:_.set};if(u){if(!Reflect.defineProperty(this.target_,r,m))return!1}else q(this.target_,r,m);var i=new fe(o,s,"ObservableObject.key",!1);this.values_.set(r,i),this.notifyPropertyAddition_(r,i.value_)}finally{C()}return!0},n.defineComputedProperty_=function(r,o,s){s===void 0&&(s=!1),this.keysAtom_;try{I();var u=this.delete_(r);if(!u)return u;if(M(this)){var f=B(this,{object:this.proxy_||this.target_,name:r,type:Y,newValue:void 0});if(!f)return null}o.name||(o.name="ObservableObject.key"),o.context=this.proxy_||this.target_;var d=Gt(r),_={configurable:g.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:d.get,set:d.set};if(s){if(!Reflect.defineProperty(this.target_,r,_))return!1}else q(this.target_,r,_);this.values_.set(r,new Se(o)),this.notifyPropertyAddition_(r,void 0)}finally{C()}return!0},n.delete_=function(r,o){if(o===void 0&&(o=!1),this.keysAtom_,!Q(this.target_,r))return!0;if(M(this)){var s=B(this,{object:this.proxy_||this.target_,name:r,type:$t});if(!s)return null}try{var u,f;I();var d=N(this),_=!1,m=this.values_.get(r),i=void 0;if(!m&&(d||_)){var a;i=(a=qe(this.target_,r))==null?void 0:a.value}if(o){if(!Reflect.deleteProperty(this.target_,r))return!1}else delete this.target_[r];if(m&&(this.values_.delete(r),m instanceof fe&&(i=m.value_),En(m)),this.keysAtom_.reportChanged(),(u=this.pendingKeys_)==null||(f=u.get(r))==null||f.set(r in this.target_),d||_){var l={type:$t,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:i,name:r};d&&R(this,l)}}finally{C()}return!0},n.observe_=function(r,o){return Ie(this,r)},n.intercept_=function(r){return Be(this,r)},n.notifyPropertyAddition_=function(r,o){var s,u,f=N(this),d=!1;if(f||d){var _=f||d?{type:Y,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:r,newValue:o}:null;f&&R(this,_)}(s=this.pendingKeys_)==null||(u=s.get(r))==null||u.set(!0),this.keysAtom_.reportChanged()},n.ownKeys_=function(){return this.keysAtom_.reportObserved(),Ae(this.target_)},n.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function nt(e,n){var t;if(Q(e,A))return e;var r=(t=n==null?void 0:n.name)!=null?t:"ObservableObject",o=new Kn(e,new Map,String(r),Xr(n));return We(e,A,o),e}var Ci=ee("ObservableObjectAdministration",Kn);function Gt(e){return Vt[e]||(Vt[e]={get:function(){return this[A].getObservablePropValue_(e)},set:function(t){return this[A].setObservablePropValue_(e,t)}})}function rt(e){return Qe(e)?Ci(e[A]):!1}function Ht(e,n,t){var r;(r=e.target_[le])==null||delete r[t]}var ji=Yn(0),Ni=function(){var e=!1,n={};return Object.defineProperty(n,"0",{set:function(){e=!0}}),Object.create(n)[0]=1,e===!1}(),ct=0,Xn=function(){};function Ri(e,n){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,n):e.prototype.__proto__!==void 0?e.prototype.__proto__=n:e.prototype=n}Ri(Xn,Array.prototype);var xt=function(e,n,t){sn(r,e);function r(s,u,f,d){var _;return f===void 0&&(f="ObservableArray"),d===void 0&&(d=!1),_=e.call(this)||this,re(function(){var m=new Et(f,u,d,!0);m.proxy_=at(_),rn(at(_),A,m),s&&s.length&&_.spliceWithArray(0,0,s),Ni&&Object.defineProperty(at(_),"0",ji)}),_}var o=r.prototype;return o.concat=function(){this[A].atom_.reportObserved();for(var u=arguments.length,f=new Array(u),d=0;d<u;d++)f[d]=arguments[d];return Array.prototype.concat.apply(this.slice(),f.map(function(_){return tt(_)?_.slice():_}))},o[t]=function(){var s=this,u=0;return ke({next:function(){return u<s.length?{value:s[u++],done:!1}:{done:!0,value:void 0}}})},yt(r,[{key:"length",get:function(){return this[A].getArrayLength_()},set:function(u){this[A].setArrayLength_(u)}},{key:n,get:function(){return"Array"}}]),r}(Xn,Symbol.toStringTag,Symbol.iterator);Object.entries(Ke).forEach(function(e){var n=e[0],t=e[1];n!=="concat"&&We(xt.prototype,n,t)});function Yn(e){return{enumerable:!1,configurable:!0,get:function(){return this[A].get_(e)},set:function(t){this[A].set_(e,t)}}}function Di(e){q(xt.prototype,""+e,Yn(e))}function Qn(e){if(e>ct){for(var n=ct;n<e+100;n++)Di(n);ct=e}}Qn(1e3);function qi(e,n,t){return new xt(e,n,t)}function mt(e,n){if(typeof e=="object"&&e!==null){if(tt(e))return n!==void 0&&T(23),e[A].atom_;if(he(e))return e.atom_;if(ne(e)){if(n===void 0)return e.keysAtom_;var t=e.data_.get(n)||e.hasMap_.get(n);return t||T(25,n,gt(e)),t}if(rt(e)){if(!n)return T(26);var r=e[A].values_.get(n);return r||T(27,n,gt(e)),r}if(At(e)||et(e)||He(e))return e}else if(D(e)&&He(e[A]))return e[A];T(28)}function Fi(e,n){if(e||T(29),At(e)||et(e)||He(e)||ne(e)||he(e))return e;if(e[A])return e[A];T(24,e)}function gt(e,n){var t;if(n!==void 0)t=mt(e,n);else{if(kt(e))return e.name;rt(e)||ne(e)||he(e)?t=Fi(e):t=mt(e)}return t.name_}function re(e){var n=te(),t=St(!0);I();try{return e()}finally{C(),Ot(t),G(n)}}var Ut=Ye.toString;function Wn(e,n,t){return t===void 0&&(t=-1),bt(e,n,t)}function bt(e,n,t,r,o){if(e===n)return e!==0||1/e===1/n;if(e==null||n==null)return!1;if(e!==e)return n!==n;var s=typeof e;if(s!=="function"&&s!=="object"&&typeof n!="object")return!1;var u=Ut.call(e);if(u!==Ut.call(n))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:+e==0?1/+e===1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(n);case"[object Map]":case"[object Set]":t>=0&&t++;break}e=Kt(e),n=Kt(n);var f=u==="[object Array]";if(!f){if(typeof e!="object"||typeof n!="object")return!1;var d=e.constructor,_=n.constructor;if(d!==_&&!(D(d)&&d instanceof d&&D(_)&&_ instanceof _)&&"constructor"in e&&"constructor"in n)return!1}if(t===0)return!1;t<0&&(t=-1),r=r||[],o=o||[];for(var m=r.length;m--;)if(r[m]===e)return o[m]===n;if(r.push(e),o.push(n),f){if(m=e.length,m!==n.length)return!1;for(;m--;)if(!bt(e[m],n[m],t-1,r,o))return!1}else{var i=Object.keys(e),a;if(m=i.length,Object.keys(n).length!==m)return!1;for(;m--;)if(a=i[m],!(Q(n,a)&&bt(e[a],n[a],t-1,r,o)))return!1}return r.pop(),o.pop(),!0}function Kt(e){return tt(e)?e.slice():pe(e)||ne(e)||xe(e)||he(e)?Array.from(e.entries()):e}function ke(e){return e[Symbol.iterator]=Vi,e}function Vi(){return this}["Symbol","Map","Set"].forEach(function(e){var n=Jt();typeof n[e]>"u"&&T("MobX requires global '"+e+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:ci,extras:{getDebugName:gt},$mobx:A});class $i{constructor(){oe(this,"profile",{username:"Guest",xp:0,level:1,badges:[],completedModes:[],lastPlayed:null,seenIntro:!1});oe(this,"settings",{theme:"menubackground",mute:!1,difficulty:"normal",loop:!1,shuffle:!1});oe(this,"stats",{quickServe:{sessions:0,topScore:0},infinity:{timeSpent:0},story:{chapter:0}});oe(this,"storyProgress",{currentChapter:0,seenPanels:[]});oe(this,"uiState",{pendingBadgePopup:null,triggerBadgeModal:!1,currentMode:null});ki(this),this.loadFromStorage()}addXP(n){this.profile.xp+=n;const t=Math.floor(this.profile.xp/100)+1;t>this.profile.level&&(this.profile.level=t)}setLastPlayed(n){this.profile.lastPlayed=n}unlockBadge(n){this.profile.badges.includes(n)||(this.profile.badges.push(n),this.uiState.pendingBadgePopup=n)}markModeComplete(n){this.profile.completedModes.includes(n)||this.profile.completedModes.push(n)}updateTopScore(n,t){this.stats[n]&&t>this.stats[n].topScore&&(this.stats[n].topScore=t)}incrementStoryChapter(){this.stats.story.chapter++,this.storyProgress.currentChapter++}markPanelSeen(n){this.storyProgress.seenPanels.includes(n)||this.storyProgress.seenPanels.push(n)}setSetting(n,t){this.settings[n]=t}setTriggerBadgeModal(n){this.uiState.triggerBadgeModal=n}clearTriggerBadgeModal(){this.uiState.triggerBadgeModal=!1}clearPendingBadgePopup(){this.uiState.pendingBadgePopup=null}setMode(n){this.uiState.currentMode=n}loadFromStorage(){const n=localStorage.getItem("snowcone_save_data");if(n)try{const t=JSON.parse(n);Object.assign(this.profile,t.profile),Object.assign(this.settings,t.settings),Object.assign(this.stats,t.stats),Object.assign(this.storyProgress,t.storyProgress)}catch(t){console.warn(" Bad save data. Using defaults.",t)}}}const y=new $i;W(()=>{const e={profile:y.profile,settings:y.settings,stats:y.stats,storyProgress:y.storyProgress};localStorage.setItem("snowcone_save_data",JSON.stringify(e))});window.devFlags={build:"v0.3.0-mobx"};function K(){const e=document.getElementById("menuImage");if(!e){console.warn(" No menuImage element found!");return}let n=y.settings.theme;(!n||typeof n!="string"||n==="default")&&(n="menubackground",y.setSetting("theme",n)),e.src=`assets/img/branding/${n}.png`,console.log(" Background set to:",n),Gi(n)}function Gi(e){const n=Ui[e];n&&Object.entries(n).forEach(([t,r])=>{const o=document.querySelector(`.menu-label.${t}`);o&&(o.style.color=r)})}function Hi(e){const n=document.getElementById("menuImage");if(!n){console.warn(" No #menuImage found to swap.");return}y.setSetting("theme",e),n.src=`assets/img/branding/${e}.png`,console.log(` Swapped to theme: ${e}`)}window.swapBackground=Hi;const Ui={menubackground:{kids:"#ff77ff",quick:"#00ffee",tips:"#ffee00",story:"#ff4488",infinity:"#88ccff",options:"#cccccc"},spring:{kids:"#cc66ff",quick:"#00cc99",tips:"#ffcc66",story:"#ff66aa",infinity:"#66ddff",options:"#9999cc"},summer:{kids:"#ffdd00",quick:"#ff6600",tips:"#33cc33",story:"#ff3399",infinity:"#00ddff",options:"#ff9933"},fall:{kids:"#ffaa00",quick:"#ff6600",tips:"#66cc33",story:"#cc6633",infinity:"#ffffff",options:"#663300"},winter:{kids:"#aaddff",quick:"#ffffff",tips:"#66ffff",story:"#ddddff",infinity:"#66ccff",options:"#ccccff"},freedom:{kids:"#ff4444",quick:"#ffffff",tips:"#3366ff",story:"#ffcc00",infinity:"#bbbbbb",options:"#222222"},halloween:{kids:"#ff9933",quick:"#6600cc",tips:"#00cc66",story:"#cc0000",infinity:"#dddddd",options:"#000000"},harvest:{kids:"#ffcc00",quick:"#996633",tips:"#cc9900",story:"#993300",infinity:"#ffffff",options:"#333300"},christmas:{kids:"#00dd00",quick:"#dd0000",tips:"#ffffff",story:"#ff66cc",infinity:"#aaaaaa",options:"#006600"},newyear:{kids:"#ffffff",quick:"#ffcc00",tips:"#999999",story:"#330066",infinity:"#ff00ff",options:"#111111"},valentine:{kids:"#ff6699",quick:"#cc0066",tips:"#ffcccc",story:"#990033",infinity:"#ffe6f0",options:"#660033"},cosmic_01:{kids:"#cc66ff",quick:"#00ffff",tips:"#ffcc00",story:"#ff6699",infinity:"#ffffff",options:"#9999ff"},cosmic_02:{kids:"#ff99cc",quick:"#33ccff",tips:"#ccff66",story:"#ff66cc",infinity:"#cccccc",options:"#6666ff"},cosmic_03:{kids:"#ffffff",quick:"#88ffcc",tips:"#00cc99",story:"#66ccff",infinity:"#ccffff",options:"#333399"},cosmic_04:{kids:"#aaffff",quick:"#ffffff",tips:"#66ccff",story:"#99ccff",infinity:"#33ccff",options:"#005577"},cosmic_05:{kids:"#ffcc00",quick:"#ff9900",tips:"#00ffff",story:"#ff33cc",infinity:"#ffffff",options:"#ff0066"},cosmic_06:{kids:"#000000",quick:"#ff0000",tips:"#ffccff",story:"#330033",infinity:"#ff99ff",options:"#9900cc"},cosmic_07:{kids:"#ffffff",quick:"#ffffff",tips:"#ffffff",story:"#ffffff",infinity:"#ffffff",options:"#ffffff"}},Xt={menubackground:" Default",fall:" Fall",winter:" Winter",spring:" Spring",summer:" Summer",halloween:" Halloween",harvest:" Harvest",christmas:" Christmas",freedom:" Freedom",newyear:" New Year",valentine:" Valentine",cosmic_01:" Cosmic 01",cosmic_02:" Cosmic 02",cosmic_03:" Cosmic 03",cosmic_04:" Cosmic 04",cosmic_05:" Cosmic 05",cosmic_06:" Cosmic 06",cosmic_07:" Aberys Cone"};window.setTheme=e=>{y.setSetting("theme",e),K()};var Wt;(Wt=document.getElementById("labelQuickServe"))==null||Wt.addEventListener("click",()=>{startMode("quickServe")});const Ki={first_steps:{label:"First ",png:"cone_01.png",unlocks:"fall"},math_zen:{label:"Zen ",png:"cone_02.png",unlocks:"cosmic_01"},mode_tour:{label:"Tour ",png:"cone_03.png",unlocks:"halloween"},theme_swap:{label:"Style ",png:"cone_04.png",unlocks:"summer"},listened_music:{label:"Vibes ",png:"cone_05.png",unlocks:"cosmic_02"},kids_place_car:{label:"Grid ",png:"cone_06.png",unlocks:"spring"},kids_match_master:{label:"Match ",png:"cone_07.png",unlocks:"christmas"},cone_master:{label:"Cone Master ",png:"cone_08.png",unlocks:"cosmic_03"}},Xi={first_steps:{label:"First ",short:"Get XP",png:"snowconebadge.png",unlocks:null},math_zen:{label:"Zen ",short:"100 XP",png:"snowconebadge.png",unlocks:"cosmic_01"},mode_tour:{label:"Tour ",short:"Try Modes",png:"snowconebadge.png",unlocks:null},theme_swap:{label:"Style ",short:"Change Theme",png:"snowconebadge.png",unlocks:"summer"},listened_music:{label:"Vibes ",short:"Play Music",png:"snowconebadge.png",unlocks:"cosmic_02"},kids_place_car:{label:"Grid ",short:"Place Car",png:"snowconebadge.png",unlocks:"spring"},kids_match_master:{label:"Match ",short:"Match Game",png:"snowconebadge.png",unlocks:"freedom"},quick_50:{label:"QS 50 ",short:"QS: 50pts",png:"snowconebadge.png",unlocks:null},quick_100:{label:"QS 100 ",short:"QS: 100pts",png:"snowconebadge.png",unlocks:"cosmic_03"},quick_200:{label:"QS 200 ",short:"QS: 200pts",png:"snowconebadge.png",unlocks:"cosmic_07"},quick_300:{label:"QS 300 ",short:"QS: 300pts",png:"snowconebadge.png",unlocks:"cosmic_05"},inf_50_1min:{label:"50 ",short:"50 in 1m",png:"snowconebadge.png",unlocks:"harvest"},inf_100_2min:{label:"100 ",short:"100 in 2m",png:"snowconebadge.png",unlocks:"winter"},inf_250_4min:{label:"250 ",short:"250 in 4m",png:"snowconebadge.png",unlocks:"christmas"},inf_600_10min:{label:"600 ",short:"600 in 10m",png:"snowconebadge.png",unlocks:"valentine"},story_started:{label:"Enter ",short:"Start Story",png:"snowconebadge.png",unlocks:null},story_finished:{label:"Clear ",short:"Finish Story",png:"snowconebadge.png",unlocks:"fall"},story_perfect:{label:"Perfect ",short:"No Mistakes",png:"snowconebadge.png",unlocks:"cosmic_06"},story_cat:{label:"Cat ",short:"Find Cat",png:"snowconebadge.png",unlocks:"newyear"},story_phil:{label:"Phil ",short:"Meet Phil",png:"snowconebadge.png",unlocks:"halloween"},legend:{label:"Legend ",short:"100% Game",png:"snowconebadge.png",unlocks:"cosmic_04"}},Yi={" Core Progress":["first_steps","math_zen","mode_tour","theme_swap","listened_music"]," Kids Cones":["kids_place_car","kids_match_master"]," Quick Serve":["quick_50","quick_100","quick_200","quick_300"]," Infinity Mode":["inf_50_1min","inf_100_2min","inf_250_4min","inf_600_10min"]," Story Mode":["story_started","story_finished","story_perfect","story_cat","story_phil"]," Completion":["legend"]};function Jn(){const e=document.getElementById("badgeGrid");if(e){e.innerHTML="";for(const[n,t]of Object.entries(Yi)){const r=document.createElement("div");r.classList.add("badge-group");const o=document.createElement("div");o.classList.add("badge-section"),o.textContent=n,r.appendChild(o);const s=document.createElement("div");s.classList.add("badge-grid"),t.forEach(u=>{const f=Xi[u],d=y.profile.badges.includes(u),_=document.createElement("div");_.classList.add("badge-tile"),d&&_.classList.add("unlocked");const m=document.createElement("img");m.className="badge-img",m.src=d?`/SnowCone-MathFest/assets/img/icons/${f.png}`:"/SnowCone-MathFest/assets/img/icons/cone_locked.png",m.alt=f.label,_.appendChild(m);const i=document.createElement("div");if(i.className="badge-short",i.textContent=f.short||"?????",_.appendChild(i),d){const a=document.createElement("div");a.className="badge-label",a.textContent=f.label,_.appendChild(a)}s.appendChild(_)}),r.appendChild(s),e.appendChild(r)}}}W(()=>{document.getElementById("badgeGrid")&&Jn()});W(()=>{const e=y.uiState.pendingBadgePopup;if(e&&typeof e=="string"){const n=document.createElement("div");n.className="badge-banner",n.textContent=` New badge unlocked: ${e}! Check Options `,document.body.appendChild(n),setTimeout(()=>n.remove(),5e3),y.clearPendingBadgePopup()}});function Qi(){return`
    <div class="settings-block">
      <label for="profileNameInput"> Your Name:</label>
      <input id="profileNameInput" type="text" placeholder="Enter name..." />
    </div>

    <div class="settings-block">
      <h3> Completion</h3>
      <div class="xp-bar-wrap">
        <div class="xp-bar" id="xpBar"></div>
      </div>
      <span id="xpPercentText">0%</span>
    </div>

    <div class="settings-block">
      <h3> Cones Earned</h3>
      <div id="badgeGrid" class="badge-wrapper"></div>
    </div>
  `}function Wi(){const e=Object.keys(Ki).length,n=Zi(e),t=document.getElementById("xpBar"),r=document.getElementById("xpPercentText");t&&(t.style.width=`${n}%`),r&&(r.textContent=`${n}%`)}function Ji(){const e=document.getElementById("profileNameInput");if(e){if(e.value=y.profile.username,sessionStorage.getItem("forceWelcomeReload")){sessionStorage.removeItem("forceWelcomeReload");const n=document.createElement("div");n.classList.add("input-message"),n.textContent=` Save restored: Welcome back, ${y.profile.username}!`,Object.assign(n.style,{color:"#00ffee",textAlign:"center",marginTop:"0.5em",fontSize:"0.85rem"}),e.insertAdjacentElement("afterend",n),setTimeout(()=>n.remove(),2500)}e.onchange=()=>{y.profile.username=e.value.trim();const n=e.nextElementSibling;n!=null&&n.classList.contains("input-message")&&n.remove();const t=document.createElement("div");t.classList.add("input-message"),t.textContent=` Welcome, ${y.profile.username}!`,Object.assign(t.style,{color:"#00ffee",textAlign:"center",marginTop:"0.5em",fontSize:"0.85rem"}),e.insertAdjacentElement("afterend",t),setTimeout(()=>t.remove(),2500)}}Jn(),W(()=>{Wi()})}function Zi(e){let n=0;return n+=Math.min(y.profile.xp,100)*.5,n+=y.profile.badges.length/e*20,y.stats.story.chapter>=5&&(n+=15),y.stats.quickServe.topScore>=50&&(n+=10),y.stats.quickServe.sessions>0&&y.stats.infinity.timeSpent>0&&y.storyProgress.seenPanels.length>0&&(n+=5),Math.min(100,Math.round(n))}function zi(){var r;const e=y.settings.theme,n=((r=y.profile)==null?void 0:r.unlockedThemes)||[];let t='<div class="theme-grid">';return Object.keys(Xt).forEach(o=>{const s=Xt[o],u=o==="menubackground"||n.includes(o);t+=`
      <div class="theme-tile ${u?"":"locked"} ${e===o?"active":""}" data-theme="${o}">
        <div class="theme-preview" style="background-image:url('assets/img/branding/${o}.png')"></div>
        <div class="theme-label">${s}</div>
        ${u?"":'<div class="theme-lock"></div>'}
      </div>
    `}),t+="</div>",t}function eo(){const e=document.querySelectorAll(".theme-tile");if(!e.length){console.warn(" No theme tiles found to bind");return}e.forEach(n=>{n.classList.contains("locked")||n.addEventListener("click",()=>{const t=n.dataset.theme;console.log(` Theme selected: ${t}`),y.setSetting("theme",t),location.reload()})})}var me=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ft={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var Yt;function to(){return Yt||(Yt=1,function(e){(function(){var n=function(){this.init()};n.prototype={init:function(){var i=this||t;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var a=this||t;if(i=parseFloat(i),a.ctx||m(),typeof i<"u"&&i>=0&&i<=1){if(a._volume=i,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i,t.ctx.currentTime);for(var l=0;l<a._howls.length;l++)if(!a._howls[l]._webAudio)for(var c=a._howls[l]._getSoundIds(),h=0;h<c.length;h++){var v=a._howls[l]._soundById(c[h]);v&&v._node&&(v._node.volume=v._volume*i)}return a}return a._volume},mute:function(i){var a=this||t;a.ctx||m(),a._muted=i,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i?0:a._volume,t.ctx.currentTime);for(var l=0;l<a._howls.length;l++)if(!a._howls[l]._webAudio)for(var c=a._howls[l]._getSoundIds(),h=0;h<c.length;h++){var v=a._howls[l]._soundById(c[h]);v&&v._node&&(v._node.muted=i?!0:v._muted)}return a},stop:function(){for(var i=this||t,a=0;a<i._howls.length;a++)i._howls[a].stop();return i},unload:function(){for(var i=this||t,a=i._howls.length-1;a>=0;a--)i._howls[a].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,m()),i},codecs:function(i){return(this||t)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||t;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var a=new Audio;a.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||t,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return i}if(!a||typeof a.canPlayType!="function")return i;var l=a.canPlayType("audio/mpeg;").replace(/^no$/,""),c=i._navigator?i._navigator.userAgent:"",h=c.match(/OPR\/(\d+)/g),v=h&&parseInt(h[0].split("/")[1],10)<33,p=c.indexOf("Safari")!==-1&&c.indexOf("Chrome")===-1,b=c.match(/Version\/(.*?) /),w=p&&b&&parseInt(b[1],10)<15;return i._codecs={mp3:!!(!v&&(l||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!l,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!w&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!w&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||t;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var a=function(l){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var c=new Audio;c._unlocked=!0,i._releaseHtml5Audio(c)}catch{i.noAudio=!0;break}for(var h=0;h<i._howls.length;h++)if(!i._howls[h]._webAudio)for(var v=i._howls[h]._getSoundIds(),p=0;p<v.length;p++){var b=i._howls[h]._soundById(v[p]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}i._autoResume();var w=i.ctx.createBufferSource();w.buffer=i._scratchBuffer,w.connect(i.ctx.destination),typeof w.start>"u"?w.noteOn(0):w.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),w.onended=function(){w.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var S=0;S<i._howls.length;S++)i._howls[S]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),i}},_obtainHtml5Audio:function(){var i=this||t;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var a=this||t;return i._unlocked&&a._html5AudioPool.push(i),a},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!t.usingWebAudio)){for(var a=0;a<i._howls.length;a++)if(i._howls[a]._webAudio){for(var l=0;l<i._howls[a]._sounds.length;l++)if(!i._howls[a]._sounds[l]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var c=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(c,c)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!t.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var a=0;a<i._howls.length;a++)i._howls[a]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var t=new n,r=function(i){var a=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(i)};r.prototype={init:function(i){var a=this;return t.ctx||m(),a._autoplay=i.autoplay||!1,a._format=typeof i.format!="string"?i.format:[i.format],a._html5=i.html5||!1,a._muted=i.mute||!1,a._loop=i.loop||!1,a._pool=i.pool||5,a._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,a._rate=i.rate||1,a._sprite=i.sprite||{},a._src=typeof i.src!="string"?i.src:[i.src],a._volume=i.volume!==void 0?i.volume:1,a._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=i.onend?[{fn:i.onend}]:[],a._onfade=i.onfade?[{fn:i.onfade}]:[],a._onload=i.onload?[{fn:i.onload}]:[],a._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],a._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],a._onpause=i.onpause?[{fn:i.onpause}]:[],a._onplay=i.onplay?[{fn:i.onplay}]:[],a._onstop=i.onstop?[{fn:i.onstop}]:[],a._onmute=i.onmute?[{fn:i.onmute}]:[],a._onvolume=i.onvolume?[{fn:i.onvolume}]:[],a._onrate=i.onrate?[{fn:i.onrate}]:[],a._onseek=i.onseek?[{fn:i.onseek}]:[],a._onunlock=i.onunlock?[{fn:i.onunlock}]:[],a._onresume=[],a._webAudio=t.usingWebAudio&&!a._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var i=this,a=null;if(t.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var l=0;l<i._src.length;l++){var c,h;if(i._format&&i._format[l])c=i._format[l];else{if(h=i._src[l],typeof h!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}c=/^data:audio\/([^;,]+);/i.exec(h),c||(c=/\.([^.]+)$/.exec(h.split("?",1)[0])),c&&(c=c[1].toLowerCase())}if(c||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),c&&t.codecs(c)){a=i._src[l];break}}if(!a){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=a,i._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new o(i),i._webAudio&&u(i),i},play:function(i,a){var l=this,c=null;if(typeof i=="number")c=i,i=null;else{if(typeof i=="string"&&l._state==="loaded"&&!l._sprite[i])return null;if(typeof i>"u"&&(i="__default",!l._playLock)){for(var h=0,v=0;v<l._sounds.length;v++)l._sounds[v]._paused&&!l._sounds[v]._ended&&(h++,c=l._sounds[v]._id);h===1?i=null:c=null}}var p=c?l._soundById(c):l._inactiveSound();if(!p)return null;if(c&&!i&&(i=p._sprite||"__default"),l._state!=="loaded"){p._sprite=i,p._ended=!1;var b=p._id;return l._queue.push({event:"play",action:function(){l.play(b)}}),b}if(c&&!p._paused)return a||l._loadQueue("play"),p._id;l._webAudio&&t._autoResume();var w=Math.max(0,p._seek>0?p._seek:l._sprite[i][0]/1e3),S=Math.max(0,(l._sprite[i][0]+l._sprite[i][1])/1e3-w),x=S*1e3/Math.abs(p._rate),P=l._sprite[i][0]/1e3,Z=(l._sprite[i][0]+l._sprite[i][1])/1e3;p._sprite=i,p._ended=!1;var ot=function(){p._paused=!1,p._seek=w,p._start=P,p._stop=Z,p._loop=!!(p._loop||l._sprite[i][2])};if(w>=Z){l._ended(p);return}var k=p._node;if(l._webAudio){var Mt=function(){l._playLock=!1,ot(),l._refreshBuffer(p);var ie=p._muted||l._muted?0:p._volume;k.gain.setValueAtTime(ie,t.ctx.currentTime),p._playStart=t.ctx.currentTime,typeof k.bufferSource.start>"u"?p._loop?k.bufferSource.noteGrainOn(0,w,86400):k.bufferSource.noteGrainOn(0,w,S):p._loop?k.bufferSource.start(0,w,86400):k.bufferSource.start(0,w,S),x!==1/0&&(l._endTimers[p._id]=setTimeout(l._ended.bind(l,p),x)),a||setTimeout(function(){l._emit("play",p._id),l._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?Mt():(l._playLock=!0,l.once("resume",Mt),l._clearTimer(p._id))}else{var Bt=function(){k.currentTime=w,k.muted=p._muted||l._muted||t._muted||k.muted,k.volume=p._volume*t.volume(),k.playbackRate=p._rate;try{var ie=k.play();if(ie&&typeof Promise<"u"&&(ie instanceof Promise||typeof ie.then=="function")?(l._playLock=!0,ot(),ie.then(function(){l._playLock=!1,k._unlocked=!0,a?l._loadQueue():l._emit("play",p._id)}).catch(function(){l._playLock=!1,l._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),p._ended=!0,p._paused=!0})):a||(l._playLock=!1,ot(),l._emit("play",p._id)),k.playbackRate=p._rate,k.paused){l._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||p._loop?l._endTimers[p._id]=setTimeout(l._ended.bind(l,p),x):(l._endTimers[p._id]=function(){l._ended(p),k.removeEventListener("ended",l._endTimers[p._id],!1)},k.addEventListener("ended",l._endTimers[p._id],!1))}catch(ar){l._emit("playerror",p._id,ar)}};k.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(k.src=l._src,k.load());var or=window&&window.ejecta||!k.readyState&&t._navigator.isCocoonJS;if(k.readyState>=3||or)Bt();else{l._playLock=!0,l._state="loading";var It=function(){l._state="loaded",Bt(),k.removeEventListener(t._canPlayEvent,It,!1)};k.addEventListener(t._canPlayEvent,It,!1),l._clearTimer(p._id)}}return p._id},pause:function(i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(i)}}),a;for(var l=a._getSoundIds(i),c=0;c<l.length;c++){a._clearTimer(l[c]);var h=a._soundById(l[c]);if(h&&!h._paused&&(h._seek=a.seek(l[c]),h._rateSeek=0,h._paused=!0,a._stopFade(l[c]),h._node))if(a._webAudio){if(!h._node.bufferSource)continue;typeof h._node.bufferSource.stop>"u"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),a._cleanBuffer(h._node)}else(!isNaN(h._node.duration)||h._node.duration===1/0)&&h._node.pause();arguments[1]||a._emit("pause",h?h._id:null)}return a},stop:function(i,a){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"stop",action:function(){l.stop(i)}}),l;for(var c=l._getSoundIds(i),h=0;h<c.length;h++){l._clearTimer(c[h]);var v=l._soundById(c[h]);v&&(v._seek=v._start||0,v._rateSeek=0,v._paused=!0,v._ended=!0,l._stopFade(c[h]),v._node&&(l._webAudio?v._node.bufferSource&&(typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),l._cleanBuffer(v._node)):(!isNaN(v._node.duration)||v._node.duration===1/0)&&(v._node.currentTime=v._start||0,v._node.pause(),v._node.duration===1/0&&l._clearSound(v._node))),a||l._emit("stop",v._id))}return l},mute:function(i,a){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"mute",action:function(){l.mute(i,a)}}),l;if(typeof a>"u")if(typeof i=="boolean")l._muted=i;else return l._muted;for(var c=l._getSoundIds(a),h=0;h<c.length;h++){var v=l._soundById(c[h]);v&&(v._muted=i,v._interval&&l._stopFade(v._id),l._webAudio&&v._node?v._node.gain.setValueAtTime(i?0:v._volume,t.ctx.currentTime):v._node&&(v._node.muted=t._muted?!0:i),l._emit("mute",v._id))}return l},volume:function(){var i=this,a=arguments,l,c;if(a.length===0)return i._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var h=i._getSoundIds(),v=h.indexOf(a[0]);v>=0?c=parseInt(a[0],10):l=parseFloat(a[0])}else a.length>=2&&(l=parseFloat(a[0]),c=parseInt(a[1],10));var p;if(typeof l<"u"&&l>=0&&l<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,a)}}),i;typeof c>"u"&&(i._volume=l),c=i._getSoundIds(c);for(var b=0;b<c.length;b++)p=i._soundById(c[b]),p&&(p._volume=l,a[2]||i._stopFade(c[b]),i._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(l,t.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=l*t.volume()),i._emit("volume",p._id))}else return p=c?i._soundById(c):i._sounds[0],p?p._volume:0;return i},fade:function(i,a,l,c){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(i,a,l,c)}}),h;i=Math.min(Math.max(0,parseFloat(i)),1),a=Math.min(Math.max(0,parseFloat(a)),1),l=parseFloat(l),h.volume(i,c);for(var v=h._getSoundIds(c),p=0;p<v.length;p++){var b=h._soundById(v[p]);if(b){if(c||h._stopFade(v[p]),h._webAudio&&!b._muted){var w=t.ctx.currentTime,S=w+l/1e3;b._volume=i,b._node.gain.setValueAtTime(i,w),b._node.gain.linearRampToValueAtTime(a,S)}h._startFadeInterval(b,i,a,l,v[p],typeof c>"u")}}return h},_startFadeInterval:function(i,a,l,c,h,v){var p=this,b=a,w=l-a,S=Math.abs(w/.01),x=Math.max(4,S>0?c/S:c),P=Date.now();i._fadeTo=l,i._interval=setInterval(function(){var Z=(Date.now()-P)/c;P=Date.now(),b+=w*Z,b=Math.round(b*100)/100,w<0?b=Math.max(l,b):b=Math.min(l,b),p._webAudio?i._volume=b:p.volume(b,i._id,!0),v&&(p._volume=b),(l<a&&b<=l||l>a&&b>=l)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,p.volume(l,i._id),p._emit("fade",i._id))},x)},_stopFade:function(i){var a=this,l=a._soundById(i);return l&&l._interval&&(a._webAudio&&l._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(l._interval),l._interval=null,a.volume(l._fadeTo,i),l._fadeTo=null,a._emit("fade",i)),a},loop:function(){var i=this,a=arguments,l,c,h;if(a.length===0)return i._loop;if(a.length===1)if(typeof a[0]=="boolean")l=a[0],i._loop=l;else return h=i._soundById(parseInt(a[0],10)),h?h._loop:!1;else a.length===2&&(l=a[0],c=parseInt(a[1],10));for(var v=i._getSoundIds(c),p=0;p<v.length;p++)h=i._soundById(v[p]),h&&(h._loop=l,i._webAudio&&h._node&&h._node.bufferSource&&(h._node.bufferSource.loop=l,l&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop,i.playing(v[p])&&(i.pause(v[p],!0),i.play(v[p],!0)))));return i},rate:function(){var i=this,a=arguments,l,c;if(a.length===0)c=i._sounds[0]._id;else if(a.length===1){var h=i._getSoundIds(),v=h.indexOf(a[0]);v>=0?c=parseInt(a[0],10):l=parseFloat(a[0])}else a.length===2&&(l=parseFloat(a[0]),c=parseInt(a[1],10));var p;if(typeof l=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,a)}}),i;typeof c>"u"&&(i._rate=l),c=i._getSoundIds(c);for(var b=0;b<c.length;b++)if(p=i._soundById(c[b]),p){i.playing(c[b])&&(p._rateSeek=i.seek(c[b]),p._playStart=i._webAudio?t.ctx.currentTime:p._playStart),p._rate=l,i._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(l,t.ctx.currentTime):p._node&&(p._node.playbackRate=l);var w=i.seek(c[b]),S=(i._sprite[p._sprite][0]+i._sprite[p._sprite][1])/1e3-w,x=S*1e3/Math.abs(p._rate);(i._endTimers[c[b]]||!p._paused)&&(i._clearTimer(c[b]),i._endTimers[c[b]]=setTimeout(i._ended.bind(i,p),x)),i._emit("rate",p._id)}}else return p=i._soundById(c),p?p._rate:i._rate;return i},seek:function(){var i=this,a=arguments,l,c;if(a.length===0)i._sounds.length&&(c=i._sounds[0]._id);else if(a.length===1){var h=i._getSoundIds(),v=h.indexOf(a[0]);v>=0?c=parseInt(a[0],10):i._sounds.length&&(c=i._sounds[0]._id,l=parseFloat(a[0]))}else a.length===2&&(l=parseFloat(a[0]),c=parseInt(a[1],10));if(typeof c>"u")return 0;if(typeof l=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,a)}}),i;var p=i._soundById(c);if(p)if(typeof l=="number"&&l>=0){var b=i.playing(c);b&&i.pause(c,!0),p._seek=l,p._ended=!1,i._clearTimer(c),!i._webAudio&&p._node&&!isNaN(p._node.duration)&&(p._node.currentTime=l);var w=function(){b&&i.play(c,!0),i._emit("seek",c)};if(b&&!i._webAudio){var S=function(){i._playLock?setTimeout(S,0):w()};setTimeout(S,0)}else w()}else if(i._webAudio){var x=i.playing(c)?t.ctx.currentTime-p._playStart:0,P=p._rateSeek?p._rateSeek-p._seek:0;return p._seek+(P+x*Math.abs(p._rate))}else return p._node.currentTime;return i},playing:function(i){var a=this;if(typeof i=="number"){var l=a._soundById(i);return l?!l._paused:!1}for(var c=0;c<a._sounds.length;c++)if(!a._sounds[c]._paused)return!0;return!1},duration:function(i){var a=this,l=a._duration,c=a._soundById(i);return c&&(l=a._sprite[c._sprite][1]/1e3),l},state:function(){return this._state},unload:function(){for(var i=this,a=i._sounds,l=0;l<a.length;l++)a[l]._paused||i.stop(a[l]._id),i._webAudio||(i._clearSound(a[l]._node),a[l]._node.removeEventListener("error",a[l]._errorFn,!1),a[l]._node.removeEventListener(t._canPlayEvent,a[l]._loadFn,!1),a[l]._node.removeEventListener("ended",a[l]._endFn,!1),t._releaseHtml5Audio(a[l]._node)),delete a[l]._node,i._clearTimer(a[l]._id);var c=t._howls.indexOf(i);c>=0&&t._howls.splice(c,1);var h=!0;for(l=0;l<t._howls.length;l++)if(t._howls[l]._src===i._src||i._src.indexOf(t._howls[l]._src)>=0){h=!1;break}return s&&h&&delete s[i._src],t.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,a,l,c){var h=this,v=h["_on"+i];return typeof a=="function"&&v.push(c?{id:l,fn:a,once:c}:{id:l,fn:a}),h},off:function(i,a,l){var c=this,h=c["_on"+i],v=0;if(typeof a=="number"&&(l=a,a=null),a||l)for(v=0;v<h.length;v++){var p=l===h[v].id;if(a===h[v].fn&&p||!a&&p){h.splice(v,1);break}}else if(i)c["_on"+i]=[];else{var b=Object.keys(c);for(v=0;v<b.length;v++)b[v].indexOf("_on")===0&&Array.isArray(c[b[v]])&&(c[b[v]]=[])}return c},once:function(i,a,l){var c=this;return c.on(i,a,l,1),c},_emit:function(i,a,l){for(var c=this,h=c["_on"+i],v=h.length-1;v>=0;v--)(!h[v].id||h[v].id===a||i==="load")&&(setTimeout((function(p){p.call(this,a,l)}).bind(c,h[v].fn),0),h[v].once&&c.off(i,h[v].fn,h[v].id));return c._loadQueue(i),c},_loadQueue:function(i){var a=this;if(a._queue.length>0){var l=a._queue[0];l.event===i&&(a._queue.shift(),a._loadQueue()),i||l.action()}return a},_ended:function(i){var a=this,l=i._sprite;if(!a._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(a._ended.bind(a,i),100),a;var c=!!(i._loop||a._sprite[l][2]);if(a._emit("end",i._id),!a._webAudio&&c&&a.stop(i._id,!0).play(i._id),a._webAudio&&c){a._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=t.ctx.currentTime;var h=(i._stop-i._start)*1e3/Math.abs(i._rate);a._endTimers[i._id]=setTimeout(a._ended.bind(a,i),h)}return a._webAudio&&!c&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,a._clearTimer(i._id),a._cleanBuffer(i._node),t._autoSuspend()),!a._webAudio&&!c&&a.stop(i._id,!0),a},_clearTimer:function(i){var a=this;if(a._endTimers[i]){if(typeof a._endTimers[i]!="function")clearTimeout(a._endTimers[i]);else{var l=a._soundById(i);l&&l._node&&l._node.removeEventListener("ended",a._endTimers[i],!1)}delete a._endTimers[i]}return a},_soundById:function(i){for(var a=this,l=0;l<a._sounds.length;l++)if(i===a._sounds[l]._id)return a._sounds[l];return null},_inactiveSound:function(){var i=this;i._drain();for(var a=0;a<i._sounds.length;a++)if(i._sounds[a]._ended)return i._sounds[a].reset();return new o(i)},_drain:function(){var i=this,a=i._pool,l=0,c=0;if(!(i._sounds.length<a)){for(c=0;c<i._sounds.length;c++)i._sounds[c]._ended&&l++;for(c=i._sounds.length-1;c>=0;c--){if(l<=a)return;i._sounds[c]._ended&&(i._webAudio&&i._sounds[c]._node&&i._sounds[c]._node.disconnect(0),i._sounds.splice(c,1),l--)}}},_getSoundIds:function(i){var a=this;if(typeof i>"u"){for(var l=[],c=0;c<a._sounds.length;c++)l.push(a._sounds[c]._id);return l}else return[i]},_refreshBuffer:function(i){var a=this;return i._node.bufferSource=t.ctx.createBufferSource(),i._node.bufferSource.buffer=s[a._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,t.ctx.currentTime),a},_cleanBuffer:function(i){var a=this,l=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!i.bufferSource)return a;if(t._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),l))try{i.bufferSource.buffer=t._scratchBuffer}catch{}return i.bufferSource=null,a},_clearSound:function(i){var a=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);a||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(i){this._parent=i,this.init()};o.prototype={init:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,a._sounds.push(i),i.create(),i},create:function(){var i=this,a=i._parent,l=t._muted||i._muted||i._parent._muted?0:i._volume;return a._webAudio?(i._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),i._node.gain.setValueAtTime(l,t.ctx.currentTime),i._node.paused=!0,i._node.connect(t.masterGain)):t.noAudio||(i._node=t._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(t._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=a._src,i._node.preload=a._preload===!0?"auto":a._preload,i._node.volume=l*t.volume(),i._node.load()),i},reset:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,a=i._parent;a._duration=Math.ceil(i._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),i._node.removeEventListener(t._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,a=i._parent;a._duration===1/0&&(a._duration=Math.ceil(i._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var s={},u=function(i){var a=i._src;if(s[a]){i._duration=s[a].duration,_(i);return}if(/^data:[^;]+;base64,/.test(a)){for(var l=atob(a.split(",")[1]),c=new Uint8Array(l.length),h=0;h<l.length;++h)c[h]=l.charCodeAt(h);d(c.buffer,i)}else{var v=new XMLHttpRequest;v.open(i._xhr.method,a,!0),v.withCredentials=i._xhr.withCredentials,v.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(p){v.setRequestHeader(p,i._xhr.headers[p])}),v.onload=function(){var p=(v.status+"")[0];if(p!=="0"&&p!=="2"&&p!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+v.status+".");return}d(v.response,i)},v.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete s[a],i.load())},f(v)}},f=function(i){try{i.send()}catch{i.onerror()}},d=function(i,a){var l=function(){a._emit("loaderror",null,"Decoding audio data failed.")},c=function(h){h&&a._sounds.length>0?(s[a._src]=h,_(a,h)):l()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(i).then(c).catch(l):t.ctx.decodeAudioData(i,c,l)},_=function(i,a){a&&!i._duration&&(i._duration=a.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},m=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),a=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),l=a?parseInt(a[1],10):null;if(i&&l&&l<9){var c=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!c&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};e.Howler=t,e.Howl=r,typeof me<"u"?(me.HowlerGlobal=n,me.Howler=t,me.Howl=r,me.Sound=o):typeof window<"u"&&(window.HowlerGlobal=n,window.Howler=t,window.Howl=r,window.Sound=o)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var o=r._howls.length-1;o>=0;o--)r._howls[o].stereo(t);return r},HowlerGlobal.prototype.pos=function(t,r,o){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(r=typeof r!="number"?s._pos[1]:r,o=typeof o!="number"?s._pos[2]:o,typeof t=="number")s._pos=[t,r,o],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,r,o,s,u,f){var d=this;if(!d.ctx||!d.ctx.listener)return d;var _=d._orientation;if(r=typeof r!="number"?_[1]:r,o=typeof o!="number"?_[2]:o,s=typeof s!="number"?_[3]:s,u=typeof u!="number"?_[4]:u,f=typeof f!="number"?_[5]:f,typeof t=="number")d._orientation=[t,r,o,s,u,f],typeof d.ctx.listener.forwardX<"u"?(d.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),d.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),d.ctx.listener.forwardZ.setTargetAtTime(o,Howler.ctx.currentTime,.1),d.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),d.ctx.listener.upY.setTargetAtTime(u,Howler.ctx.currentTime,.1),d.ctx.listener.upZ.setTargetAtTime(f,Howler.ctx.currentTime,.1)):d.ctx.listener.setOrientation(t,r,o,s,u,f);else return _;return d},Howl.prototype.init=function(t){return function(r){var o=this;return o._orientation=r.orientation||[1,0,0],o._stereo=r.stereo||null,o._pos=r.pos||null,o._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},o._onstereo=r.onstereo?[{fn:r.onstereo}]:[],o._onpos=r.onpos?[{fn:r.onpos}]:[],o._onorientation=r.onorientation?[{fn:r.onorientation}]:[],t.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,r){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"stereo",action:function(){o.stereo(t,r)}}),o;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof t=="number")o._stereo=t,o._pos=[t,0,0];else return o._stereo;for(var u=o._getSoundIds(r),f=0;f<u.length;f++){var d=o._soundById(u[f]);if(d)if(typeof t=="number")d._stereo=t,d._pos=[t,0,0],d._node&&(d._pannerAttr.panningModel="equalpower",(!d._panner||!d._panner.pan)&&n(d,s),s==="spatial"?typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):d._panner.setPosition(t,0,0):d._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),o._emit("stereo",d._id);else return d._stereo}return o},Howl.prototype.pos=function(t,r,o,s){var u=this;if(!u._webAudio)return u;if(u._state!=="loaded")return u._queue.push({event:"pos",action:function(){u.pos(t,r,o,s)}}),u;if(r=typeof r!="number"?0:r,o=typeof o!="number"?-.5:o,typeof s>"u")if(typeof t=="number")u._pos=[t,r,o];else return u._pos;for(var f=u._getSoundIds(s),d=0;d<f.length;d++){var _=u._soundById(f[d]);if(_)if(typeof t=="number")_._pos=[t,r,o],_._node&&((!_._panner||_._panner.pan)&&n(_,"spatial"),typeof _._panner.positionX<"u"?(_._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),_._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),_._panner.positionZ.setValueAtTime(o,Howler.ctx.currentTime)):_._panner.setPosition(t,r,o)),u._emit("pos",_._id);else return _._pos}return u},Howl.prototype.orientation=function(t,r,o,s){var u=this;if(!u._webAudio)return u;if(u._state!=="loaded")return u._queue.push({event:"orientation",action:function(){u.orientation(t,r,o,s)}}),u;if(r=typeof r!="number"?u._orientation[1]:r,o=typeof o!="number"?u._orientation[2]:o,typeof s>"u")if(typeof t=="number")u._orientation=[t,r,o];else return u._orientation;for(var f=u._getSoundIds(s),d=0;d<f.length;d++){var _=u._soundById(f[d]);if(_)if(typeof t=="number")_._orientation=[t,r,o],_._node&&(_._panner||(_._pos||(_._pos=u._pos||[0,0,-.5]),n(_,"spatial")),typeof _._panner.orientationX<"u"?(_._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),_._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),_._panner.orientationZ.setValueAtTime(o,Howler.ctx.currentTime)):_._panner.setOrientation(t,r,o)),u._emit("orientation",_._id);else return _._orientation}return u},Howl.prototype.pannerAttr=function(){var t=this,r=arguments,o,s,u;if(!t._webAudio)return t;if(r.length===0)return t._pannerAttr;if(r.length===1)if(typeof r[0]=="object")o=r[0],typeof s>"u"&&(o.pannerAttr||(o.pannerAttr={coneInnerAngle:o.coneInnerAngle,coneOuterAngle:o.coneOuterAngle,coneOuterGain:o.coneOuterGain,distanceModel:o.distanceModel,maxDistance:o.maxDistance,refDistance:o.refDistance,rolloffFactor:o.rolloffFactor,panningModel:o.panningModel}),t._pannerAttr={coneInnerAngle:typeof o.pannerAttr.coneInnerAngle<"u"?o.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof o.pannerAttr.coneOuterAngle<"u"?o.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof o.pannerAttr.coneOuterGain<"u"?o.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof o.pannerAttr.distanceModel<"u"?o.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof o.pannerAttr.maxDistance<"u"?o.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof o.pannerAttr.refDistance<"u"?o.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof o.pannerAttr.rolloffFactor<"u"?o.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof o.pannerAttr.panningModel<"u"?o.pannerAttr.panningModel:t._panningModel});else return u=t._soundById(parseInt(r[0],10)),u?u._pannerAttr:t._pannerAttr;else r.length===2&&(o=r[0],s=parseInt(r[1],10));for(var f=t._getSoundIds(s),d=0;d<f.length;d++)if(u=t._soundById(f[d]),u){var _=u._pannerAttr;_={coneInnerAngle:typeof o.coneInnerAngle<"u"?o.coneInnerAngle:_.coneInnerAngle,coneOuterAngle:typeof o.coneOuterAngle<"u"?o.coneOuterAngle:_.coneOuterAngle,coneOuterGain:typeof o.coneOuterGain<"u"?o.coneOuterGain:_.coneOuterGain,distanceModel:typeof o.distanceModel<"u"?o.distanceModel:_.distanceModel,maxDistance:typeof o.maxDistance<"u"?o.maxDistance:_.maxDistance,refDistance:typeof o.refDistance<"u"?o.refDistance:_.refDistance,rolloffFactor:typeof o.rolloffFactor<"u"?o.rolloffFactor:_.rolloffFactor,panningModel:typeof o.panningModel<"u"?o.panningModel:_.panningModel};var m=u._panner;m||(u._pos||(u._pos=t._pos||[0,0,-.5]),n(u,"spatial"),m=u._panner),m.coneInnerAngle=_.coneInnerAngle,m.coneOuterAngle=_.coneOuterAngle,m.coneOuterGain=_.coneOuterGain,m.distanceModel=_.distanceModel,m.maxDistance=_.maxDistance,m.refDistance=_.refDistance,m.rolloffFactor=_.rolloffFactor,m.panningModel=_.panningModel}return t},Sound.prototype.init=function(t){return function(){var r=this,o=r._parent;r._orientation=o._orientation,r._stereo=o._stereo,r._pos=o._pos,r._pannerAttr=o._pannerAttr,t.call(this),r._stereo?o.stereo(r._stereo):r._pos&&o.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var r=this,o=r._parent;return r._orientation=o._orientation,r._stereo=o._stereo,r._pos=o._pos,r._pannerAttr=o._pannerAttr,r._stereo?o.stereo(r._stereo):r._pos?o.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,o._refreshBuffer(r)),t.call(this)}}(Sound.prototype.reset);var n=function(t,r){r=r||"spatial",r==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()}(ft)),ft}var it=to();let j=null,H=0;const Ee=[{title:"Cone Vibes Vol. 1",file:"cone_vibes_1.mp3"},{title:"Ice Chill Nocturne",file:"ice_chill_nocturne.mp3"},{title:"Frosted Frequencies",file:"frosted_frequencies.mp3"}];function no(e){j&&j.stop();const n=Ee[e];j=new it.Howl({src:[`assets/audio/${n.file}`],loop:y.settings.loop,volume:y.settings.mute?0:1,onend:()=>{y.settings.loop||zn()}}),j.play(),Zn(n.title)}function Zn(e){const n=document.getElementById("currentTrack");n&&(n.textContent=e||"(none)")}function Lt(e=H){H=e,no(H)}function ro(){if(!j)return Lt();j.playing()?j.pause():j.play()}function zn(){H=y.settings.shuffle?Math.floor(Math.random()*Ee.length):(H+1)%Ee.length,Lt(H)}function io(){H=(H-1+Ee.length)%Ee.length,Lt(H)}function oo(){const e=!y.settings.shuffle;return y.setSetting("shuffle",e),e}function ao(e){return y.setSetting("loop",e),j&&j.loop(e),e}function er(){return y.settings.loop}function so(){return y.settings.shuffle}function uo(){j||Zn("(none)")}window.addEventListener("settingChanged",e=>{const{key:n,value:t}=e.detail;n==="mute"&&it.Howler.volume(t?0:1)});function lo(){const e=y.settings.mute,n=er(),t=so();return`
    <div class="settings-block">
      <label>
        <input type="checkbox" id="muteToggle" ${e?"checked":""} />
         Mute all sound
      </label>
    </div>

    <div class="settings-block jukebox">
      <h3> Now Playing:</h3>
      <div id="currentTrack">(none)</div>
      <input type="range" id="trackProgress" value="0" min="0" max="100" disabled />
      <div id="trackTimer">0:00 / 0:00</div>

      <div class="jukebox-controls">
        <button id="btnPrev" class="icon-btn"></button>
        <button id="btnPlayPause" class="icon-btn"></button>
        <button id="btnNext" class="icon-btn"></button>
        <button id="btnLoop" class="icon-btn ${n?"active":""}"></button>
        <button id="btnShuffle" class="icon-btn ${t?"active":""}"></button>
      </div>

      <div class="jukebox-message" style="margin-top: 15px; font-size: 14px; line-height: 1.6; color: #cccccc;">
        You made it to the music player. Thats kinda amazing. <br>
        Math creates the music that connects the soul to the numbers of the festival.<br>
        I'm honored you're listening. Some of these tracks? You can <em>only</em> hear them here  at SnowCone MathFest. Enjoy! 
      </div>
    </div>
  `}function co(){var r,o,s;const e=document.getElementById("muteToggle"),n=document.getElementById("btnLoop"),t=document.getElementById("btnShuffle");e&&e.addEventListener("change",()=>{const u=e.checked;y.setSetting("mute",u),it.Howler.volume(u?0:1)}),(r=document.getElementById("btnPlayPause"))==null||r.addEventListener("click",ro),(o=document.getElementById("btnNext"))==null||o.addEventListener("click",zn),(s=document.getElementById("btnPrev"))==null||s.addEventListener("click",io),n==null||n.addEventListener("click",()=>{const u=ao(!er());n.classList.toggle("active",u)}),t==null||t.addEventListener("click",()=>{const u=oo();t.classList.toggle("active",u)}),uo()}function fo(){var n;const e=((n=window==null?void 0:window.devFlags)==null?void 0:n.build)||"unknown";return JSON.stringify(y,null,2),`
    <div class="settings-block">
      <h3> SnowCone MathFest v0.3.0</h3>
      <p><strong>Build:</strong> <code>${e}</code></p>
      <p>Crafted with cosmic cones </p>
    </div>

    <div class="settings-block">
      <h3> v0.3.0 Update</h3>
      <p>
          New startup sequence with starfield + snow cone<br>
          Scene transitions now live (truck + cone animation)<br>
          Menu label clicks use smooth animated transitions<br>
          Fixed info modal title bug (no more cosmic overlay glitch)<br>
          Startup + transition animations re-centered + sped up<br>
          Awaiting mobile confirmation before locking in visuals
      </p>
    </div>

    <div class="settings-block">
      <h3> App Info</h3>
      <p>This app works offline after install!<br>To save your data, don't clear site storage.</p>
      <p>If you're on an iPhone or iPad using Safari:<br>
        Tap the <strong>Share</strong> icon, then choose <strong>"Add to Home Screen"</strong> to install the app.</p>
      <p>If you're using Android or Chrome:<br>
        You can install this app for offline play:
      </p>
      <button class="track-button" id="installAppBtn" style="display: none;"> Install App</button>
    </div>

    <div class="settings-block">
      <h3> Tools</h3>

      <p>Want to back up or transfer your progress?</p>

      <p>
        <strong> Download Save:</strong><br>
        Exports your current game progress (XP, badges, themes) as a <code>.json</code> file.
      </p>

      <p>
        <strong> Import Save:</strong><br>
        Load your save file to restore or sync across devices.<br>
        <em> This will replace your current data!</em>
      </p>

      <p>
        <strong> Reset Progress:</strong><br>
        Clears all saved progress and starts fresh.
      </p>

      <input type="file" id="importSave" accept="application/json" style="display:none;" />
      <button class="track-button" id="downloadSave"> Download Save</button>
      <button class="track-button" id="importSaveBtn"> Import Save</button>
      <button class="track-button" id="resetProgress"> Reset Progress</button>
    </div>
  `}function _o(){const e=document.getElementById("downloadSave"),n=document.getElementById("resetProgress"),t=document.getElementById("importSaveBtn"),r=document.getElementById("importSave");e&&e.addEventListener("click",()=>{const o=new Blob([JSON.stringify(y.toJSON(),null,2)],{type:"application/json"}),s=URL.createObjectURL(o),u=document.createElement("a");u.href=s,u.download="snowcone_save_data.json",u.click(),URL.revokeObjectURL(s)}),n&&n.addEventListener("click",()=>{confirm("Reset all progress? This cannot be undone.")&&(localStorage.clear(),location.reload())}),t&&r&&(t.addEventListener("click",()=>r.click()),r.addEventListener("change",o=>{var f;const s=(f=o.target.files)==null?void 0:f[0];if(!s)return;const u=new FileReader;u.onload=d=>{try{const _=JSON.parse(d.target.result);Object.assign(y,_),sessionStorage.setItem("forceWelcomeReload","true"),alert(" Save data loaded! Reloading..."),setTimeout(()=>location.reload(),100)}catch{alert(" Failed to load save. Invalid file format.")}},u.readAsText(s)}))}function Pt(e="profile"){const n=document.getElementById("cosmicModal"),t=document.getElementById("cosmicOverlay");if(!n)return console.warn(" cosmicModal not found");n.classList.remove("hidden"),t==null||t.classList.remove("hidden"),t==null||t.classList.add("show"),nr(e)}function tr(){const e=document.getElementById("cosmicModal"),n=document.getElementById("cosmicOverlay");e&&e.classList.add("hidden"),n==null||n.classList.remove("show"),n==null||n.classList.add("hidden")}function nr(e){const n=document.getElementById("modalContent");if(!n)return;switch(document.querySelectorAll(".tab-button").forEach(r=>{r.classList.toggle("active",r.dataset.tab===e)}),e){case"profile":n.innerHTML=Qi(),Ji();break;case"themes":n.innerHTML=zi(),eo();break;case"music":n.innerHTML=lo(),co();break;case"version":n.innerHTML=fo(),_o();break;default:n.innerHTML=`<p>Unknown tab: ${e}</p>`;break}const t=document.querySelector(".modal-close");t&&t.addEventListener("click",()=>{console.log(" Cosmic modal closing!"),tr()})}function po(e){const n=e.currentTarget.dataset.tab;console.log(` Tab clicked: ${n}`),nr(n)}function ho(){var e;console.log(" Setting up tab listeners..."),document.querySelectorAll(".tab-button").forEach(n=>{n.addEventListener("click",po)}),(e=document.querySelector(".label-options"))==null||e.addEventListener("click",()=>{console.log(" Options clicked  opening modal"),Pt("profile")})}document.addEventListener("DOMContentLoaded",()=>{ho(),console.log(" Cosmic modal listeners wired.")});window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".modal-close");e==null||e.addEventListener("click",()=>{console.log(" Closing modal from global listener"),tr()})});window.openModal=Pt;W(()=>{var n;((n=y.uiState)==null?void 0:n.triggerBadgeModal)&&(console.log(" Badge modal trigger received via autorun!"),Pt("profile"),y.clearTriggerBadgeModal())});let Ne=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Ne=e;const n=document.getElementById("installAppBtn");n&&(n.style.display="inline-block",n.addEventListener("click",()=>{Ne.prompt(),Ne.userChoice.then(t=>{t.outcome==="accepted"?console.log(" User installed the app!"):console.log(" Install dismissed."),n.style.display="none",Ne=null})}))});function rr(){const e=document.getElementById("infoModal");e&&(e.classList.remove("hidden"),e.style.display="flex")}function ir(){const e=document.getElementById("infoModal");e&&(e.classList.add("hidden"),e.style.display="none")}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".menu-title-top");e?(console.log(" Title found. Binding click."),e.addEventListener("click",()=>{console.log(" Title click detected"),rr()})):console.warn(" .menu-title-top not found!")});document.addEventListener("keydown",e=>{e.key==="Escape"&&ir()});console.log(" infoModal.js loaded");window.openInfoModal=rr;window.closeInfoModal=ir;let Re=!1;function ve(e){if(Re)return;Re=!0,y.uiState.transitioning=!0;let n=document.getElementById("scene-transition");if(!n){n=document.createElement("div"),n.id="scene-transition";const o="/SnowCone-MathFest/";n.innerHTML=`
      <img class="starfield" style="position:absolute; inset:0; width:100%; height:100%; object-fit:cover; z-index:1; animation:fade-in 0.25s ease-in;" src="${o}assets/img/transitions/transitionStars.png" />
      <img class="transition-truck" src="${o}assets/img/transitions/snowConeTruck.png" alt="Truck" />
      <img class="transition-cone" src="${o}assets/img/transitions/snowCone.png" alt="Snow Cone" />
    `,document.body.appendChild(n)}const t=n.querySelector(".transition-truck"),r=n.querySelector(".transition-cone");if(!t||!r){console.error(" Transition elements not found!"),Re=!1,y.uiState.transitioning=!1;return}t.style.transition="none",r.style.transition="none",t.style.transform="translateX(-150%)",r.style.transform="translateX(150%)",n.classList.add("active"),t.offsetWidth,t.style.transition="transform 0.8s ease-out",r.style.transition="transform 0.8s ease-out 0.5s",t.style.transform="translateX(150vw)",r.style.transform="translateX(-150vw)",setTimeout(()=>{n.classList.remove("active"),Re=!1,y.uiState.transitioning=!1,e==null||e()},1400)}function vo(){console.log(" Loading QuickServe Mode"),y.stats.quickServe.sessions++;const e=document.querySelector(".menu-wrapper"),n=document.getElementById("game-container");e==null||e.classList.add("hidden"),n.classList.remove("hidden"),n.style.display="flex",n.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/quickServe/quickserveBG.png" alt="QuickServe Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> QuickServe Pavilion</h1>
        </div>
        <div class="qs-content">
          <div class="score-box">
            <span>Score: </span><span id="qsScore">0</span>
          </div>

          <div class="math-stack">
            <span id="mathProblem">12 + 7 = ?</span>
            <input id="mathInput" type="number" placeholder="Answer..." />
            <button id="submitAnswer"> Submit</button>
          </div>

          <div class="cone-status">
            <span id="coneResultMsg"></span>
          </div>
        </div>

        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const i=document.getElementById("modeBackground");i&&(i.src=i.src,i.style.pointerEvents="none",console.log(" Forced mobile refresh + pointer fix"))},10)});const t=document.getElementById("returnToMenu");t==null||t.addEventListener("click",()=>{ve(()=>{n.classList.add("hidden"),n.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})});let r=0;const o=document.getElementById("mathProblem"),s=document.getElementById("mathInput"),u=document.getElementById("submitAnswer"),f=document.getElementById("qsScore"),d=document.getElementById("coneResultMsg");function _(){const i=Math.floor(Math.random()*20)+1,a=Math.floor(Math.random()*20)+1;o.textContent=`${i} + ${a} = ?`,o.dataset.answer=i+a,s.value="",s.focus()}function m(){const i=parseInt(s.value.trim(),10),a=parseInt(o.dataset.answer,10);i===a?(r+=1,f.textContent=r,y.addXP(3),d.textContent=" Nice! +3 XP",d.style.color="#00ffee",y.profile.xp>=100&&!y.profile.badges.includes("cone_master")&&(y.unlockBadge("cone_master"),console.log(" Badge unlocked: cone_master")),setTimeout(()=>d.textContent="",1500),_()):(d.textContent=" Try again!",d.style.color="#ff5555",setTimeout(()=>d.textContent="",1500))}u==null||u.addEventListener("click",m),s==null||s.addEventListener("keydown",i=>{i.key==="Enter"&&m()}),_()}function mo(){var t;console.log(" Loading Kids Mode");const e=document.querySelector(".menu-wrapper"),n=document.getElementById("game-container");e==null||e.classList.add("hidden"),n.classList.remove("hidden"),n.style.display="flex",n.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/kidsCamping/kidsBG.png" alt="Kids Mode Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Kids Mode  Camping Grid</h1>
        </div>
        <div class="qs-content">
          <p>Matching + stacking cones for kids. Not wired yet!</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const r=document.getElementById("modeBackground");r&&(r.src=r.src,r.style.pointerEvents="none",console.log(" Kids Mode background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{ve(()=>{n.classList.add("hidden"),n.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function go(){var t;console.log(" Loading Math Tips Mode");const e=document.querySelector(".menu-wrapper"),n=document.getElementById("game-container");e==null||e.classList.add("hidden"),n.classList.remove("hidden"),n.style.display="flex",n.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/mathTips/mathtipsBG.png" alt="Math Tips Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Math Tips Village</h1>
        </div>
        <div class="qs-content">
          <p>Pythagoras Cat isnt ready, but hes totally vibin' in the truck rn.</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const r=document.getElementById("modeBackground");r&&(r.src=r.src,r.style.pointerEvents="none",console.log(" Math Tips background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{ve(()=>{n.classList.add("hidden"),n.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function bo(){var t;console.log(" Loading Story Mode");const e=document.querySelector(".menu-wrapper"),n=document.getElementById("game-container");e==null||e.classList.add("hidden"),n.classList.remove("hidden"),n.style.display="flex",n.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/storymodeForest/storyBG.png" alt="Story Mode Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Story Mode  Forest Entry</h1>
        </div>
        <div class="qs-content">
          <p>The forest is quiet... too quiet. But the math ghosts are whispering.</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const r=document.getElementById("modeBackground");r&&(r.src=r.src,r.style.pointerEvents="none",console.log(" Story Mode background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{ve(()=>{n.classList.add("hidden"),n.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function yo(){var t;console.log(" Loading Infinity Mode");const e=document.querySelector(".menu-wrapper"),n=document.getElementById("game-container");e==null||e.classList.add("hidden"),n.classList.remove("hidden"),n.style.display="flex",n.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/infinityLake/infinityBG.png" alt="Infinity Mode Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Infinity Lake</h1>
        </div>
        <div class="qs-content">
          <p>Endless play, infinite cones. Just chill it's not wired yet.</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const r=document.getElementById("modeBackground");r&&(r.src=r.src,r.style.pointerEvents="none",console.log(" Infinity Mode background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{ve(()=>{n.classList.add("hidden"),n.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function Ao(e){switch(y.setMode(e),e){case"quickServe":vo();break;case"kids":mo();break;case"mathtips":go();break;case"story":bo();break;case"infinity":yo();break;default:console.warn(` Unknown mode: ${e}`)}}function wo(){const e=document.querySelector(".menu-wrapper");document.getElementById("menuImage"),K(),Object.entries({kids:"kids",quick:"quickServe",tips:"mathtips",story:"story",infinity:"infinity"}).forEach(([r,o])=>{const s=document.querySelector(`.menu-label.${r}`);s&&s.addEventListener("click",()=>{e.classList.add("hidden"),ve(()=>{console.log(` Launching mode: ${o}`),y.setLastPlayed(Date.now()),y.setMode(o),Ao(o)})})});const t=document.querySelector(".menu-title-top");t==null||t.addEventListener("click",()=>openInfoModal("info")),W(()=>{var r;(r=y.settings)==null||r.theme,K()}),e.classList.remove("hidden")}let Qt=0;document.addEventListener("touchend",e=>{const n=new Date().getTime();n-Qt<=300&&e.preventDefault(),Qt=n},!0);document.addEventListener("gesturestart",e=>{e.preventDefault()});console.log(" VITE_SECRET_KEY:","radical123");const ge="/SnowCone-MathFest/",So=[{rel:"icon",type:"image/x-icon",href:`${ge}favicon.ico`},{rel:"icon",type:"image/png",sizes:"192x192",href:`${ge}icon-192.png`},{rel:"icon",type:"image/png",sizes:"512x512",href:`${ge}icon-512.png`},{rel:"apple-touch-icon",href:`${ge}apple-touch-icon.png`},{rel:"manifest",href:`${ge}manifest.json`}];So.forEach(e=>{const n=document.createElement("link");Object.entries(e).forEach(([t,r])=>n.setAttribute(t,r)),document.head.appendChild(n)});window.addEventListener("DOMContentLoaded",()=>{console.log(" DOM ready. Starting app..."),K(),console.log(" Background applied."),W(()=>{it.Howler.volume(y.settings.mute?0:1),console.log(" MobX mute autorun ran.")});const e=document.getElementById("startup-screen");if(e)console.log(" Found #startup-screen");else{console.error(" #startup-screen not found! Cannot start app.");return}setTimeout(()=>{console.log(" Fading out startup..."),e.style.opacity=0,setTimeout(()=>{console.log(" Removing startup, launching menu..."),e.remove(),wo()},600)},2500)});
