var cr=Object.defineProperty;var fr=(e,r,t)=>r in e?cr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var oe=(e,r,t)=>fr(e,typeof r!="symbol"?r+"":r,t);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();function T(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];throw new Error(typeof e=="number"?"[MobX] minified error nr: "+e+(t.length?" "+t.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var dr={};function Zt(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:dr}var zt=Object.assign,Fe=Object.getOwnPropertyDescriptor,q=Object.defineProperty,Qe=Object.prototype,_t=[];Object.freeze(_t);var en={};Object.freeze(en);var _r=typeof Proxy<"u",pr=Object.toString();function tn(){_r||T("Proxy not available")}function nn(e){var r=!1;return function(){if(!r)return r=!0,e.apply(this,arguments)}}var se=function(){};function R(e){return typeof e=="function"}function Z(e){var r=typeof e;switch(r){case"string":case"symbol":case"number":return!0}return!1}function We(e){return e!==null&&typeof e=="object"}function U(e){if(!We(e))return!1;var r=Object.getPrototypeOf(e);if(r==null)return!0;var t=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t.toString()===pr}function rn(e){var r=e==null?void 0:e.constructor;return r?r.name==="GeneratorFunction"||r.displayName==="GeneratorFunction":!1}function Je(e,r,t){q(e,r,{enumerable:!1,writable:!0,configurable:!0,value:t})}function on(e,r,t){q(e,r,{enumerable:!1,writable:!1,configurable:!0,value:t})}function z(e,r){var t="isMobX"+e;return r.prototype[t]=!0,function(n){return We(n)&&n[t]===!0}}function he(e){return e instanceof Map}function Pe(e){return e instanceof Set}var an=typeof Object.getOwnPropertySymbols<"u";function hr(e){var r=Object.keys(e);if(!an)return r;var t=Object.getOwnPropertySymbols(e);return t.length?[].concat(r,t.filter(function(n){return Qe.propertyIsEnumerable.call(e,n)})):r}var Se=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:an?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function sn(e){return e===null?null:typeof e=="object"?""+e:e}function Q(e,r){return Qe.hasOwnProperty.call(e,r)}var vr=Object.getOwnPropertyDescriptors||function(r){var t={};return Se(r).forEach(function(n){t[n]=Fe(r,n)}),t};function mr(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yr(n.key),n)}}function At(e,r,t){return r&&mr(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oe(){return Oe=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Oe.apply(this,arguments)}function un(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,pt(e,r)}function pt(e,r){return pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pt(e,r)}function st(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gr(e,r){if(e){if(typeof e=="string")return jt(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return jt(e,r)}}function jt(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ue(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=gr(e))||r){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function br(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function yr(e){var r=br(e,"string");return typeof r=="symbol"?r:String(r)}var le=Symbol("mobx-stored-annotations");function F(e){function r(t,n){Le(t,n,e)}return Object.assign(r,e)}function Le(e,r,t){Q(e,le)||Je(e,le,Oe({},e[le])),kr(t)||(e[le][r]=t)}var A=Symbol("mobx administration"),Me=function(){function e(t){t===void 0&&(t="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.batchId_=void 0,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=O.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=t,this.batchId_=g.inBatch?g.batchId:NaN}var r=e.prototype;return r.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},r.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},r.reportObserved=function(){return En(this)},r.reportChanged=function(){(!g.inBatch||this.batchId_!==g.batchId)&&(g.stateVersion=g.stateVersion<Number.MAX_SAFE_INTEGER?g.stateVersion+1:Number.MIN_SAFE_INTEGER,this.batchId_=NaN),C(),xn(this),j()},r.toString=function(){return this.name_},e}(),wt=z("Atom",Me);function ln(e,r,t){r===void 0&&(r=se),t===void 0&&(t=se);var n=new Me(e);return r!==se&&Si(n,r),t!==se&&jn(n,t),n}function Ar(e,r){return Jn(e,r)}function wr(e,r){return Object.is?Object.is(e,r):e===r?e!==0||1/e===1/r:e!==e&&r!==r}var Ve={structural:Ar,default:wr};function de(e,r,t){return qn(e)?e:Array.isArray(e)?L.array(e,{name:t}):U(e)?L.object(e,void 0,{name:t}):he(e)?L.map(e,{name:t}):Pe(e)?L.set(e,{name:t}):typeof e=="function"&&!Et(e)&&!Ke(e)?rn(e)?Ee(e):ke(t,e):e}function Sr(e,r,t){if(e==null||it(e)||nt(e)||ne(e)||ve(e))return e;if(Array.isArray(e))return L.array(e,{name:t,deep:!1});if(U(e))return L.object(e,void 0,{name:t,deep:!1});if(he(e))return L.map(e,{name:t,deep:!1});if(Pe(e))return L.set(e,{name:t,deep:!1})}function Ze(e){return e}function Or(e,r){return Jn(e,r)?r:e}var Tr="override";function kr(e){return e.annotationType_===Tr}function Be(e,r){return{annotationType_:e,options_:r,make_:Er,extend_:xr}}function Er(e,r,t,n){var o;if((o=this.options_)!=null&&o.bound)return this.extend_(e,r,t,!1)===null?0:1;if(n===e.target_)return this.extend_(e,r,t,!1)===null?0:2;if(Et(t.value))return 1;var s=cn(e,this,r,t,!1);return q(n,r,s),2}function xr(e,r,t,n){var o=cn(e,this,r,t);return e.defineProperty_(r,o,n)}function Pr(e,r,t,n){r.annotationType_,n.value}function cn(e,r,t,n,o){var s,u,c,d,_,m,i;o===void 0&&(o=g.safeDescriptors),Pr(e,r,t,n);var a=n.value;if((s=r.options_)!=null&&s.bound){var l;a=a.bind((l=e.proxy_)!=null?l:e.target_)}return{value:_e((u=(c=r.options_)==null?void 0:c.name)!=null?u:t.toString(),a,(d=(_=r.options_)==null?void 0:_.autoAction)!=null?d:!1,(m=r.options_)!=null&&m.bound?(i=e.proxy_)!=null?i:e.target_:void 0),configurable:o?e.isPlainObject_:!0,enumerable:!1,writable:!o}}function fn(e,r){return{annotationType_:e,options_:r,make_:Lr,extend_:Mr}}function Lr(e,r,t,n){var o;if(n===e.target_)return this.extend_(e,r,t,!1)===null?0:2;if((o=this.options_)!=null&&o.bound&&(!Q(e.target_,r)||!Ke(e.target_[r]))&&this.extend_(e,r,t,!1)===null)return 0;if(Ke(t.value))return 1;var s=dn(e,this,r,t,!1,!1);return q(n,r,s),2}function Mr(e,r,t,n){var o,s=dn(e,this,r,t,(o=this.options_)==null?void 0:o.bound);return e.defineProperty_(r,s,n)}function Br(e,r,t,n){r.annotationType_,n.value}function dn(e,r,t,n,o,s){s===void 0&&(s=g.safeDescriptors),Br(e,r,t,n);var u=n.value;if(Ke(u)||(u=Ee(u)),o){var c;u=u.bind((c=e.proxy_)!=null?c:e.target_),u.isMobXFlow=!0}return{value:u,configurable:s?e.isPlainObject_:!0,enumerable:!1,writable:!s}}function St(e,r){return{annotationType_:e,options_:r,make_:Ir,extend_:Cr}}function Ir(e,r,t){return this.extend_(e,r,t,!1)===null?0:1}function Cr(e,r,t,n){return jr(e,this,r,t),e.defineComputedProperty_(r,Oe({},this.options_,{get:t.get,set:t.set}),n)}function jr(e,r,t,n){r.annotationType_,n.get}function ze(e,r){return{annotationType_:e,options_:r,make_:Nr,extend_:Dr}}function Nr(e,r,t){return this.extend_(e,r,t,!1)===null?0:1}function Dr(e,r,t,n){var o,s;return Rr(e,this),e.defineObservableProperty_(r,t.value,(o=(s=this.options_)==null?void 0:s.enhancer)!=null?o:de,n)}function Rr(e,r,t,n){r.annotationType_}var qr="true",Fr=_n();function _n(e){return{annotationType_:qr,options_:e,make_:Vr,extend_:$r}}function Vr(e,r,t,n){var o,s;if(t.get)return et.make_(e,r,t,n);if(t.set){var u=_e(r.toString(),t.set);return n===e.target_?e.defineProperty_(r,{configurable:g.safeDescriptors?e.isPlainObject_:!0,set:u})===null?0:2:(q(n,r,{configurable:!0,set:u}),2)}if(n!==e.target_&&typeof t.value=="function"){var c;if(rn(t.value)){var d,_=(d=this.options_)!=null&&d.autoBind?Ee.bound:Ee;return _.make_(e,r,t,n)}var m=(c=this.options_)!=null&&c.autoBind?ke.bound:ke;return m.make_(e,r,t,n)}var i=((o=this.options_)==null?void 0:o.deep)===!1?L.ref:L;if(typeof t.value=="function"&&(s=this.options_)!=null&&s.autoBind){var a;t.value=t.value.bind((a=e.proxy_)!=null?a:e.target_)}return i.make_(e,r,t,n)}function $r(e,r,t,n){var o,s;if(t.get)return et.extend_(e,r,t,n);if(t.set)return e.defineProperty_(r,{configurable:g.safeDescriptors?e.isPlainObject_:!0,set:_e(r.toString(),t.set)},n);if(typeof t.value=="function"&&(o=this.options_)!=null&&o.autoBind){var u;t.value=t.value.bind((u=e.proxy_)!=null?u:e.target_)}var c=((s=this.options_)==null?void 0:s.deep)===!1?L.ref:L;return c.extend_(e,r,t,n)}var Gr="observable",Hr="observable.ref",Ur="observable.shallow",Kr="observable.struct",pn={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(pn);function je(e){return e||pn}var hn=ze(Gr),Xr=ze(Hr,{enhancer:Ze}),Yr=ze(Ur,{enhancer:Sr}),Qr=ze(Kr,{enhancer:Or}),vn=F(hn);function Ne(e){return e.deep===!0?de:e.deep===!1?Ze:Jr(e.defaultDecorator)}function Wr(e){var r;return e?(r=e.defaultDecorator)!=null?r:_n(e):void 0}function Jr(e){var r,t;return e&&(r=(t=e.options_)==null?void 0:t.enhancer)!=null?r:de}function mn(e,r,t){if(Z(r)){Le(e,r,hn);return}return qn(e)?e:U(e)?L.object(e,r,t):Array.isArray(e)?L.array(e,r):he(e)?L.map(e,r):Pe(e)?L.set(e,r):typeof e=="object"&&e!==null?e:L.box(e,r)}zt(mn,vn);var Zr={box:function(r,t){var n=je(t);return new fe(r,Ne(n),n.name,!0,n.equals)},array:function(r,t){var n=je(t);return(g.useProxies===!1||n.proxy===!1?$i:Bi)(r,Ne(n),n.name)},map:function(r,t){var n=je(t);return new Gn(r,Ne(n),n.name)},set:function(r,t){var n=je(t);return new Kn(r,Ne(n),n.name)},object:function(r,t,n){return re(function(){return Dn(g.useProxies===!1||(n==null?void 0:n.proxy)===!1?rt({},n):xi({},n),r,t)})},ref:F(Xr),shallow:F(Yr),deep:vn,struct:F(Qr)},L=zt(mn,Zr),gn="computed",zr="computed.struct",bn=St(gn),ei=St(zr,{equals:Ve.structural}),et=function(r,t){if(Z(t))return Le(r,t,bn);if(U(r))return F(St(gn,r));var n=U(t)?t:{};return n.get=r,n.name||(n.name=r.name||""),new Te(n)};Object.assign(et,bn);et.struct=F(ei);var Nt,Dt,$e=0,ti=1,ni=(Nt=(Dt=Fe(function(){},"name"))==null?void 0:Dt.configurable)!=null?Nt:!1,Rt={value:"action",configurable:!0,writable:!1,enumerable:!1};function _e(e,r,t,n){t===void 0&&(t=!1);function o(){return ri(e,t,r,n||this,arguments)}return o.isMobxAction=!0,ni&&(Rt.value=e,q(o,"name",Rt)),o}function ri(e,r,t,n,o){var s=ii(e,r);try{return t.apply(n,o)}catch(u){throw s.error_=u,u}finally{oi(s)}}function ii(e,r,t,n){var o=!1,s=0,u=g.trackingDerivation,c=!r||!u;C();var d=g.allowStateChanges;c&&(ee(),d=Ot(!0));var _=kt(!0),m={runAsAction_:c,prevDerivation_:u,prevAllowStateChanges_:d,prevAllowStateReads_:_,notifySpy_:o,startTime_:s,actionId_:ti++,parentActionId_:$e};return $e=m.actionId_,m}function oi(e){$e!==e.actionId_&&T(30),$e=e.parentActionId_,e.error_!==void 0&&(g.suppressReactionErrors=!0),Tt(e.prevAllowStateChanges_),ye(e.prevAllowStateReads_),j(),e.runAsAction_&&H(e.prevDerivation_),g.suppressReactionErrors=!1}function Ot(e){var r=g.allowStateChanges;return g.allowStateChanges=e,r}function Tt(e){g.allowStateChanges=e}var yn;yn=Symbol.toPrimitive;var fe=function(e){un(r,e);function r(n,o,s,u,c){var d;return s===void 0&&(s="ObservableValue"),c===void 0&&(c=Ve.default),d=e.call(this,s)||this,d.enhancer=void 0,d.name_=void 0,d.equals=void 0,d.hasUnreportedChange_=!1,d.interceptors_=void 0,d.changeListeners_=void 0,d.value_=void 0,d.dehancer=void 0,d.enhancer=o,d.name_=s,d.equals=c,d.value_=o(n,void 0,s),d}var t=r.prototype;return t.dehanceValue=function(o){return this.dehancer!==void 0?this.dehancer(o):o},t.set=function(o){this.value_,o=this.prepareNewValue_(o),o!==g.UNCHANGED&&this.setNewValue_(o)},t.prepareNewValue_=function(o){if(B(this)){var s=I(this,{object:this,type:V,newValue:o});if(!s)return g.UNCHANGED;o=s.newValue}return o=this.enhancer(o,this.value_,this.name_),this.equals(this.value_,o)?g.UNCHANGED:o},t.setNewValue_=function(o){var s=this.value_;this.value_=o,this.reportChanged(),N(this)&&D(this,{type:V,object:this,newValue:o,oldValue:s})},t.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},t.intercept_=function(o){return Ie(this,o)},t.observe_=function(o,s){return s&&o({observableKind:"value",debugObjectName:this.name_,object:this,type:V,newValue:this.value_,oldValue:void 0}),Ce(this,o)},t.raw=function(){return this.value_},t.toJSON=function(){return this.get()},t.toString=function(){return this.name_+"["+this.value_+"]"},t.valueOf=function(){return sn(this.get())},t[yn]=function(){return this.valueOf()},r}(Me),An;An=Symbol.toPrimitive;var Te=function(){function e(t){this.dependenciesState_=O.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=O.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new He(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=Ge.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,t.get||T(31),this.derivation=t.get,this.name_=t.name||"ComputedValue",t.set&&(this.setter_=_e("ComputedValue-setter",t.set)),this.equals_=t.equals||(t.compareStructural||t.struct?Ve.structural:Ve.default),this.scope_=t.context,this.requiresReaction_=t.requiresReaction,this.keepAlive_=!!t.keepAlive}var r=e.prototype;return r.onBecomeStale_=function(){li(this)},r.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},r.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},r.get=function(){if(this.isComputing_&&T(32,this.name_,this.derivation),g.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)ht(this)&&(this.warnAboutUntrackedRead_(),C(),this.value_=this.computeValue_(!1),j());else if(En(this),ht(this)){var n=g.trackingContext;this.keepAlive_&&!n&&(g.trackingContext=this),this.trackAndCompute()&&ui(this),g.trackingContext=n}var o=this.value_;if(qe(o))throw o.cause;return o},r.set=function(n){if(this.setter_){this.isRunningSetter_&&T(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter_=!1}}else T(34,this.name_)},r.trackAndCompute=function(){var n=this.value_,o=this.dependenciesState_===O.NOT_TRACKING_,s=this.computeValue_(!0),u=o||qe(n)||qe(s)||!this.equals_(n,s);return u&&(this.value_=s),u},r.computeValue_=function(n){this.isComputing_=!0;var o=Ot(!1),s;if(n)s=wn(this,this.derivation,this.scope_);else if(g.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(u){s=new He(u)}return Tt(o),this.isComputing_=!1,s},r.suspend_=function(){this.keepAlive_||(vt(this),this.value_=void 0)},r.observe_=function(n,o){var s=this,u=!0,c=void 0;return te(function(){var d=s.get();if(!u||o){var _=ee();n({observableKind:"computed",debugObjectName:s.name_,type:V,object:s,newValue:d,oldValue:c}),H(_)}u=!1,c=d})},r.warnAboutUntrackedRead_=function(){},r.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},r.valueOf=function(){return sn(this.get())},r[An]=function(){return this.valueOf()},e}(),tt=z("ComputedValue",Te),O;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(O||(O={}));var Ge;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(Ge||(Ge={}));var He=function(r){this.cause=void 0,this.cause=r};function qe(e){return e instanceof He}function ht(e){switch(e.dependenciesState_){case O.UP_TO_DATE_:return!1;case O.NOT_TRACKING_:case O.STALE_:return!0;case O.POSSIBLY_STALE_:{for(var r=kt(!0),t=ee(),n=e.observing_,o=n.length,s=0;s<o;s++){var u=n[s];if(tt(u)){if(g.disableErrorBoundaries)u.get();else try{u.get()}catch{return H(t),ye(r),!0}if(e.dependenciesState_===O.STALE_)return H(t),ye(r),!0}}return On(e),H(t),ye(r),!1}}}function wn(e,r,t){var n=kt(!0);On(e),e.newObserving_=new Array(e.observing_.length+100),e.unboundDepsCount_=0,e.runId_=++g.runId;var o=g.trackingDerivation;g.trackingDerivation=e,g.inBatch++;var s;if(g.disableErrorBoundaries===!0)s=r.call(t);else try{s=r.call(t)}catch(u){s=new He(u)}return g.inBatch--,g.trackingDerivation=o,ai(e),ye(n),s}function ai(e){for(var r=e.observing_,t=e.observing_=e.newObserving_,n=O.UP_TO_DATE_,o=0,s=e.unboundDepsCount_,u=0;u<s;u++){var c=t[u];c.diffValue_===0&&(c.diffValue_=1,o!==u&&(t[o]=c),o++),c.dependenciesState_>n&&(n=c.dependenciesState_)}for(t.length=o,e.newObserving_=null,s=r.length;s--;){var d=r[s];d.diffValue_===0&&Tn(d,e),d.diffValue_=0}for(;o--;){var _=t[o];_.diffValue_===1&&(_.diffValue_=0,si(_,e))}n!==O.UP_TO_DATE_&&(e.dependenciesState_=n,e.onBecomeStale_())}function vt(e){var r=e.observing_;e.observing_=[];for(var t=r.length;t--;)Tn(r[t],e);e.dependenciesState_=O.NOT_TRACKING_}function Sn(e){var r=ee();try{return e()}finally{H(r)}}function ee(){var e=g.trackingDerivation;return g.trackingDerivation=null,e}function H(e){g.trackingDerivation=e}function kt(e){var r=g.allowStateReads;return g.allowStateReads=e,r}function ye(e){g.allowStateReads=e}function On(e){if(e.dependenciesState_!==O.UP_TO_DATE_){e.dependenciesState_=O.UP_TO_DATE_;for(var r=e.observing_,t=r.length;t--;)r[t].lowestObserverState_=O.UP_TO_DATE_}}var ut=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.batchId=Number.MIN_SAFE_INTEGER,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0,this.stateVersion=Number.MIN_SAFE_INTEGER},lt=!0,g=function(){var e=Zt();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(lt=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new ut().version&&(lt=!1),lt?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new ut):(setTimeout(function(){T(35)},1),new ut)}();function si(e,r){e.observers_.add(r),e.lowestObserverState_>r.dependenciesState_&&(e.lowestObserverState_=r.dependenciesState_)}function Tn(e,r){e.observers_.delete(r),e.observers_.size===0&&kn(e)}function kn(e){e.isPendingUnobservation_===!1&&(e.isPendingUnobservation_=!0,g.pendingUnobservations.push(e))}function C(){g.inBatch===0&&(g.batchId=g.batchId<Number.MAX_SAFE_INTEGER?g.batchId+1:Number.MIN_SAFE_INTEGER),g.inBatch++}function j(){if(--g.inBatch===0){Pn();for(var e=g.pendingUnobservations,r=0;r<e.length;r++){var t=e[r];t.isPendingUnobservation_=!1,t.observers_.size===0&&(t.isBeingObserved_&&(t.isBeingObserved_=!1,t.onBUO()),t instanceof Te&&t.suspend_())}g.pendingUnobservations=[]}}function En(e){var r=g.trackingDerivation;return r!==null?(r.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=r.runId_,r.newObserving_[r.unboundDepsCount_++]=e,!e.isBeingObserved_&&g.trackingContext&&(e.isBeingObserved_=!0,e.onBO())),e.isBeingObserved_):(e.observers_.size===0&&g.inBatch>0&&kn(e),!1)}function xn(e){e.lowestObserverState_!==O.STALE_&&(e.lowestObserverState_=O.STALE_,e.observers_.forEach(function(r){r.dependenciesState_===O.UP_TO_DATE_&&r.onBecomeStale_(),r.dependenciesState_=O.STALE_}))}function ui(e){e.lowestObserverState_!==O.STALE_&&(e.lowestObserverState_=O.STALE_,e.observers_.forEach(function(r){r.dependenciesState_===O.POSSIBLY_STALE_?r.dependenciesState_=O.STALE_:r.dependenciesState_===O.UP_TO_DATE_&&(e.lowestObserverState_=O.UP_TO_DATE_)}))}function li(e){e.lowestObserverState_===O.UP_TO_DATE_&&(e.lowestObserverState_=O.POSSIBLY_STALE_,e.observers_.forEach(function(r){r.dependenciesState_===O.UP_TO_DATE_&&(r.dependenciesState_=O.POSSIBLY_STALE_,r.onBecomeStale_())}))}var mt=function(){function e(t,n,o,s){t===void 0&&(t="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=O.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=Ge.NONE,this.name_=t,this.onInvalidate_=n,this.errorHandler_=o,this.requiresObservable_=s}var r=e.prototype;return r.onBecomeStale_=function(){this.schedule_()},r.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,g.pendingReactions.push(this),Pn())},r.isScheduled=function(){return this.isScheduled_},r.runReaction_=function(){if(!this.isDisposed_){C(),this.isScheduled_=!1;var n=g.trackingContext;if(g.trackingContext=this,ht(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(o){this.reportExceptionInDerivation_(o)}}g.trackingContext=n,j()}},r.track=function(n){if(!this.isDisposed_){C(),this.isRunning_=!0;var o=g.trackingContext;g.trackingContext=this;var s=wn(this,n,void 0);g.trackingContext=o,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&vt(this),qe(s)&&this.reportExceptionInDerivation_(s.cause),j()}},r.reportExceptionInDerivation_=function(n){var o=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(g.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";g.suppressReactionErrors||console.error(s,n),g.globalReactionErrorHandlers.forEach(function(u){return u(n,o)})},r.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(C(),vt(this),j()))},r.getDisposer_=function(n){var o=this,s=function u(){o.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",u)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[A]=this,s},r.toString=function(){return"Reaction["+this.name_+"]"},r.trace=function(n){},e}(),ci=100,fi=function(r){return r()};function Pn(){g.inBatch>0||g.isRunningReactions||fi(di)}function di(){g.isRunningReactions=!0;for(var e=g.pendingReactions,r=0;e.length>0;){++r===ci&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var t=e.splice(0),n=0,o=t.length;n<o;n++)t[n].runReaction_()}g.isRunningReactions=!1}var Ue=z("Reaction",mt);function Ae(){return!1}function _i(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var Ln="action",pi="action.bound",Mn="autoAction",hi="autoAction.bound",vi="<unnamed action>",Bn=Be(Ln),mi=Be(pi,{bound:!0}),In=Be(Mn,{autoAction:!0}),gi=Be(hi,{autoAction:!0,bound:!0});function Cn(e){var r=function(n,o){if(R(n))return _e(n.name||vi,n,e);if(R(o))return _e(n,o,e);if(Z(o))return Le(n,o,e?In:Bn);if(Z(n))return F(Be(e?Mn:Ln,{name:n,autoAction:e}))};return r}var ce=Cn(!1);Object.assign(ce,Bn);var ke=Cn(!0);Object.assign(ke,In);ce.bound=F(mi);ke.bound=F(gi);function Et(e){return R(e)&&e.isMobxAction===!0}function te(e,r){var t,n,o,s,u;r===void 0&&(r=en);var c=(t=(n=r)==null?void 0:n.name)!=null?t:"Autorun",d=!r.scheduler&&!r.delay,_;if(d)_=new mt(c,function(){this.track(a)},r.onError,r.requiresObservable);else{var m=yi(r),i=!1;_=new mt(c,function(){i||(i=!0,m(function(){i=!1,_.isDisposed_||_.track(a)}))},r.onError,r.requiresObservable)}function a(){e(_)}return(o=r)!=null&&(s=o.signal)!=null&&s.aborted||_.schedule_(),_.getDisposer_((u=r)==null?void 0:u.signal)}var bi=function(r){return r()};function yi(e){return e.scheduler?e.scheduler:e.delay?function(r){return setTimeout(r,e.delay)}:bi}var Ai="onBO",wi="onBUO";function Si(e,r,t){return Nn(Ai,e,r,t)}function jn(e,r,t){return Nn(wi,e,r,t)}function Nn(e,r,t,n){var o=gt(r),s=R(n)?n:t,u=e+"L";return o[u]?o[u].add(s):o[u]=new Set([s]),function(){var c=o[u];c&&(c.delete(s),c.size===0&&delete o[u])}}function Dn(e,r,t,n){var o=vr(r);return re(function(){var s=rt(e,n)[A];Se(o).forEach(function(u){s.extend_(u,o[u],t&&u in t?t[u]:!0)})}),e}var Oi=0;function Rn(){this.message="FLOW_CANCELLED"}Rn.prototype=Object.create(Error.prototype);var qt=fn("flow"),Ti=fn("flow.bound",{bound:!0}),Ee=Object.assign(function(r,t){if(Z(t))return Le(r,t,qt);var n=r,o=n.name||"<unnamed flow>",s=function(){var c=this,d=arguments,_=++Oi,m=ce(o+" - runid: "+_+" - init",n).apply(c,d),i,a=void 0,l=new Promise(function(f,h){var v=0;i=h;function p(S){a=void 0;var P;try{P=ce(o+" - runid: "+_+" - yield "+v++,m.next).call(m,S)}catch(M){return h(M)}w(P)}function b(S){a=void 0;var P;try{P=ce(o+" - runid: "+_+" - yield "+v++,m.throw).call(m,S)}catch(M){return h(M)}w(P)}function w(S){if(R(S==null?void 0:S.then)){S.then(w,h);return}return S.done?f(S.value):(a=Promise.resolve(S.value),a.then(p,b))}p(void 0)});return l.cancel=ce(o+" - runid: "+_+" - cancel",function(){try{a&&Ft(a);var f=m.return(void 0),h=Promise.resolve(f.value);h.then(se,se),Ft(h),i(new Rn)}catch(v){i(v)}}),l};return s.isMobXFlow=!0,s},qt);Ee.bound=F(Ti);function Ft(e){R(e.cancel)&&e.cancel()}function Ke(e){return(e==null?void 0:e.isMobXFlow)===!0}function ki(e,r){return e?it(e)||!!e[A]||wt(e)||Ue(e)||tt(e):!1}function qn(e){return ki(e)}function G(e,r){r===void 0&&(r=void 0),C();try{return e.apply(r)}finally{j()}}function ae(e){return e[A]}var Ei={has:function(r,t){return ae(r).has_(t)},get:function(r,t){return ae(r).get_(t)},set:function(r,t,n){var o;return Z(t)?(o=ae(r).set_(t,n,!0))!=null?o:!0:!1},deleteProperty:function(r,t){var n;return Z(t)?(n=ae(r).delete_(t,!0))!=null?n:!0:!1},defineProperty:function(r,t,n){var o;return(o=ae(r).defineProperty_(t,n))!=null?o:!0},ownKeys:function(r){return ae(r).ownKeys_()},preventExtensions:function(r){T(13)}};function xi(e,r){var t,n;return tn(),e=rt(e,r),(n=(t=e[A]).proxy_)!=null?n:t.proxy_=new Proxy(e,Ei)}function B(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function Ie(e,r){var t=e.interceptors_||(e.interceptors_=[]);return t.push(r),nn(function(){var n=t.indexOf(r);n!==-1&&t.splice(n,1)})}function I(e,r){var t=ee();try{for(var n=[].concat(e.interceptors_||[]),o=0,s=n.length;o<s&&(r=n[o](r),r&&!r.type&&T(14),!!r);o++);return r}finally{H(t)}}function N(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function Ce(e,r){var t=e.changeListeners_||(e.changeListeners_=[]);return t.push(r),nn(function(){var n=t.indexOf(r);n!==-1&&t.splice(n,1)})}function D(e,r){var t=ee(),n=e.changeListeners_;if(n){n=n.slice();for(var o=0,s=n.length;o<s;o++)n[o](r);H(t)}}var ct=Symbol("mobx-keys");function Pi(e,r,t){return U(e)?Dn(e,e,r,t):(re(function(){var n=rt(e,t)[A];if(!e[ct]){var o=Object.getPrototypeOf(e),s=new Set([].concat(Se(e),Se(o)));s.delete("constructor"),s.delete(A),Je(o,ct,s)}e[ct].forEach(function(u){return n.make_(u,r&&u in r?r[u]:!0)})}),e)}var Vt="splice",V="update",Li=1e4,Mi={get:function(r,t){var n=r[A];return t===A?n:t==="length"?n.getArrayLength_():typeof t=="string"&&!isNaN(t)?n.get_(parseInt(t)):Q(Xe,t)?Xe[t]:r[t]},set:function(r,t,n){var o=r[A];return t==="length"&&o.setArrayLength_(n),typeof t=="symbol"||isNaN(t)?r[t]=n:o.set_(parseInt(t),n),!0},preventExtensions:function(){T(15)}},xt=function(){function e(t,n,o,s){t===void 0&&(t="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=o,this.legacyMode_=s,this.atom_=new Me(t),this.enhancer_=function(u,c){return n(u,c,"ObservableArray[..]")}}var r=e.prototype;return r.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},r.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},r.intercept_=function(n){return Ie(this,n)},r.observe_=function(n,o){return o===void 0&&(o=!1),o&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Ce(this,n)},r.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},r.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&T("Out of range: "+n);var o=this.values_.length;if(n!==o)if(n>o){for(var s=new Array(n-o),u=0;u<n-o;u++)s[u]=void 0;this.spliceWithArray_(o,0,s)}else this.spliceWithArray_(n,o-n)},r.updateArrayLength_=function(n,o){n!==this.lastKnownLength_&&T(16),this.lastKnownLength_+=o,this.legacyMode_&&o>0&&Wn(n+o+1)},r.spliceWithArray_=function(n,o,s){var u=this;this.atom_;var c=this.values_.length;if(n===void 0?n=0:n>c?n=c:n<0&&(n=Math.max(0,c+n)),arguments.length===1?o=c-n:o==null?o=0:o=Math.max(0,Math.min(o,c-n)),s===void 0&&(s=_t),B(this)){var d=I(this,{object:this.proxy_,type:Vt,index:n,removedCount:o,added:s});if(!d)return _t;o=d.removedCount,s=d.added}if(s=s.length===0?s:s.map(function(i){return u.enhancer_(i,void 0)}),this.legacyMode_){var _=s.length-o;this.updateArrayLength_(c,_)}var m=this.spliceItemsIntoValues_(n,o,s);return(o!==0||s.length!==0)&&this.notifyArraySplice_(n,s,m),this.dehanceValues_(m)},r.spliceItemsIntoValues_=function(n,o,s){if(s.length<Li){var u;return(u=this.values_).splice.apply(u,[n,o].concat(s))}else{var c=this.values_.slice(n,n+o),d=this.values_.slice(n+o);this.values_.length+=s.length-o;for(var _=0;_<s.length;_++)this.values_[n+_]=s[_];for(var m=0;m<d.length;m++)this.values_[n+s.length+m]=d[m];return c}},r.notifyArrayChildUpdate_=function(n,o,s){var u=!this.owned_&&Ae(),c=N(this),d=c||u?{observableKind:"array",object:this.proxy_,type:V,debugObjectName:this.atom_.name_,index:n,newValue:o,oldValue:s}:null;this.atom_.reportChanged(),c&&D(this,d)},r.notifyArraySplice_=function(n,o,s){var u=!this.owned_&&Ae(),c=N(this),d=c||u?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Vt,index:n,removed:s,added:o,removedCount:s.length,addedCount:o.length}:null;this.atom_.reportChanged(),c&&D(this,d)},r.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},r.set_=function(n,o){var s=this.values_;if(this.legacyMode_&&n>s.length&&T(17,n,s.length),n<s.length){this.atom_;var u=s[n];if(B(this)){var c=I(this,{type:V,object:this.proxy_,index:n,newValue:o});if(!c)return;o=c.newValue}o=this.enhancer_(o,u);var d=o!==u;d&&(s[n]=o,this.notifyArrayChildUpdate_(n,o,u))}else{for(var _=new Array(n+1-s.length),m=0;m<_.length-1;m++)_[m]=void 0;_[_.length-1]=o,this.spliceWithArray_(s.length,0,_)}},e}();function Bi(e,r,t,n){return t===void 0&&(t="ObservableArray"),n===void 0&&(n=!1),tn(),re(function(){var o=new xt(t,r,n,!1);on(o.values_,A,o);var s=new Proxy(o.values_,Mi);return o.proxy_=s,e&&e.length&&o.spliceWithArray_(0,0,e),s})}var Xe={clear:function(){return this.splice(0)},replace:function(r){var t=this[A];return t.spliceWithArray_(0,t.values_.length,r)},toJSON:function(){return this.slice()},splice:function(r,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];var u=this[A];switch(arguments.length){case 0:return[];case 1:return u.spliceWithArray_(r);case 2:return u.spliceWithArray_(r,t)}return u.spliceWithArray_(r,t,o)},spliceWithArray:function(r,t,n){return this[A].spliceWithArray_(r,t,n)},push:function(){for(var r=this[A],t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r.spliceWithArray_(r.values_.length,0,n),r.values_.length},pop:function(){return this.splice(Math.max(this[A].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var r=this[A],t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r.spliceWithArray_(0,0,n),r.values_.length},reverse:function(){return g.trackingDerivation&&T(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){g.trackingDerivation&&T(37,"sort");var r=this.slice();return r.sort.apply(r,arguments),this.replace(r),this},remove:function(r){var t=this[A],n=t.dehanceValues_(t.values_).indexOf(r);return n>-1?(this.splice(n,1),!0):!1}};x("concat",X);x("flat",X);x("includes",X);x("indexOf",X);x("join",X);x("lastIndexOf",X);x("slice",X);x("toString",X);x("toLocaleString",X);x("every",W);x("filter",W);x("find",W);x("findIndex",W);x("flatMap",W);x("forEach",W);x("map",W);x("some",W);x("reduce",Fn);x("reduceRight",Fn);function x(e,r){typeof Array.prototype[e]=="function"&&(Xe[e]=r(e))}function X(e){return function(){var r=this[A];r.atom_.reportObserved();var t=r.dehanceValues_(r.values_);return t[e].apply(t,arguments)}}function W(e){return function(r,t){var n=this,o=this[A];o.atom_.reportObserved();var s=o.dehanceValues_(o.values_);return s[e](function(u,c){return r.call(t,u,c,n)})}}function Fn(e){return function(){var r=this,t=this[A];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_),o=arguments[0];return arguments[0]=function(s,u,c){return o(s,u,c,r)},n[e].apply(n,arguments)}}var Ii=z("ObservableArrayAdministration",xt);function nt(e){return We(e)&&Ii(e[A])}var Vn,$n,Ci={},Y="add",Ye="delete";Vn=Symbol.iterator;$n=Symbol.toStringTag;var Gn=function(){function e(t,n,o){var s=this;n===void 0&&(n=de),o===void 0&&(o="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[A]=Ci,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=o,R(Map)||T(18),re(function(){s.keysAtom_=ln("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,t&&s.merge(t)})}var r=e.prototype;return r.has_=function(n){return this.data_.has(n)},r.has=function(n){var o=this;if(!g.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var u=s=new fe(this.has_(n),Ze,"ObservableMap.key?",!1);this.hasMap_.set(n,u),jn(u,function(){return o.hasMap_.delete(n)})}return s.get()},r.set=function(n,o){var s=this.has_(n);if(B(this)){var u=I(this,{type:s?V:Y,object:this,newValue:o,name:n});if(!u)return this;o=u.newValue}return s?this.updateValue_(n,o):this.addValue_(n,o),this},r.delete=function(n){var o=this;if(this.keysAtom_,B(this)){var s=I(this,{type:Ye,object:this,name:n});if(!s)return!1}if(this.has_(n)){var u=Ae(),c=N(this),d=c||u?{observableKind:"map",debugObjectName:this.name_,type:Ye,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return G(function(){var _;o.keysAtom_.reportChanged(),(_=o.hasMap_.get(n))==null||_.setNewValue_(!1);var m=o.data_.get(n);m.setNewValue_(void 0),o.data_.delete(n)}),c&&D(this,d),!0}return!1},r.updateValue_=function(n,o){var s=this.data_.get(n);if(o=s.prepareNewValue_(o),o!==g.UNCHANGED){var u=Ae(),c=N(this),d=c||u?{observableKind:"map",debugObjectName:this.name_,type:V,object:this,oldValue:s.value_,name:n,newValue:o}:null;s.setNewValue_(o),c&&D(this,d)}},r.addValue_=function(n,o){var s=this;this.keysAtom_,G(function(){var _,m=new fe(o,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,m),o=m.value_,(_=s.hasMap_.get(n))==null||_.setNewValue_(!0),s.keysAtom_.reportChanged()});var u=Ae(),c=N(this),d=c||u?{observableKind:"map",debugObjectName:this.name_,type:Y,object:this,name:n,newValue:o}:null;c&&D(this,d)},r.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},r.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},r.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},r.values=function(){var n=this,o=this.keys();return xe({next:function(){var u=o.next(),c=u.done,d=u.value;return{done:c,value:c?void 0:n.get(d)}}})},r.entries=function(){var n=this,o=this.keys();return xe({next:function(){var u=o.next(),c=u.done,d=u.value;return{done:c,value:c?void 0:[d,n.get(d)]}}})},r[Vn]=function(){return this.entries()},r.forEach=function(n,o){for(var s=ue(this),u;!(u=s()).done;){var c=u.value,d=c[0],_=c[1];n.call(o,_,d,this)}},r.merge=function(n){var o=this;return ne(n)&&(n=new Map(n)),G(function(){U(n)?hr(n).forEach(function(s){return o.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var u=s[0],c=s[1];return o.set(u,c)}):he(n)?(n.constructor!==Map&&T(19,n),n.forEach(function(s,u){return o.set(u,s)})):n!=null&&T(20,n)}),this},r.clear=function(){var n=this;G(function(){Sn(function(){for(var o=ue(n.keys()),s;!(s=o()).done;){var u=s.value;n.delete(u)}})})},r.replace=function(n){var o=this;return G(function(){for(var s=ji(n),u=new Map,c=!1,d=ue(o.data_.keys()),_;!(_=d()).done;){var m=_.value;if(!s.has(m)){var i=o.delete(m);if(i)c=!0;else{var a=o.data_.get(m);u.set(m,a)}}}for(var l=ue(s.entries()),f;!(f=l()).done;){var h=f.value,v=h[0],p=h[1],b=o.data_.has(v);if(o.set(v,p),o.data_.has(v)){var w=o.data_.get(v);u.set(v,w),b||(c=!0)}}if(!c)if(o.data_.size!==u.size)o.keysAtom_.reportChanged();else for(var S=o.data_.keys(),P=u.keys(),M=S.next(),J=P.next();!M.done;){if(M.value!==J.value){o.keysAtom_.reportChanged();break}M=S.next(),J=P.next()}o.data_=u}),this},r.toString=function(){return"[object ObservableMap]"},r.toJSON=function(){return Array.from(this)},r.observe_=function(n,o){return Ce(this,n)},r.intercept_=function(n){return Ie(this,n)},At(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:$n,get:function(){return"Map"}}]),e}(),ne=z("ObservableMap",Gn);function ji(e){if(he(e)||ne(e))return e;if(Array.isArray(e))return new Map(e);if(U(e)){var r=new Map;for(var t in e)r.set(t,e[t]);return r}else return T(21,e)}var Hn,Un,Ni={};Hn=Symbol.iterator;Un=Symbol.toStringTag;var Kn=function(){function e(t,n,o){var s=this;n===void 0&&(n=de),o===void 0&&(o="ObservableSet"),this.name_=void 0,this[A]=Ni,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=o,R(Set)||T(22),this.enhancer_=function(u,c){return n(u,c,o)},re(function(){s.atom_=ln(s.name_),t&&s.replace(t)})}var r=e.prototype;return r.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},r.clear=function(){var n=this;G(function(){Sn(function(){for(var o=ue(n.data_.values()),s;!(s=o()).done;){var u=s.value;n.delete(u)}})})},r.forEach=function(n,o){for(var s=ue(this),u;!(u=s()).done;){var c=u.value;n.call(o,c,c,this)}},r.add=function(n){var o=this;if(this.atom_,B(this)){var s=I(this,{type:Y,object:this,newValue:n});if(!s)return this}if(!this.has(n)){G(function(){o.data_.add(o.enhancer_(n,void 0)),o.atom_.reportChanged()});var u=!1,c=N(this),d=c||u?{observableKind:"set",debugObjectName:this.name_,type:Y,object:this,newValue:n}:null;c&&D(this,d)}return this},r.delete=function(n){var o=this;if(B(this)){var s=I(this,{type:Ye,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var u=!1,c=N(this),d=c||u?{observableKind:"set",debugObjectName:this.name_,type:Ye,object:this,oldValue:n}:null;return G(function(){o.atom_.reportChanged(),o.data_.delete(n)}),c&&D(this,d),!0}return!1},r.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},r.entries=function(){var n=0,o=Array.from(this.keys()),s=Array.from(this.values());return xe({next:function(){var c=n;return n+=1,c<s.length?{value:[o[c],s[c]],done:!1}:{done:!0}}})},r.keys=function(){return this.values()},r.values=function(){this.atom_.reportObserved();var n=this,o=0,s=Array.from(this.data_.values());return xe({next:function(){return o<s.length?{value:n.dehanceValue_(s[o++]),done:!1}:{done:!0}}})},r.replace=function(n){var o=this;return ve(n)&&(n=new Set(n)),G(function(){Array.isArray(n)?(o.clear(),n.forEach(function(s){return o.add(s)})):Pe(n)?(o.clear(),n.forEach(function(s){return o.add(s)})):n!=null&&T("Cannot initialize set from "+n)}),this},r.observe_=function(n,o){return Ce(this,n)},r.intercept_=function(n){return Ie(this,n)},r.toJSON=function(){return Array.from(this)},r.toString=function(){return"[object ObservableSet]"},r[Hn]=function(){return this.values()},At(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Un,get:function(){return"Set"}}]),e}(),ve=z("ObservableSet",Kn),$t=Object.create(null),Gt="remove",Xn=function(){function e(t,n,o,s){n===void 0&&(n=new Map),s===void 0&&(s=Fr),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=t,this.values_=n,this.name_=o,this.defaultAnnotation_=s,this.keysAtom_=new Me("ObservableObject.keys"),this.isPlainObject_=U(this.target_)}var r=e.prototype;return r.getObservablePropValue_=function(n){return this.values_.get(n).get()},r.setObservablePropValue_=function(n,o){var s=this.values_.get(n);if(s instanceof Te)return s.set(o),!0;if(B(this)){var u=I(this,{type:V,object:this.proxy_||this.target_,name:n,newValue:o});if(!u)return null;o=u.newValue}if(o=s.prepareNewValue_(o),o!==g.UNCHANGED){var c=N(this),d=!1,_=c||d?{type:V,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:o}:null;s.setNewValue_(o),c&&D(this,_)}return!0},r.get_=function(n){return g.trackingDerivation&&!Q(this.target_,n)&&this.has_(n),this.target_[n]},r.set_=function(n,o,s){return s===void 0&&(s=!1),Q(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,o):s?Reflect.set(this.target_,n,o):(this.target_[n]=o,!0):this.extend_(n,{value:o,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},r.has_=function(n){if(!g.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var o=this.pendingKeys_.get(n);return o||(o=new fe(n in this.target_,Ze,"ObservableObject.key?",!1),this.pendingKeys_.set(n,o)),o.get()},r.make_=function(n,o){if(o===!0&&(o=this.defaultAnnotation_),o!==!1){if(!(n in this.target_)){var s;if((s=this.target_[le])!=null&&s[n])return;T(1,o.annotationType_,this.name_+"."+n.toString())}for(var u=this.target_;u&&u!==Qe;){var c=Fe(u,n);if(c){var d=o.make_(this,n,c,u);if(d===0)return;if(d===1)break}u=Object.getPrototypeOf(u)}Ut(this,o,n)}},r.extend_=function(n,o,s,u){if(u===void 0&&(u=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,o,u);var c=s.extend_(this,n,o,u);return c&&Ut(this,s,n),c},r.defineProperty_=function(n,o,s){s===void 0&&(s=!1),this.keysAtom_;try{C();var u=this.delete_(n);if(!u)return u;if(B(this)){var c=I(this,{object:this.proxy_||this.target_,name:n,type:Y,newValue:o.value});if(!c)return null;var d=c.newValue;o.value!==d&&(o=Oe({},o,{value:d}))}if(s){if(!Reflect.defineProperty(this.target_,n,o))return!1}else q(this.target_,n,o);this.notifyPropertyAddition_(n,o.value)}finally{j()}return!0},r.defineObservableProperty_=function(n,o,s,u){u===void 0&&(u=!1),this.keysAtom_;try{C();var c=this.delete_(n);if(!c)return c;if(B(this)){var d=I(this,{object:this.proxy_||this.target_,name:n,type:Y,newValue:o});if(!d)return null;o=d.newValue}var _=Ht(n),m={configurable:g.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:_.get,set:_.set};if(u){if(!Reflect.defineProperty(this.target_,n,m))return!1}else q(this.target_,n,m);var i=new fe(o,s,"ObservableObject.key",!1);this.values_.set(n,i),this.notifyPropertyAddition_(n,i.value_)}finally{j()}return!0},r.defineComputedProperty_=function(n,o,s){s===void 0&&(s=!1),this.keysAtom_;try{C();var u=this.delete_(n);if(!u)return u;if(B(this)){var c=I(this,{object:this.proxy_||this.target_,name:n,type:Y,newValue:void 0});if(!c)return null}o.name||(o.name="ObservableObject.key"),o.context=this.proxy_||this.target_;var d=Ht(n),_={configurable:g.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:d.get,set:d.set};if(s){if(!Reflect.defineProperty(this.target_,n,_))return!1}else q(this.target_,n,_);this.values_.set(n,new Te(o)),this.notifyPropertyAddition_(n,void 0)}finally{j()}return!0},r.delete_=function(n,o){if(o===void 0&&(o=!1),this.keysAtom_,!Q(this.target_,n))return!0;if(B(this)){var s=I(this,{object:this.proxy_||this.target_,name:n,type:Gt});if(!s)return null}try{var u,c;C();var d=N(this),_=!1,m=this.values_.get(n),i=void 0;if(!m&&(d||_)){var a;i=(a=Fe(this.target_,n))==null?void 0:a.value}if(o){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(m&&(this.values_.delete(n),m instanceof fe&&(i=m.value_),xn(m)),this.keysAtom_.reportChanged(),(u=this.pendingKeys_)==null||(c=u.get(n))==null||c.set(n in this.target_),d||_){var l={type:Gt,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:i,name:n};d&&D(this,l)}}finally{j()}return!0},r.observe_=function(n,o){return Ce(this,n)},r.intercept_=function(n){return Ie(this,n)},r.notifyPropertyAddition_=function(n,o){var s,u,c=N(this),d=!1;if(c||d){var _=c||d?{type:Y,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:o}:null;c&&D(this,_)}(s=this.pendingKeys_)==null||(u=s.get(n))==null||u.set(!0),this.keysAtom_.reportChanged()},r.ownKeys_=function(){return this.keysAtom_.reportObserved(),Se(this.target_)},r.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function rt(e,r){var t;if(Q(e,A))return e;var n=(t=r==null?void 0:r.name)!=null?t:"ObservableObject",o=new Xn(e,new Map,String(n),Wr(r));return Je(e,A,o),e}var Di=z("ObservableObjectAdministration",Xn);function Ht(e){return $t[e]||($t[e]={get:function(){return this[A].getObservablePropValue_(e)},set:function(t){return this[A].setObservablePropValue_(e,t)}})}function it(e){return We(e)?Di(e[A]):!1}function Ut(e,r,t){var n;(n=e.target_[le])==null||delete n[t]}var Ri=Qn(0),qi=function(){var e=!1,r={};return Object.defineProperty(r,"0",{set:function(){e=!0}}),Object.create(r)[0]=1,e===!1}(),ft=0,Yn=function(){};function Fi(e,r){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,r):e.prototype.__proto__!==void 0?e.prototype.__proto__=r:e.prototype=r}Fi(Yn,Array.prototype);var Pt=function(e,r,t){un(n,e);function n(s,u,c,d){var _;return c===void 0&&(c="ObservableArray"),d===void 0&&(d=!1),_=e.call(this)||this,re(function(){var m=new xt(c,u,d,!0);m.proxy_=st(_),on(st(_),A,m),s&&s.length&&_.spliceWithArray(0,0,s),qi&&Object.defineProperty(st(_),"0",Ri)}),_}var o=n.prototype;return o.concat=function(){this[A].atom_.reportObserved();for(var u=arguments.length,c=new Array(u),d=0;d<u;d++)c[d]=arguments[d];return Array.prototype.concat.apply(this.slice(),c.map(function(_){return nt(_)?_.slice():_}))},o[t]=function(){var s=this,u=0;return xe({next:function(){return u<s.length?{value:s[u++],done:!1}:{done:!0,value:void 0}}})},At(n,[{key:"length",get:function(){return this[A].getArrayLength_()},set:function(u){this[A].setArrayLength_(u)}},{key:r,get:function(){return"Array"}}]),n}(Yn,Symbol.toStringTag,Symbol.iterator);Object.entries(Xe).forEach(function(e){var r=e[0],t=e[1];r!=="concat"&&Je(Pt.prototype,r,t)});function Qn(e){return{enumerable:!1,configurable:!0,get:function(){return this[A].get_(e)},set:function(t){this[A].set_(e,t)}}}function Vi(e){q(Pt.prototype,""+e,Qn(e))}function Wn(e){if(e>ft){for(var r=ft;r<e+100;r++)Vi(r);ft=e}}Wn(1e3);function $i(e,r,t){return new Pt(e,r,t)}function gt(e,r){if(typeof e=="object"&&e!==null){if(nt(e))return r!==void 0&&T(23),e[A].atom_;if(ve(e))return e.atom_;if(ne(e)){if(r===void 0)return e.keysAtom_;var t=e.data_.get(r)||e.hasMap_.get(r);return t||T(25,r,bt(e)),t}if(it(e)){if(!r)return T(26);var n=e[A].values_.get(r);return n||T(27,r,bt(e)),n}if(wt(e)||tt(e)||Ue(e))return e}else if(R(e)&&Ue(e[A]))return e[A];T(28)}function Gi(e,r){if(e||T(29),wt(e)||tt(e)||Ue(e)||ne(e)||ve(e))return e;if(e[A])return e[A];T(24,e)}function bt(e,r){var t;if(r!==void 0)t=gt(e,r);else{if(Et(e))return e.name;it(e)||ne(e)||ve(e)?t=Gi(e):t=gt(e)}return t.name_}function re(e){var r=ee(),t=Ot(!0);C();try{return e()}finally{j(),Tt(t),H(r)}}var Kt=Qe.toString;function Jn(e,r,t){return t===void 0&&(t=-1),yt(e,r,t)}function yt(e,r,t,n,o){if(e===r)return e!==0||1/e===1/r;if(e==null||r==null)return!1;if(e!==e)return r!==r;var s=typeof e;if(s!=="function"&&s!=="object"&&typeof r!="object")return!1;var u=Kt.call(e);if(u!==Kt.call(r))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+e==""+r;case"[object Number]":return+e!=+e?+r!=+r:+e==0?1/+e===1/r:+e==+r;case"[object Date]":case"[object Boolean]":return+e==+r;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(r);case"[object Map]":case"[object Set]":t>=0&&t++;break}e=Xt(e),r=Xt(r);var c=u==="[object Array]";if(!c){if(typeof e!="object"||typeof r!="object")return!1;var d=e.constructor,_=r.constructor;if(d!==_&&!(R(d)&&d instanceof d&&R(_)&&_ instanceof _)&&"constructor"in e&&"constructor"in r)return!1}if(t===0)return!1;t<0&&(t=-1),n=n||[],o=o||[];for(var m=n.length;m--;)if(n[m]===e)return o[m]===r;if(n.push(e),o.push(r),c){if(m=e.length,m!==r.length)return!1;for(;m--;)if(!yt(e[m],r[m],t-1,n,o))return!1}else{var i=Object.keys(e),a;if(m=i.length,Object.keys(r).length!==m)return!1;for(;m--;)if(a=i[m],!(Q(r,a)&&yt(e[a],r[a],t-1,n,o)))return!1}return n.pop(),o.pop(),!0}function Xt(e){return nt(e)?e.slice():he(e)||ne(e)||Pe(e)||ve(e)?Array.from(e.entries()):e}function xe(e){return e[Symbol.iterator]=Hi,e}function Hi(){return this}["Symbol","Map","Set"].forEach(function(e){var r=Zt();typeof r[e]>"u"&&T("MobX requires global '"+e+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:_i,extras:{getDebugName:bt},$mobx:A});class Ui{constructor(){oe(this,"profile",{username:"Guest",xp:0,level:1,badges:[],completedModes:[],lastPlayed:null,seenIntro:!1});oe(this,"settings",{theme:"menubackground",mute:!1,difficulty:"normal",loop:!1,shuffle:!1});oe(this,"stats",{quickServe:{sessions:0,topScore:0},infinity:{timeSpent:0},story:{chapter:0}});oe(this,"storyProgress",{currentChapter:0,seenPanels:[]});oe(this,"uiState",{pendingBadgePopup:null,triggerBadgeModal:!1,currentMode:null});Pi(this),this.loadFromStorage()}addXP(r){this.profile.xp+=r;const t=Math.floor(this.profile.xp/100)+1;t>this.profile.level&&(this.profile.level=t)}setLastPlayed(r){this.profile.lastPlayed=r}unlockBadge(r){this.profile.badges.includes(r)||(this.profile.badges.push(r),this.uiState.pendingBadgePopup=r)}markModeComplete(r){this.profile.completedModes.includes(r)||this.profile.completedModes.push(r)}updateTopScore(r,t){this.stats[r]&&t>this.stats[r].topScore&&(this.stats[r].topScore=t)}incrementStoryChapter(){this.stats.story.chapter++,this.storyProgress.currentChapter++}markPanelSeen(r){this.storyProgress.seenPanels.includes(r)||this.storyProgress.seenPanels.push(r)}setSetting(r,t){this.settings[r]=t}setTriggerBadgeModal(r){this.uiState.triggerBadgeModal=r}clearTriggerBadgeModal(){this.uiState.triggerBadgeModal=!1}clearPendingBadgePopup(){this.uiState.pendingBadgePopup=null}setMode(r){this.uiState.currentMode=r}loadFromStorage(){const r=localStorage.getItem("snowcone_save_data");if(r)try{const t=JSON.parse(r);Object.assign(this.profile,t.profile),Object.assign(this.settings,t.settings),Object.assign(this.stats,t.stats),Object.assign(this.storyProgress,t.storyProgress)}catch(t){console.warn(" Bad save data. Using defaults.",t)}}}const y=new Ui;te(()=>{const e={profile:y.profile,settings:y.settings,stats:y.stats,storyProgress:y.storyProgress};localStorage.setItem("snowcone_save_data",JSON.stringify(e))});window.devFlags={build:"v0.4.1-mobx"};function K(){const e=document.getElementById("menuImage");if(!e){console.warn(" No menuImage element found!");return}let r=y.settings.theme;(!r||typeof r!="string"||r==="default")&&(r="menubackground",y.setSetting("theme",r)),e.src=`assets/img/branding/${r}.png`,console.log(" Background set to:",r),Ki(r)}function Ki(e){const r=Yi[e];r&&Object.entries(r).forEach(([t,n])=>{const o=document.querySelector(`.menu-label.${t}`);o&&(o.style.color=n)})}function Xi(e){const r=document.getElementById("menuImage");if(!r){console.warn(" No #menuImage found to swap.");return}y.setSetting("theme",e),r.src=`assets/img/branding/${e}.png`,console.log(` Swapped to theme: ${e}`)}window.swapBackground=Xi;const Yi={menubackground:{kids:"#ff77ff",quick:"#00ffee",tips:"#ffee00",story:"#ff4488",infinity:"#88ccff",options:"#cccccc"},spring:{kids:"#cc66ff",quick:"#00cc99",tips:"#ffcc66",story:"#ff66aa",infinity:"#66ddff",options:"#9999cc"},summer:{kids:"#ffdd00",quick:"#ff6600",tips:"#33cc33",story:"#ff3399",infinity:"#00ddff",options:"#ff9933"},fall:{kids:"#ffaa00",quick:"#ff6600",tips:"#66cc33",story:"#cc6633",infinity:"#ffffff",options:"#663300"},winter:{kids:"#aaddff",quick:"#ffffff",tips:"#66ffff",story:"#ddddff",infinity:"#66ccff",options:"#ccccff"},freedom:{kids:"#ff4444",quick:"#ffffff",tips:"#3366ff",story:"#ffcc00",infinity:"#bbbbbb",options:"#222222"},halloween:{kids:"#ff9933",quick:"#6600cc",tips:"#00cc66",story:"#cc0000",infinity:"#dddddd",options:"#000000"},harvest:{kids:"#ffcc00",quick:"#996633",tips:"#cc9900",story:"#993300",infinity:"#ffffff",options:"#333300"},christmas:{kids:"#00dd00",quick:"#dd0000",tips:"#ffffff",story:"#ff66cc",infinity:"#aaaaaa",options:"#006600"},newyear:{kids:"#ffffff",quick:"#ffcc00",tips:"#999999",story:"#330066",infinity:"#ff00ff",options:"#111111"},valentine:{kids:"#ff6699",quick:"#cc0066",tips:"#ffcccc",story:"#990033",infinity:"#ffe6f0",options:"#660033"},cosmic_01:{kids:"#cc66ff",quick:"#00ffff",tips:"#ffcc00",story:"#ff6699",infinity:"#ffffff",options:"#9999ff"},cosmic_02:{kids:"#ff99cc",quick:"#33ccff",tips:"#ccff66",story:"#ff66cc",infinity:"#cccccc",options:"#6666ff"},cosmic_03:{kids:"#ffffff",quick:"#88ffcc",tips:"#00cc99",story:"#66ccff",infinity:"#ccffff",options:"#333399"},cosmic_04:{kids:"#aaffff",quick:"#ffffff",tips:"#66ccff",story:"#99ccff",infinity:"#33ccff",options:"#005577"},cosmic_05:{kids:"#ffcc00",quick:"#ff9900",tips:"#00ffff",story:"#ff33cc",infinity:"#ffffff",options:"#ff0066"},cosmic_06:{kids:"#000000",quick:"#ff0000",tips:"#ffccff",story:"#330033",infinity:"#ff99ff",options:"#9900cc"},cosmic_07:{kids:"#ffffff",quick:"#ffffff",tips:"#ffffff",story:"#ffffff",infinity:"#ffffff",options:"#ffffff"}},Yt={menubackground:" Default",fall:" Fall",winter:" Winter",spring:" Spring",summer:" Summer",halloween:" Halloween",harvest:" Harvest",christmas:" Christmas",freedom:" Freedom",newyear:" New Year",valentine:" Valentine",cosmic_01:" Cosmic 01",cosmic_02:" Cosmic 02",cosmic_03:" Cosmic 03",cosmic_04:" Cosmic 04",cosmic_05:" Cosmic 05",cosmic_06:" Cosmic 06",cosmic_07:" Aberys Cone"};window.setTheme=e=>{y.setSetting("theme",e),K()};var Jt;(Jt=document.getElementById("labelQuickServe"))==null||Jt.addEventListener("click",()=>{startMode("quickServe")});const Zn={first_steps:{label:"First ",short:"Get XP",png:"snowconebadge.png",unlocks:null},math_zen:{label:"Zen ",short:"100 XP",png:"snowconebadge.png",unlocks:"cosmic_01"},mode_tour:{label:"Tour ",short:"Try Modes",png:"snowconebadge.png",unlocks:null},theme_swap:{label:"Style ",short:"Change Theme",png:"snowconebadge.png",unlocks:"summer"},listened_music:{label:"Vibes ",short:"Play Music",png:"snowconebadge.png",unlocks:"cosmic_02"},kids_place_car:{label:"Grid ",short:"Place Car",png:"snowconebadge.png",unlocks:"spring"},kids_match_master:{label:"Match ",short:"Match Game",png:"snowconebadge.png",unlocks:"freedom"},quick_50:{label:"QS 50 ",short:"QS: 50pts",png:"snowconebadge.png",unlocks:null},quick_100:{label:"QS 100 ",short:"QS: 100pts",png:"snowconebadge.png",unlocks:"cosmic_03"},quick_200:{label:"QS 200 ",short:"QS: 200pts",png:"snowconebadge.png",unlocks:"cosmic_07"},quick_300:{label:"QS 300 ",short:"QS: 300pts",png:"snowconebadge.png",unlocks:"cosmic_05"},inf_50_1min:{label:"50 ",short:"50 in 1m",png:"snowconebadge.png",unlocks:"harvest"},inf_100_2min:{label:"100 ",short:"100 in 2m",png:"snowconebadge.png",unlocks:"winter"},inf_250_4min:{label:"250 ",short:"250 in 4m",png:"snowconebadge.png",unlocks:"christmas"},inf_600_10min:{label:"600 ",short:"600 in 10m",png:"snowconebadge.png",unlocks:"valentine"},story_started:{label:"Enter ",short:"Start Story",png:"snowconebadge.png",unlocks:null},story_finished:{label:"Clear ",short:"Finish Story",png:"snowconebadge.png",unlocks:"fall"},story_perfect:{label:"Perfect ",short:"No Mistakes",png:"snowconebadge.png",unlocks:"cosmic_06"},story_cat:{label:"Cat ",short:"Find Cat",png:"snowconebadge.png",unlocks:"newyear"},story_phil:{label:"Phil ",short:"Meet Phil",png:"snowconebadge.png",unlocks:"halloween"},legend:{label:"Legend ",short:"100% Game",png:"snowconebadge.png",unlocks:"cosmic_04"}},Qi={" Core Progress":["first_steps","math_zen","mode_tour","theme_swap","listened_music"]," Kids Cones":["kids_place_car","kids_match_master"]," Quick Serve":["quick_50","quick_100","quick_200","quick_300"]," Infinity Mode":["inf_50_1min","inf_100_2min","inf_250_4min","inf_600_10min"]," Story Mode":["story_started","story_finished","story_perfect","story_cat","story_phil"]," Completion":["legend"]};function zn(){const e=document.getElementById("badgeGrid");if(e){e.innerHTML="";for(const[r,t]of Object.entries(Qi)){const n=document.createElement("div");n.classList.add("badge-group");const o=document.createElement("div");o.classList.add("badge-section"),o.textContent=r,n.appendChild(o);const s=document.createElement("div");s.classList.add("badge-grid"),t.forEach(u=>{const c=Zn[u],d=y.profile.badges.includes(u),_=document.createElement("div");_.classList.add("badge-tile"),d&&_.classList.add("unlocked");const m=document.createElement("img");m.className="badge-img",m.src=d?`/SnowCone-MathFest/assets/img/icons/${c.png}`:"/SnowCone-MathFest/assets/img/icons/cone_locked.png",m.alt=c.label,_.appendChild(m);const i=document.createElement("div");if(i.className="badge-short",i.textContent=c.short||"?????",_.appendChild(i),d){const a=document.createElement("div");a.className="badge-label",a.textContent=c.label,_.appendChild(a)}s.appendChild(_)}),n.appendChild(s),e.appendChild(n)}}}te(()=>{document.getElementById("badgeGrid")&&zn()});te(()=>{const e=y.uiState.pendingBadgePopup;if(e&&typeof e=="string"){const r=document.createElement("div");r.className="badge-banner",r.textContent=` New badge unlocked: ${e}! Check Options `,document.body.appendChild(r),setTimeout(()=>r.remove(),5e3),y.clearPendingBadgePopup()}});function Wi(){return`
    <div class="settings-block">
      <label for="profileNameInput"> Your Name:</label>
      <input id="profileNameInput" type="text" placeholder="Enter name..." value="${y.profile.username}" />
    </div>

    <div class="settings-block">
      <h3> Completion</h3>
      <div class="xp-bar-wrap">
        <div class="xp-bar" id="xpBar"></div>
      </div>
      <span id="xpPercentText">0%</span>
    </div>

    <div class="settings-block">
      <h3> Cones Earned</h3>
      <div id="badgeGrid" class="badge-wrapper"></div>
    </div>
  `}function Ji(e){const r=y.profile,t=y.stats,n=y.storyProgress;let o=0;return o+=Math.min(r.xp,100)*.5,o+=r.badges.length/e*20,t.story.chapter>=5&&(o+=15),t.quickServe.topScore>=50&&(o+=10),t.quickServe.sessions>0&&t.infinity.timeSpent>0&&n.seenPanels.length>0&&(o+=5),Math.min(100,Math.round(o))}function Zi(){const e=document.getElementById("profileNameInput");if(e){if(e.value=y.profile.username||"Guest",sessionStorage.getItem("forceWelcomeReload")){sessionStorage.removeItem("forceWelcomeReload");const s=document.createElement("div");s.classList.add("input-message"),s.textContent=` Save restored: Welcome back, ${y.profile.username}!`,Object.assign(s.style,{color:"#00ffee",textAlign:"center",marginTop:"0.5em",fontSize:"0.85rem"}),e.insertAdjacentElement("afterend",s),setTimeout(()=>s.remove(),2500)}e.onchange=()=>{y.profile.username=e.value.trim();const s=e.nextElementSibling;s!=null&&s.classList.contains("input-message")&&s.remove();const u=document.createElement("div");u.classList.add("input-message"),u.textContent=` Welcome, ${y.profile.username}!`,Object.assign(u.style,{color:"#00ffee",textAlign:"center",marginTop:"0.5em",fontSize:"0.85rem"}),e.insertAdjacentElement("afterend",u),setTimeout(()=>u.remove(),2500)}}const r=Object.keys(Zn).length,t=Ji(r),n=document.getElementById("xpBar"),o=document.getElementById("xpPercentText");n&&(n.style.width=`${t}%`),o&&(o.textContent=`${t}%`),zn()}function zi(){var n;const e=y.settings.theme,r=((n=y.profile)==null?void 0:n.unlockedThemes)||[];let t='<div class="theme-grid">';return Object.keys(Yt).forEach(o=>{const s=Yt[o],u=o==="menubackground"||r.includes(o);t+=`
      <div class="theme-tile ${u?"":"locked"} ${e===o?"active":""}" data-theme="${o}">
        <div class="theme-preview" style="background-image:url('assets/img/branding/${o}.png')"></div>
        <div class="theme-label">${s}</div>
        ${u?"":'<div class="theme-lock"></div>'}
      </div>
    `}),t+="</div>",t}function eo(){const e=document.querySelectorAll(".theme-tile");if(!e.length){console.warn(" No theme tiles found to bind");return}e.forEach(r=>{r.classList.contains("locked")||r.addEventListener("click",()=>{const t=r.dataset.theme;console.log(` Theme selected: ${t}`),y.setSetting("theme",t),location.reload()})})}var ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dt={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var Qt;function to(){return Qt||(Qt=1,function(e){(function(){var r=function(){this.init()};r.prototype={init:function(){var i=this||t;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var a=this||t;if(i=parseFloat(i),a.ctx||m(),typeof i<"u"&&i>=0&&i<=1){if(a._volume=i,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i,t.ctx.currentTime);for(var l=0;l<a._howls.length;l++)if(!a._howls[l]._webAudio)for(var f=a._howls[l]._getSoundIds(),h=0;h<f.length;h++){var v=a._howls[l]._soundById(f[h]);v&&v._node&&(v._node.volume=v._volume*i)}return a}return a._volume},mute:function(i){var a=this||t;a.ctx||m(),a._muted=i,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i?0:a._volume,t.ctx.currentTime);for(var l=0;l<a._howls.length;l++)if(!a._howls[l]._webAudio)for(var f=a._howls[l]._getSoundIds(),h=0;h<f.length;h++){var v=a._howls[l]._soundById(f[h]);v&&v._node&&(v._node.muted=i?!0:v._muted)}return a},stop:function(){for(var i=this||t,a=0;a<i._howls.length;a++)i._howls[a].stop();return i},unload:function(){for(var i=this||t,a=i._howls.length-1;a>=0;a--)i._howls[a].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,m()),i},codecs:function(i){return(this||t)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||t;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var a=new Audio;a.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||t,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return i}if(!a||typeof a.canPlayType!="function")return i;var l=a.canPlayType("audio/mpeg;").replace(/^no$/,""),f=i._navigator?i._navigator.userAgent:"",h=f.match(/OPR\/(\d+)/g),v=h&&parseInt(h[0].split("/")[1],10)<33,p=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,b=f.match(/Version\/(.*?) /),w=p&&b&&parseInt(b[1],10)<15;return i._codecs={mp3:!!(!v&&(l||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!l,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!w&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!w&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||t;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var a=function(l){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,i._releaseHtml5Audio(f)}catch{i.noAudio=!0;break}for(var h=0;h<i._howls.length;h++)if(!i._howls[h]._webAudio)for(var v=i._howls[h]._getSoundIds(),p=0;p<v.length;p++){var b=i._howls[h]._soundById(v[p]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}i._autoResume();var w=i.ctx.createBufferSource();w.buffer=i._scratchBuffer,w.connect(i.ctx.destination),typeof w.start>"u"?w.noteOn(0):w.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),w.onended=function(){w.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var S=0;S<i._howls.length;S++)i._howls[S]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),i}},_obtainHtml5Audio:function(){var i=this||t;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var a=this||t;return i._unlocked&&a._html5AudioPool.push(i),a},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!t.usingWebAudio)){for(var a=0;a<i._howls.length;a++)if(i._howls[a]._webAudio){for(var l=0;l<i._howls[a]._sounds.length;l++)if(!i._howls[a]._sounds[l]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var f=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(f,f)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!t.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var a=0;a<i._howls.length;a++)i._howls[a]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var t=new r,n=function(i){var a=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(i)};n.prototype={init:function(i){var a=this;return t.ctx||m(),a._autoplay=i.autoplay||!1,a._format=typeof i.format!="string"?i.format:[i.format],a._html5=i.html5||!1,a._muted=i.mute||!1,a._loop=i.loop||!1,a._pool=i.pool||5,a._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,a._rate=i.rate||1,a._sprite=i.sprite||{},a._src=typeof i.src!="string"?i.src:[i.src],a._volume=i.volume!==void 0?i.volume:1,a._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=i.onend?[{fn:i.onend}]:[],a._onfade=i.onfade?[{fn:i.onfade}]:[],a._onload=i.onload?[{fn:i.onload}]:[],a._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],a._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],a._onpause=i.onpause?[{fn:i.onpause}]:[],a._onplay=i.onplay?[{fn:i.onplay}]:[],a._onstop=i.onstop?[{fn:i.onstop}]:[],a._onmute=i.onmute?[{fn:i.onmute}]:[],a._onvolume=i.onvolume?[{fn:i.onvolume}]:[],a._onrate=i.onrate?[{fn:i.onrate}]:[],a._onseek=i.onseek?[{fn:i.onseek}]:[],a._onunlock=i.onunlock?[{fn:i.onunlock}]:[],a._onresume=[],a._webAudio=t.usingWebAudio&&!a._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var i=this,a=null;if(t.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var l=0;l<i._src.length;l++){var f,h;if(i._format&&i._format[l])f=i._format[l];else{if(h=i._src[l],typeof h!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(h),f||(f=/\.([^.]+)$/.exec(h.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&t.codecs(f)){a=i._src[l];break}}if(!a){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=a,i._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new o(i),i._webAudio&&u(i),i},play:function(i,a){var l=this,f=null;if(typeof i=="number")f=i,i=null;else{if(typeof i=="string"&&l._state==="loaded"&&!l._sprite[i])return null;if(typeof i>"u"&&(i="__default",!l._playLock)){for(var h=0,v=0;v<l._sounds.length;v++)l._sounds[v]._paused&&!l._sounds[v]._ended&&(h++,f=l._sounds[v]._id);h===1?i=null:f=null}}var p=f?l._soundById(f):l._inactiveSound();if(!p)return null;if(f&&!i&&(i=p._sprite||"__default"),l._state!=="loaded"){p._sprite=i,p._ended=!1;var b=p._id;return l._queue.push({event:"play",action:function(){l.play(b)}}),b}if(f&&!p._paused)return a||l._loadQueue("play"),p._id;l._webAudio&&t._autoResume();var w=Math.max(0,p._seek>0?p._seek:l._sprite[i][0]/1e3),S=Math.max(0,(l._sprite[i][0]+l._sprite[i][1])/1e3-w),P=S*1e3/Math.abs(p._rate),M=l._sprite[i][0]/1e3,J=(l._sprite[i][0]+l._sprite[i][1])/1e3;p._sprite=i,p._ended=!1;var at=function(){p._paused=!1,p._seek=w,p._start=M,p._stop=J,p._loop=!!(p._loop||l._sprite[i][2])};if(w>=J){l._ended(p);return}var k=p._node;if(l._webAudio){var Bt=function(){l._playLock=!1,at(),l._refreshBuffer(p);var ie=p._muted||l._muted?0:p._volume;k.gain.setValueAtTime(ie,t.ctx.currentTime),p._playStart=t.ctx.currentTime,typeof k.bufferSource.start>"u"?p._loop?k.bufferSource.noteGrainOn(0,w,86400):k.bufferSource.noteGrainOn(0,w,S):p._loop?k.bufferSource.start(0,w,86400):k.bufferSource.start(0,w,S),P!==1/0&&(l._endTimers[p._id]=setTimeout(l._ended.bind(l,p),P)),a||setTimeout(function(){l._emit("play",p._id),l._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?Bt():(l._playLock=!0,l.once("resume",Bt),l._clearTimer(p._id))}else{var It=function(){k.currentTime=w,k.muted=p._muted||l._muted||t._muted||k.muted,k.volume=p._volume*t.volume(),k.playbackRate=p._rate;try{var ie=k.play();if(ie&&typeof Promise<"u"&&(ie instanceof Promise||typeof ie.then=="function")?(l._playLock=!0,at(),ie.then(function(){l._playLock=!1,k._unlocked=!0,a?l._loadQueue():l._emit("play",p._id)}).catch(function(){l._playLock=!1,l._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),p._ended=!0,p._paused=!0})):a||(l._playLock=!1,at(),l._emit("play",p._id)),k.playbackRate=p._rate,k.paused){l._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||p._loop?l._endTimers[p._id]=setTimeout(l._ended.bind(l,p),P):(l._endTimers[p._id]=function(){l._ended(p),k.removeEventListener("ended",l._endTimers[p._id],!1)},k.addEventListener("ended",l._endTimers[p._id],!1))}catch(lr){l._emit("playerror",p._id,lr)}};k.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(k.src=l._src,k.load());var ur=window&&window.ejecta||!k.readyState&&t._navigator.isCocoonJS;if(k.readyState>=3||ur)It();else{l._playLock=!0,l._state="loading";var Ct=function(){l._state="loaded",It(),k.removeEventListener(t._canPlayEvent,Ct,!1)};k.addEventListener(t._canPlayEvent,Ct,!1),l._clearTimer(p._id)}}return p._id},pause:function(i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(i)}}),a;for(var l=a._getSoundIds(i),f=0;f<l.length;f++){a._clearTimer(l[f]);var h=a._soundById(l[f]);if(h&&!h._paused&&(h._seek=a.seek(l[f]),h._rateSeek=0,h._paused=!0,a._stopFade(l[f]),h._node))if(a._webAudio){if(!h._node.bufferSource)continue;typeof h._node.bufferSource.stop>"u"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),a._cleanBuffer(h._node)}else(!isNaN(h._node.duration)||h._node.duration===1/0)&&h._node.pause();arguments[1]||a._emit("pause",h?h._id:null)}return a},stop:function(i,a){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"stop",action:function(){l.stop(i)}}),l;for(var f=l._getSoundIds(i),h=0;h<f.length;h++){l._clearTimer(f[h]);var v=l._soundById(f[h]);v&&(v._seek=v._start||0,v._rateSeek=0,v._paused=!0,v._ended=!0,l._stopFade(f[h]),v._node&&(l._webAudio?v._node.bufferSource&&(typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),l._cleanBuffer(v._node)):(!isNaN(v._node.duration)||v._node.duration===1/0)&&(v._node.currentTime=v._start||0,v._node.pause(),v._node.duration===1/0&&l._clearSound(v._node))),a||l._emit("stop",v._id))}return l},mute:function(i,a){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"mute",action:function(){l.mute(i,a)}}),l;if(typeof a>"u")if(typeof i=="boolean")l._muted=i;else return l._muted;for(var f=l._getSoundIds(a),h=0;h<f.length;h++){var v=l._soundById(f[h]);v&&(v._muted=i,v._interval&&l._stopFade(v._id),l._webAudio&&v._node?v._node.gain.setValueAtTime(i?0:v._volume,t.ctx.currentTime):v._node&&(v._node.muted=t._muted?!0:i),l._emit("mute",v._id))}return l},volume:function(){var i=this,a=arguments,l,f;if(a.length===0)return i._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var h=i._getSoundIds(),v=h.indexOf(a[0]);v>=0?f=parseInt(a[0],10):l=parseFloat(a[0])}else a.length>=2&&(l=parseFloat(a[0]),f=parseInt(a[1],10));var p;if(typeof l<"u"&&l>=0&&l<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,a)}}),i;typeof f>"u"&&(i._volume=l),f=i._getSoundIds(f);for(var b=0;b<f.length;b++)p=i._soundById(f[b]),p&&(p._volume=l,a[2]||i._stopFade(f[b]),i._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(l,t.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=l*t.volume()),i._emit("volume",p._id))}else return p=f?i._soundById(f):i._sounds[0],p?p._volume:0;return i},fade:function(i,a,l,f){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(i,a,l,f)}}),h;i=Math.min(Math.max(0,parseFloat(i)),1),a=Math.min(Math.max(0,parseFloat(a)),1),l=parseFloat(l),h.volume(i,f);for(var v=h._getSoundIds(f),p=0;p<v.length;p++){var b=h._soundById(v[p]);if(b){if(f||h._stopFade(v[p]),h._webAudio&&!b._muted){var w=t.ctx.currentTime,S=w+l/1e3;b._volume=i,b._node.gain.setValueAtTime(i,w),b._node.gain.linearRampToValueAtTime(a,S)}h._startFadeInterval(b,i,a,l,v[p],typeof f>"u")}}return h},_startFadeInterval:function(i,a,l,f,h,v){var p=this,b=a,w=l-a,S=Math.abs(w/.01),P=Math.max(4,S>0?f/S:f),M=Date.now();i._fadeTo=l,i._interval=setInterval(function(){var J=(Date.now()-M)/f;M=Date.now(),b+=w*J,b=Math.round(b*100)/100,w<0?b=Math.max(l,b):b=Math.min(l,b),p._webAudio?i._volume=b:p.volume(b,i._id,!0),v&&(p._volume=b),(l<a&&b<=l||l>a&&b>=l)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,p.volume(l,i._id),p._emit("fade",i._id))},P)},_stopFade:function(i){var a=this,l=a._soundById(i);return l&&l._interval&&(a._webAudio&&l._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(l._interval),l._interval=null,a.volume(l._fadeTo,i),l._fadeTo=null,a._emit("fade",i)),a},loop:function(){var i=this,a=arguments,l,f,h;if(a.length===0)return i._loop;if(a.length===1)if(typeof a[0]=="boolean")l=a[0],i._loop=l;else return h=i._soundById(parseInt(a[0],10)),h?h._loop:!1;else a.length===2&&(l=a[0],f=parseInt(a[1],10));for(var v=i._getSoundIds(f),p=0;p<v.length;p++)h=i._soundById(v[p]),h&&(h._loop=l,i._webAudio&&h._node&&h._node.bufferSource&&(h._node.bufferSource.loop=l,l&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop,i.playing(v[p])&&(i.pause(v[p],!0),i.play(v[p],!0)))));return i},rate:function(){var i=this,a=arguments,l,f;if(a.length===0)f=i._sounds[0]._id;else if(a.length===1){var h=i._getSoundIds(),v=h.indexOf(a[0]);v>=0?f=parseInt(a[0],10):l=parseFloat(a[0])}else a.length===2&&(l=parseFloat(a[0]),f=parseInt(a[1],10));var p;if(typeof l=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,a)}}),i;typeof f>"u"&&(i._rate=l),f=i._getSoundIds(f);for(var b=0;b<f.length;b++)if(p=i._soundById(f[b]),p){i.playing(f[b])&&(p._rateSeek=i.seek(f[b]),p._playStart=i._webAudio?t.ctx.currentTime:p._playStart),p._rate=l,i._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(l,t.ctx.currentTime):p._node&&(p._node.playbackRate=l);var w=i.seek(f[b]),S=(i._sprite[p._sprite][0]+i._sprite[p._sprite][1])/1e3-w,P=S*1e3/Math.abs(p._rate);(i._endTimers[f[b]]||!p._paused)&&(i._clearTimer(f[b]),i._endTimers[f[b]]=setTimeout(i._ended.bind(i,p),P)),i._emit("rate",p._id)}}else return p=i._soundById(f),p?p._rate:i._rate;return i},seek:function(){var i=this,a=arguments,l,f;if(a.length===0)i._sounds.length&&(f=i._sounds[0]._id);else if(a.length===1){var h=i._getSoundIds(),v=h.indexOf(a[0]);v>=0?f=parseInt(a[0],10):i._sounds.length&&(f=i._sounds[0]._id,l=parseFloat(a[0]))}else a.length===2&&(l=parseFloat(a[0]),f=parseInt(a[1],10));if(typeof f>"u")return 0;if(typeof l=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,a)}}),i;var p=i._soundById(f);if(p)if(typeof l=="number"&&l>=0){var b=i.playing(f);b&&i.pause(f,!0),p._seek=l,p._ended=!1,i._clearTimer(f),!i._webAudio&&p._node&&!isNaN(p._node.duration)&&(p._node.currentTime=l);var w=function(){b&&i.play(f,!0),i._emit("seek",f)};if(b&&!i._webAudio){var S=function(){i._playLock?setTimeout(S,0):w()};setTimeout(S,0)}else w()}else if(i._webAudio){var P=i.playing(f)?t.ctx.currentTime-p._playStart:0,M=p._rateSeek?p._rateSeek-p._seek:0;return p._seek+(M+P*Math.abs(p._rate))}else return p._node.currentTime;return i},playing:function(i){var a=this;if(typeof i=="number"){var l=a._soundById(i);return l?!l._paused:!1}for(var f=0;f<a._sounds.length;f++)if(!a._sounds[f]._paused)return!0;return!1},duration:function(i){var a=this,l=a._duration,f=a._soundById(i);return f&&(l=a._sprite[f._sprite][1]/1e3),l},state:function(){return this._state},unload:function(){for(var i=this,a=i._sounds,l=0;l<a.length;l++)a[l]._paused||i.stop(a[l]._id),i._webAudio||(i._clearSound(a[l]._node),a[l]._node.removeEventListener("error",a[l]._errorFn,!1),a[l]._node.removeEventListener(t._canPlayEvent,a[l]._loadFn,!1),a[l]._node.removeEventListener("ended",a[l]._endFn,!1),t._releaseHtml5Audio(a[l]._node)),delete a[l]._node,i._clearTimer(a[l]._id);var f=t._howls.indexOf(i);f>=0&&t._howls.splice(f,1);var h=!0;for(l=0;l<t._howls.length;l++)if(t._howls[l]._src===i._src||i._src.indexOf(t._howls[l]._src)>=0){h=!1;break}return s&&h&&delete s[i._src],t.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,a,l,f){var h=this,v=h["_on"+i];return typeof a=="function"&&v.push(f?{id:l,fn:a,once:f}:{id:l,fn:a}),h},off:function(i,a,l){var f=this,h=f["_on"+i],v=0;if(typeof a=="number"&&(l=a,a=null),a||l)for(v=0;v<h.length;v++){var p=l===h[v].id;if(a===h[v].fn&&p||!a&&p){h.splice(v,1);break}}else if(i)f["_on"+i]=[];else{var b=Object.keys(f);for(v=0;v<b.length;v++)b[v].indexOf("_on")===0&&Array.isArray(f[b[v]])&&(f[b[v]]=[])}return f},once:function(i,a,l){var f=this;return f.on(i,a,l,1),f},_emit:function(i,a,l){for(var f=this,h=f["_on"+i],v=h.length-1;v>=0;v--)(!h[v].id||h[v].id===a||i==="load")&&(setTimeout((function(p){p.call(this,a,l)}).bind(f,h[v].fn),0),h[v].once&&f.off(i,h[v].fn,h[v].id));return f._loadQueue(i),f},_loadQueue:function(i){var a=this;if(a._queue.length>0){var l=a._queue[0];l.event===i&&(a._queue.shift(),a._loadQueue()),i||l.action()}return a},_ended:function(i){var a=this,l=i._sprite;if(!a._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(a._ended.bind(a,i),100),a;var f=!!(i._loop||a._sprite[l][2]);if(a._emit("end",i._id),!a._webAudio&&f&&a.stop(i._id,!0).play(i._id),a._webAudio&&f){a._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=t.ctx.currentTime;var h=(i._stop-i._start)*1e3/Math.abs(i._rate);a._endTimers[i._id]=setTimeout(a._ended.bind(a,i),h)}return a._webAudio&&!f&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,a._clearTimer(i._id),a._cleanBuffer(i._node),t._autoSuspend()),!a._webAudio&&!f&&a.stop(i._id,!0),a},_clearTimer:function(i){var a=this;if(a._endTimers[i]){if(typeof a._endTimers[i]!="function")clearTimeout(a._endTimers[i]);else{var l=a._soundById(i);l&&l._node&&l._node.removeEventListener("ended",a._endTimers[i],!1)}delete a._endTimers[i]}return a},_soundById:function(i){for(var a=this,l=0;l<a._sounds.length;l++)if(i===a._sounds[l]._id)return a._sounds[l];return null},_inactiveSound:function(){var i=this;i._drain();for(var a=0;a<i._sounds.length;a++)if(i._sounds[a]._ended)return i._sounds[a].reset();return new o(i)},_drain:function(){var i=this,a=i._pool,l=0,f=0;if(!(i._sounds.length<a)){for(f=0;f<i._sounds.length;f++)i._sounds[f]._ended&&l++;for(f=i._sounds.length-1;f>=0;f--){if(l<=a)return;i._sounds[f]._ended&&(i._webAudio&&i._sounds[f]._node&&i._sounds[f]._node.disconnect(0),i._sounds.splice(f,1),l--)}}},_getSoundIds:function(i){var a=this;if(typeof i>"u"){for(var l=[],f=0;f<a._sounds.length;f++)l.push(a._sounds[f]._id);return l}else return[i]},_refreshBuffer:function(i){var a=this;return i._node.bufferSource=t.ctx.createBufferSource(),i._node.bufferSource.buffer=s[a._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,t.ctx.currentTime),a},_cleanBuffer:function(i){var a=this,l=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!i.bufferSource)return a;if(t._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),l))try{i.bufferSource.buffer=t._scratchBuffer}catch{}return i.bufferSource=null,a},_clearSound:function(i){var a=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);a||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(i){this._parent=i,this.init()};o.prototype={init:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,a._sounds.push(i),i.create(),i},create:function(){var i=this,a=i._parent,l=t._muted||i._muted||i._parent._muted?0:i._volume;return a._webAudio?(i._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),i._node.gain.setValueAtTime(l,t.ctx.currentTime),i._node.paused=!0,i._node.connect(t.masterGain)):t.noAudio||(i._node=t._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(t._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=a._src,i._node.preload=a._preload===!0?"auto":a._preload,i._node.volume=l*t.volume(),i._node.load()),i},reset:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,a=i._parent;a._duration=Math.ceil(i._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),i._node.removeEventListener(t._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,a=i._parent;a._duration===1/0&&(a._duration=Math.ceil(i._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var s={},u=function(i){var a=i._src;if(s[a]){i._duration=s[a].duration,_(i);return}if(/^data:[^;]+;base64,/.test(a)){for(var l=atob(a.split(",")[1]),f=new Uint8Array(l.length),h=0;h<l.length;++h)f[h]=l.charCodeAt(h);d(f.buffer,i)}else{var v=new XMLHttpRequest;v.open(i._xhr.method,a,!0),v.withCredentials=i._xhr.withCredentials,v.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(p){v.setRequestHeader(p,i._xhr.headers[p])}),v.onload=function(){var p=(v.status+"")[0];if(p!=="0"&&p!=="2"&&p!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+v.status+".");return}d(v.response,i)},v.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete s[a],i.load())},c(v)}},c=function(i){try{i.send()}catch{i.onerror()}},d=function(i,a){var l=function(){a._emit("loaderror",null,"Decoding audio data failed.")},f=function(h){h&&a._sounds.length>0?(s[a._src]=h,_(a,h)):l()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(i).then(f).catch(l):t.ctx.decodeAudioData(i,f,l)},_=function(i,a){a&&!i._duration&&(i._duration=a.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},m=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),a=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),l=a?parseInt(a[1],10):null;if(i&&l&&l<9){var f=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!f&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};e.Howler=t,e.Howl=n,typeof ge<"u"?(ge.HowlerGlobal=r,ge.Howler=t,ge.Howl=n,ge.Sound=o):typeof window<"u"&&(window.HowlerGlobal=r,window.Howler=t,window.Howl=n,window.Sound=o)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var o=n._howls.length-1;o>=0;o--)n._howls[o].stereo(t);return n},HowlerGlobal.prototype.pos=function(t,n,o){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,o=typeof o!="number"?s._pos[2]:o,typeof t=="number")s._pos=[t,n,o],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,n,o,s,u,c){var d=this;if(!d.ctx||!d.ctx.listener)return d;var _=d._orientation;if(n=typeof n!="number"?_[1]:n,o=typeof o!="number"?_[2]:o,s=typeof s!="number"?_[3]:s,u=typeof u!="number"?_[4]:u,c=typeof c!="number"?_[5]:c,typeof t=="number")d._orientation=[t,n,o,s,u,c],typeof d.ctx.listener.forwardX<"u"?(d.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),d.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),d.ctx.listener.forwardZ.setTargetAtTime(o,Howler.ctx.currentTime,.1),d.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),d.ctx.listener.upY.setTargetAtTime(u,Howler.ctx.currentTime,.1),d.ctx.listener.upZ.setTargetAtTime(c,Howler.ctx.currentTime,.1)):d.ctx.listener.setOrientation(t,n,o,s,u,c);else return _;return d},Howl.prototype.init=function(t){return function(n){var o=this;return o._orientation=n.orientation||[1,0,0],o._stereo=n.stereo||null,o._pos=n.pos||null,o._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},o._onstereo=n.onstereo?[{fn:n.onstereo}]:[],o._onpos=n.onpos?[{fn:n.onpos}]:[],o._onorientation=n.onorientation?[{fn:n.onorientation}]:[],t.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"stereo",action:function(){o.stereo(t,n)}}),o;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof t=="number")o._stereo=t,o._pos=[t,0,0];else return o._stereo;for(var u=o._getSoundIds(n),c=0;c<u.length;c++){var d=o._soundById(u[c]);if(d)if(typeof t=="number")d._stereo=t,d._pos=[t,0,0],d._node&&(d._pannerAttr.panningModel="equalpower",(!d._panner||!d._panner.pan)&&r(d,s),s==="spatial"?typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):d._panner.setPosition(t,0,0):d._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),o._emit("stereo",d._id);else return d._stereo}return o},Howl.prototype.pos=function(t,n,o,s){var u=this;if(!u._webAudio)return u;if(u._state!=="loaded")return u._queue.push({event:"pos",action:function(){u.pos(t,n,o,s)}}),u;if(n=typeof n!="number"?0:n,o=typeof o!="number"?-.5:o,typeof s>"u")if(typeof t=="number")u._pos=[t,n,o];else return u._pos;for(var c=u._getSoundIds(s),d=0;d<c.length;d++){var _=u._soundById(c[d]);if(_)if(typeof t=="number")_._pos=[t,n,o],_._node&&((!_._panner||_._panner.pan)&&r(_,"spatial"),typeof _._panner.positionX<"u"?(_._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),_._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),_._panner.positionZ.setValueAtTime(o,Howler.ctx.currentTime)):_._panner.setPosition(t,n,o)),u._emit("pos",_._id);else return _._pos}return u},Howl.prototype.orientation=function(t,n,o,s){var u=this;if(!u._webAudio)return u;if(u._state!=="loaded")return u._queue.push({event:"orientation",action:function(){u.orientation(t,n,o,s)}}),u;if(n=typeof n!="number"?u._orientation[1]:n,o=typeof o!="number"?u._orientation[2]:o,typeof s>"u")if(typeof t=="number")u._orientation=[t,n,o];else return u._orientation;for(var c=u._getSoundIds(s),d=0;d<c.length;d++){var _=u._soundById(c[d]);if(_)if(typeof t=="number")_._orientation=[t,n,o],_._node&&(_._panner||(_._pos||(_._pos=u._pos||[0,0,-.5]),r(_,"spatial")),typeof _._panner.orientationX<"u"?(_._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),_._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),_._panner.orientationZ.setValueAtTime(o,Howler.ctx.currentTime)):_._panner.setOrientation(t,n,o)),u._emit("orientation",_._id);else return _._orientation}return u},Howl.prototype.pannerAttr=function(){var t=this,n=arguments,o,s,u;if(!t._webAudio)return t;if(n.length===0)return t._pannerAttr;if(n.length===1)if(typeof n[0]=="object")o=n[0],typeof s>"u"&&(o.pannerAttr||(o.pannerAttr={coneInnerAngle:o.coneInnerAngle,coneOuterAngle:o.coneOuterAngle,coneOuterGain:o.coneOuterGain,distanceModel:o.distanceModel,maxDistance:o.maxDistance,refDistance:o.refDistance,rolloffFactor:o.rolloffFactor,panningModel:o.panningModel}),t._pannerAttr={coneInnerAngle:typeof o.pannerAttr.coneInnerAngle<"u"?o.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof o.pannerAttr.coneOuterAngle<"u"?o.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof o.pannerAttr.coneOuterGain<"u"?o.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof o.pannerAttr.distanceModel<"u"?o.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof o.pannerAttr.maxDistance<"u"?o.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof o.pannerAttr.refDistance<"u"?o.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof o.pannerAttr.rolloffFactor<"u"?o.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof o.pannerAttr.panningModel<"u"?o.pannerAttr.panningModel:t._panningModel});else return u=t._soundById(parseInt(n[0],10)),u?u._pannerAttr:t._pannerAttr;else n.length===2&&(o=n[0],s=parseInt(n[1],10));for(var c=t._getSoundIds(s),d=0;d<c.length;d++)if(u=t._soundById(c[d]),u){var _=u._pannerAttr;_={coneInnerAngle:typeof o.coneInnerAngle<"u"?o.coneInnerAngle:_.coneInnerAngle,coneOuterAngle:typeof o.coneOuterAngle<"u"?o.coneOuterAngle:_.coneOuterAngle,coneOuterGain:typeof o.coneOuterGain<"u"?o.coneOuterGain:_.coneOuterGain,distanceModel:typeof o.distanceModel<"u"?o.distanceModel:_.distanceModel,maxDistance:typeof o.maxDistance<"u"?o.maxDistance:_.maxDistance,refDistance:typeof o.refDistance<"u"?o.refDistance:_.refDistance,rolloffFactor:typeof o.rolloffFactor<"u"?o.rolloffFactor:_.rolloffFactor,panningModel:typeof o.panningModel<"u"?o.panningModel:_.panningModel};var m=u._panner;m||(u._pos||(u._pos=t._pos||[0,0,-.5]),r(u,"spatial"),m=u._panner),m.coneInnerAngle=_.coneInnerAngle,m.coneOuterAngle=_.coneOuterAngle,m.coneOuterGain=_.coneOuterGain,m.distanceModel=_.distanceModel,m.maxDistance=_.maxDistance,m.refDistance=_.refDistance,m.rolloffFactor=_.rolloffFactor,m.panningModel=_.panningModel}return t},Sound.prototype.init=function(t){return function(){var n=this,o=n._parent;n._orientation=o._orientation,n._stereo=o._stereo,n._pos=o._pos,n._pannerAttr=o._pannerAttr,t.call(this),n._stereo?o.stereo(n._stereo):n._pos&&o.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var n=this,o=n._parent;return n._orientation=o._orientation,n._stereo=o._stereo,n._pos=o._pos,n._pannerAttr=o._pannerAttr,n._stereo?o.stereo(n._stereo):n._pos?o.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,o._refreshBuffer(n)),t.call(this)}}(Sound.prototype.reset);var r=function(t,n){n=n||"spatial",n==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()}(dt)),dt}var ot=to();let E=null,$=0,we=null;const no=["InfinityAddition.mp3","quikserveST_OG.mp3","nothing_organic.mp3","KKtribute.mp3","secretsOfMath.mp3","softDownMathVibes.mp3","sc_90.mp3"],pe=no.map(e=>({title:e.replace(/\.mp3$/,""),file:`tracks/${e}`}));function ro(e){E&&(E.stop(),E.unload(),cancelAnimationFrame(we));const r=pe[e];E=new ot.Howl({src:[`assets/audio/${r.file}`],loop:y.settings.loop,volume:y.settings.mute?0:1,html5:!0,onend:()=>{y.settings.loop||nr()},onplayerror:(t,n)=>{console.warn(" Play error caught:",n),E.once("unlock",()=>E.play())},onplay:()=>{er(r.title),tr()}}),E.play()}function er(e){const r=document.getElementById("currentTrack");r&&(r.textContent=e||"(none)")}function tr(){const e=document.getElementById("trackProgress"),r=document.getElementById("trackTimer");if(!e||!r||!E)return;function t(){if(!E||!E.playing())return;const n=E.seek(),o=E.duration();if(typeof n=="number"&&typeof o=="number"){const s=n/o*100;e.value=s.toFixed(1),e.max=100;const u=c=>{const d=Math.floor(c/60),_=Math.floor(c%60).toString().padStart(2,"0");return`${d}:${_}`};r.textContent=`${u(n)} / ${u(o)}`}we=requestAnimationFrame(t)}cancelAnimationFrame(we),we=requestAnimationFrame(t)}function Lt(e=$){$=e,ro($)}function io(){if(!E)return Lt();E.playing()?(E.pause(),cancelAnimationFrame(we)):(E.play(),tr())}function nr(){$=y.settings.shuffle?Math.floor(Math.random()*pe.length):($+1)%pe.length,Lt($)}function oo(){$=($-1+pe.length)%pe.length,Lt($)}function ao(){const e=!y.settings.shuffle;return y.setSetting("shuffle",e),e}function so(e){return y.setSetting("loop",e),E&&E.loop(e),e}function rr(){return y.settings.loop}function uo(){return y.settings.shuffle}function lo(){var e;er(E?(e=pe[$])==null?void 0:e.title:"(none)")}window.addEventListener("settingChanged",e=>{const{key:r,value:t}=e.detail;r==="mute"&&(ot.Howler.volume(t?0:1),E&&E.volume(t?0:1))});function co(){const e=y.settings.mute,r=rr(),t=uo();return`
    <div class="settings-block">
      <label>
        <input type="checkbox" id="muteToggle" ${e?"checked":""} />
         Mute all sound
      </label>
    </div>

    <div class="settings-block jukebox">
      <h3> Now Playing:</h3>
      <div id="currentTrack">(none)</div>
      <input type="range" id="trackProgress" value="0" min="0" max="100" disabled />
      <div id="trackTimer">0:00 / 0:00</div>

      <div class="jukebox-controls">
        <button id="btnPrev" class="icon-btn"></button>
        <button id="btnPlayPause" class="icon-btn"></button>
        <button id="btnNext" class="icon-btn"></button>
        <button id="btnLoop" class="icon-btn ${r?"active":""}"></button>
        <button id="btnShuffle" class="icon-btn ${t?"active":""}"></button>
      </div>

      <div class="jukebox-message" style="margin-top: 15px; font-size: 14px; line-height: 1.6; color: #cccccc;">
        You made it to the music player. Thats kinda amazing. <br>
        Math creates the music that connects the soul to the numbers of the festival.<br>
        I'm honored you're listening. Some of these tracks? You can <em>only</em> hear them here  at SnowCone MathFest. Enjoy! 
      </div>
    </div>
  `}function fo(){var n,o,s;const e=document.getElementById("muteToggle"),r=document.getElementById("btnLoop"),t=document.getElementById("btnShuffle");e&&e.addEventListener("change",()=>{const u=e.checked;y.setSetting("mute",u),ot.Howler.volume(u?0:1)}),(n=document.getElementById("btnPlayPause"))==null||n.addEventListener("click",io),(o=document.getElementById("btnNext"))==null||o.addEventListener("click",nr),(s=document.getElementById("btnPrev"))==null||s.addEventListener("click",oo),r==null||r.addEventListener("click",()=>{const u=so(!rr());r.classList.toggle("active",u)}),t==null||t.addEventListener("click",()=>{const u=ao();t.classList.toggle("active",u)}),lo()}function _o(){var r;const e=((r=window==null?void 0:window.devFlags)==null?void 0:r.build)||"unknown";return JSON.stringify(y,null,2),`
    <div class="settings-block">
      <h3> SnowCone MathFest v0.4.1</h3>
      <p><strong>Build:</strong> <code>${e}</code></p>
      <p>Crafted with cosmic cones </p>
    </div>

    <div class="settings-block">
      <h3> v0.4.1 Update</h3>
      <p>
          QuickServe Mode fully restructured and launched<br>
          Math Tips Mode grid + Pythagoras Cat chatbox live<br>
          All 5 zones now link + load with proper backgrounds<br>
          Each mode uses unique layout with isolated CSS<br>
          Starfield, truck, and cone now animate scene changes<br>
          Transitions polish: centered, timed, and smoother<br>
          Menu z-index and mobile overflow issues resolved<br>
          Zones now modular: grid, layout, and background per mode
      </p>
    </div>

    <div class="settings-block">
      <h3> App Info</h3>
      <p>This app works offline after install!<br>To save your data, don't clear site storage.</p>
      <p>If you're on an iPhone or iPad using Safari:<br>
        Tap the <strong>Share</strong> icon, then choose <strong>"Add to Home Screen"</strong> to install the app.</p>
      <p>If you're using Android or Chrome:<br>
        You can install this app for offline play:
      </p>
      <button class="track-button" id="installAppBtn" style="display: none;"> Install App</button>
    </div>

    <div class="settings-block">
      <h3> Tools</h3>

      <p>Want to back up or transfer your progress?</p>

      <p>
        <strong> Download Save:</strong><br>
        Exports your current game progress (XP, badges, themes) as a <code>.json</code> file.
      </p>

      <p>
        <strong> Import Save:</strong><br>
        Load your save file to restore or sync across devices.<br>
        <em> This will replace your current data!</em>
      </p>

      <p>
        <strong> Reset Progress:</strong><br>
        Clears all saved progress and starts fresh.
      </p>

      <input type="file" id="importSave" accept="application/json" style="display:none;" />
      <button class="track-button" id="downloadSave"> Download Save</button>
      <button class="track-button" id="importSaveBtn"> Import Save</button>
      <button class="track-button" id="resetProgress"> Reset Progress</button>
    </div>
  `}function po(){const e=document.getElementById("downloadSave"),r=document.getElementById("resetProgress"),t=document.getElementById("importSaveBtn"),n=document.getElementById("importSave");e&&e.addEventListener("click",()=>{const o=new Blob([JSON.stringify(y.toJSON(),null,2)],{type:"application/json"}),s=URL.createObjectURL(o),u=document.createElement("a");u.href=s,u.download="snowcone_save_data.json",u.click(),URL.revokeObjectURL(s)}),r&&r.addEventListener("click",()=>{confirm("Reset all progress? This cannot be undone.")&&(localStorage.clear(),location.reload())}),t&&n&&(t.addEventListener("click",()=>n.click()),n.addEventListener("change",o=>{var c;const s=(c=o.target.files)==null?void 0:c[0];if(!s)return;const u=new FileReader;u.onload=d=>{try{const _=JSON.parse(d.target.result);Object.assign(y,_),sessionStorage.setItem("forceWelcomeReload","true"),alert(" Save data loaded! Reloading..."),setTimeout(()=>location.reload(),100)}catch{alert(" Failed to load save. Invalid file format.")}},u.readAsText(s)}))}function Mt(e="profile"){const r=document.getElementById("cosmicModal"),t=document.getElementById("cosmicOverlay");if(!r)return console.warn(" cosmicModal not found");r.classList.remove("hidden"),t==null||t.classList.remove("hidden"),t==null||t.classList.add("show"),or(e)}function ir(){const e=document.getElementById("cosmicModal"),r=document.getElementById("cosmicOverlay");e&&e.classList.add("hidden"),r==null||r.classList.remove("show"),r==null||r.classList.add("hidden")}function or(e){const r=document.getElementById("modalContent");if(!r)return;switch(document.querySelectorAll(".tab-button").forEach(n=>{n.classList.toggle("active",n.dataset.tab===e)}),e){case"profile":r.innerHTML=Wi(),Zi();break;case"themes":r.innerHTML=zi(),eo();break;case"music":r.innerHTML=co(),fo();break;case"version":r.innerHTML=_o(),po();break;default:r.innerHTML=`<p>Unknown tab: ${e}</p>`;break}const t=document.querySelector(".modal-close");t&&t.addEventListener("click",()=>{console.log(" Cosmic modal closing!"),ir()})}function ho(e){const r=e.currentTarget.dataset.tab;console.log(` Tab clicked: ${r}`),or(r)}function vo(){var e;console.log(" Setting up tab listeners..."),document.querySelectorAll(".tab-button").forEach(r=>{r.addEventListener("click",ho)}),(e=document.querySelector(".label-options"))==null||e.addEventListener("click",()=>{console.log(" Options clicked  opening modal"),Mt("profile")})}document.addEventListener("DOMContentLoaded",()=>{vo(),console.log(" Cosmic modal listeners wired.")});window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".modal-close");e==null||e.addEventListener("click",()=>{console.log(" Closing modal from global listener"),ir()})});window.openModal=Mt;te(()=>{var r;((r=y.uiState)==null?void 0:r.triggerBadgeModal)&&(console.log(" Badge modal trigger received via autorun!"),Mt("profile"),y.clearTriggerBadgeModal())});let De=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),De=e;const r=document.getElementById("installAppBtn");r&&(r.style.display="inline-block",r.addEventListener("click",()=>{De.prompt(),De.userChoice.then(t=>{t.outcome==="accepted"?console.log(" User installed the app!"):console.log(" Install dismissed."),r.style.display="none",De=null})}))});function ar(){const e=document.getElementById("infoModal");e&&(e.classList.remove("hidden"),e.style.display="flex")}function sr(){const e=document.getElementById("infoModal");e&&(e.classList.add("hidden"),e.style.display="none")}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".menu-title-top");e?(console.log(" Title found. Binding click."),e.addEventListener("click",()=>{console.log(" Title click detected"),ar()})):console.warn(" .menu-title-top not found!")});document.addEventListener("keydown",e=>{e.key==="Escape"&&sr()});console.log(" infoModal.js loaded");window.openInfoModal=ar;window.closeInfoModal=sr;let Re=!1;function me(e){if(Re)return;Re=!0,y.uiState.transitioning=!0;let r=document.getElementById("scene-transition");if(!r){r=document.createElement("div"),r.id="scene-transition";const o="/SnowCone-MathFest/";r.innerHTML=`
      <img class="starfield" style="position:absolute; inset:0; width:100%; height:100%; object-fit:cover; z-index:1; animation:fade-in 0.25s ease-in;" src="${o}assets/img/transitions/transitionStars.png" />
      <img class="transition-truck" src="${o}assets/img/transitions/snowConeTruck.png" alt="Truck" />
      <img class="transition-cone" src="${o}assets/img/transitions/snowCone.png" alt="Snow Cone" />
    `,document.body.appendChild(r)}const t=r.querySelector(".transition-truck"),n=r.querySelector(".transition-cone");if(!t||!n){console.error(" Transition elements not found!"),Re=!1,y.uiState.transitioning=!1;return}t.style.transition="none",n.style.transition="none",t.style.transform="translateX(-150%)",n.style.transform="translateX(150%)",r.classList.add("active"),t.offsetWidth,t.style.transition="transform 0.8s ease-out",n.style.transition="transform 0.8s ease-out 0.5s",t.style.transform="translateX(150vw)",n.style.transform="translateX(-150vw)",setTimeout(()=>{r.classList.remove("active"),Re=!1,y.uiState.transitioning=!1,e==null||e()},1400)}function mo(){console.log(" Loading QuickServe Mode"),y.stats.quickServe.sessions++;const e=document.querySelector(".menu-wrapper"),r=document.getElementById("game-container");e==null||e.classList.add("hidden"),r.classList.remove("hidden"),r.style.display="flex",r.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/quickServe/quickserveBG.png" alt="QuickServe Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> QuickServe Pavilion</h1>
        </div>
        <div class="qs-content">
          <div class="score-box">
            <span>Score: </span><span id="qsScore">0</span>
          </div>

          <div class="math-stack">
            <span id="mathProblem">12 + 7 = ?</span>
            <input id="mathInput" type="number" placeholder="Answer..." />
            <button id="submitAnswer"> Submit</button>
          </div>

          <div class="cone-status">
            <span id="coneResultMsg"></span>
          </div>
        </div>

        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const i=document.getElementById("modeBackground");i&&(i.src=i.src,i.style.pointerEvents="none",console.log(" Forced mobile refresh + pointer fix"))},10)});const t=document.getElementById("returnToMenu");t==null||t.addEventListener("click",()=>{me(()=>{r.classList.add("hidden"),r.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})});let n=0;const o=document.getElementById("mathProblem"),s=document.getElementById("mathInput"),u=document.getElementById("submitAnswer"),c=document.getElementById("qsScore"),d=document.getElementById("coneResultMsg");function _(){const i=Math.floor(Math.random()*20)+1,a=Math.floor(Math.random()*20)+1;o.textContent=`${i} + ${a} = ?`,o.dataset.answer=i+a,s.value="",s.focus()}function m(){const i=parseInt(s.value.trim(),10),a=parseInt(o.dataset.answer,10);i===a?(n+=1,c.textContent=n,y.addXP(3),d.textContent=" Nice! +3 XP",d.style.color="#00ffee",y.profile.xp>=100&&!y.profile.badges.includes("cone_master")&&(y.unlockBadge("cone_master"),console.log(" Badge unlocked: cone_master")),setTimeout(()=>d.textContent="",1500),_()):(d.textContent=" Try again!",d.style.color="#ff5555",setTimeout(()=>d.textContent="",1500))}u==null||u.addEventListener("click",m),s==null||s.addEventListener("keydown",i=>{i.key==="Enter"&&m()}),_()}function go(){var t;console.log(" Loading Kids Mode");const e=document.querySelector(".menu-wrapper"),r=document.getElementById("game-container");e==null||e.classList.add("hidden"),r.classList.remove("hidden"),r.style.display="flex",r.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/kidsCamping/kidsBG.png" alt="Kids Mode Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Kids Mode  Camping Grid</h1>
        </div>
        <div class="qs-content">
          <p>Matching + stacking cones for kids. Not wired yet!</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const n=document.getElementById("modeBackground");n&&(n.src=n.src,n.style.pointerEvents="none",console.log(" Kids Mode background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{me(()=>{r.classList.add("hidden"),r.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function bo(){var t;console.log(" Loading Math Tips Mode");const e=document.querySelector(".menu-wrapper"),r=document.getElementById("game-container");e==null||e.classList.add("hidden"),r.classList.remove("hidden"),r.style.display="flex",r.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/mathTips/mathtipsBG.png" alt="Math Tips Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Math Tips Village</h1>
        </div>
        <div class="qs-content">
          <p>Pythagoras Cat isnt ready, but hes totally vibin' in the truck rn.</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const n=document.getElementById("modeBackground");n&&(n.src=n.src,n.style.pointerEvents="none",console.log(" Math Tips background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{me(()=>{r.classList.add("hidden"),r.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function yo(){var t;console.log(" Loading Story Mode");const e=document.querySelector(".menu-wrapper"),r=document.getElementById("game-container");e==null||e.classList.add("hidden"),r.classList.remove("hidden"),r.style.display="flex",r.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/storymodeForest/storyBG.png" alt="Story Mode Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Story Mode  Forest Entry</h1>
        </div>
        <div class="qs-content">
          <p>The forest is quiet... too quiet. But the math ghosts are whispering.</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const n=document.getElementById("modeBackground");n&&(n.src=n.src,n.style.pointerEvents="none",console.log(" Story Mode background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{me(()=>{r.classList.add("hidden"),r.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function Ao(){var t;console.log(" Loading Infinity Mode");const e=document.querySelector(".menu-wrapper"),r=document.getElementById("game-container");e==null||e.classList.add("hidden"),r.classList.remove("hidden"),r.style.display="flex",r.innerHTML=`
    <div class="game-frame">
      <img id="modeBackground" class="background-fill" src="assets/img/modes/infinityLake/infinityBG.png" alt="Infinity Mode Background" loading="eager" />
      <div class="qs-grid">
        <div class="qs-header">
          <h1> Infinity Lake</h1>
        </div>
        <div class="qs-content">
          <p>Endless play, infinite cones. Just chill it's not wired yet.</p>
        </div>
        <div class="qs-footer">
          <button id="returnToMenu" class="btn-return"> Return to Menu</button>
        </div>
      </div>
    </div>
  `,requestAnimationFrame(()=>{setTimeout(()=>{const n=document.getElementById("modeBackground");n&&(n.src=n.src,n.style.pointerEvents="none",console.log(" Infinity Mode background repainted"))},10)}),(t=document.getElementById("returnToMenu"))==null||t.addEventListener("click",()=>{me(()=>{r.classList.add("hidden"),r.innerHTML="",e==null||e.classList.remove("hidden"),requestAnimationFrame(()=>{K()})})})}function wo(e){switch(y.setMode(e),e){case"quickServe":mo();break;case"kids":go();break;case"mathtips":bo();break;case"story":yo();break;case"infinity":Ao();break;default:console.warn(` Unknown mode: ${e}`)}}function So(){const e=document.querySelector(".menu-wrapper");document.getElementById("menuImage"),K(),Object.entries({kids:"kids",quick:"quickServe",tips:"mathtips",story:"story",infinity:"infinity"}).forEach(([n,o])=>{const s=document.querySelector(`.menu-label.${n}`);s&&s.addEventListener("click",()=>{e.classList.add("hidden"),me(()=>{console.log(` Launching mode: ${o}`),y.setLastPlayed(Date.now()),y.setMode(o),wo(o)})})});const t=document.querySelector(".menu-title-top");t==null||t.addEventListener("click",()=>openInfoModal("info")),te(()=>{var n;(n=y.settings)==null||n.theme,K()}),e.classList.remove("hidden")}let Wt=0;document.addEventListener("touchend",e=>{const r=new Date().getTime();r-Wt<=300&&e.preventDefault(),Wt=r},!0);document.addEventListener("gesturestart",e=>{e.preventDefault()});console.log(" VITE_SECRET_KEY:","radical123");const be="/SnowCone-MathFest/",Oo=[{rel:"icon",type:"image/x-icon",href:`${be}favicon.ico`},{rel:"icon",type:"image/png",sizes:"192x192",href:`${be}icon-192.png`},{rel:"icon",type:"image/png",sizes:"512x512",href:`${be}icon-512.png`},{rel:"apple-touch-icon",href:`${be}apple-touch-icon.png`},{rel:"manifest",href:`${be}manifest.json`}];Oo.forEach(e=>{const r=document.createElement("link");Object.entries(e).forEach(([t,n])=>r.setAttribute(t,n)),document.head.appendChild(r)});window.addEventListener("DOMContentLoaded",()=>{console.log(" DOM ready. Starting app..."),K(),console.log(" Background applied."),te(()=>{ot.Howler.volume(y.settings.mute?0:1),console.log(" MobX mute autorun ran.")});const e=document.getElementById("startup-screen");if(e)console.log(" Found #startup-screen");else{console.error(" #startup-screen not found! Cannot start app.");return}setTimeout(()=>{console.log(" Fading out startup..."),e.style.opacity=0,setTimeout(()=>{console.log(" Removing startup, launching menu..."),e.remove(),So()},600)},2500)});
